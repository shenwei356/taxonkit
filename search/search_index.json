{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"TaxonKit - A Practical and Efficient NCBI Taxonomy Toolkit","text":"<ul> <li>Documents: https://bioinf.shenwei.me/taxonkit (Usage&amp;Examples, Tutorial, \u4e2d\u6587\u4ecb\u7ecd)</li> <li>Source code: https://github.com/shenwei356/taxonkit </li> <li>Latest version: </li> <li>Please cite: https://doi.org/10.1016/j.jgg.2021.03.006 </li> <li>pytaxonkit, Python bindings for TaxonKit.</li> </ul> <p>Related projects:</p> <ul> <li>Taxid-Changelog: Tracking all changes of TaxIds, including deletion, new adding, merge, reuse, and rank/name changes.</li> <li>GTDB taxdump: GTDB taxonomy taxdump files with trackable TaxIds.</li> <li>ICTV taxdump: NCBI-style taxdump files for International Committee on Taxonomy of Viruses (ICTV)</li> </ul>"},{"location":"#table-of-contents","title":"Table of Contents","text":"<ul> <li>Features</li> <li>Subcommands</li> <li>Benchmark</li> <li>Dataset</li> <li>Installation</li> <li>Command-line completion</li> <li>Citation</li> <li>Contact</li> <li>License</li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li>Easy to install (download)<ul> <li>Statically linked executable binaries for multiple platforms (Linux/Windows/macOS, amd64/arm64) </li> <li>Light weight and out-of-the-box, no dependencies, no compilation, no configuration</li> <li>No database building, just download NCBI taxonomy data and uncompress to <code>$HOME/.taxonkit</code></li> </ul> </li> <li>Easy to use (usages and examples)<ul> <li>Supporting bash-completion</li> <li>Fast (see benchmark), multiple-CPUs supported, most operations cost 2-10s.</li> <li>Detailed usages and examples</li> <li>Supporting STDIN and (gzipped) input/output file, easily integrated in pipe</li> </ul> </li> <li>Versatile commands <ul> <li>Usage and examples</li> <li>Featured command: tracking monthly changelog of all TaxIds</li> <li>Featured command: reformating lineage into format of seven-level (\"superkingdom/kingdom, phylum, class, order, family, genus, species\"</li> <li>Featured command: filtering taxiDs by a rank range, e.g., at or below genus rank.</li> <li>Featured command: Create NCBI-style taxdump files for custom taxonomy, e.g., GTDB and ICTV</li> </ul> </li> </ul>"},{"location":"#subcommands","title":"Subcommands","text":"Subcommand Function <code>list</code> List taxonomic subtrees (TaxIds) bellow given TaxIds <code>lineage</code> Query taxonomic lineage of given TaxIds <code>reformat</code> Reformat lineage in canonical ranks <code>name2taxid</code> Convert taxon names to TaxIds <code>filter</code> Filter TaxIds by taxonomic rank range <code>lca</code> Compute lowest common ancestor (LCA) for TaxIds <code>taxid-changelog</code> Create TaxId changelog from dump archives <code>profile2cami</code><sup>*</sup> Convert metagenomic profile table to CAMI format <code>cami-filter</code><sup>*</sup> Remove taxa of given TaxIds and their descendants in CAMI metagenomic profile <code>create-taxdump</code><sup>*</sup> Create NCBI-style taxdump files for custom taxonomy, e.g., GTDB and ICTV <p>Note: <sup>*</sup>New commands since the publication.</p> <p></p>"},{"location":"#benchmark","title":"Benchmark","text":"<ol> <li>Getting complete lineage for given TaxIds</li> </ol> <p>Versions: ETE=3.1.2, taxopy=0.5.0 (faster since 0.6.0), TaxonKit=0.7.2.</p>"},{"location":"#dataset","title":"Dataset","text":"<ol> <li>Download and uncompress <code>taxdump.tar.gz</code>: ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz </li> <li>Copy <code>names.dmp</code>, <code>nodes.dmp</code>, <code>delnodes.dmp</code> and <code>merged.dmp</code> to data directory: <code>$HOME/.taxonkit</code>, e.g., <code>/home/shenwei/.taxonkit</code> ,</li> <li>Optionally copy to some other directories, and later you can refer to using flag <code>--data-dir</code>, or environment variable <code>TAXONKIT_DB</code>.</li> </ol> <p>All-in-one command:</p> <pre><code>wget -c ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz \ntar -zxvf taxdump.tar.gz\n\nmkdir -p $HOME/.taxonkit\ncp names.dmp nodes.dmp delnodes.dmp merged.dmp $HOME/.taxonkit\n</code></pre> <p>Update dataset: Simply re-download the taxdump files, uncompress and override old ones.</p>"},{"location":"#installation","title":"Installation","text":"<p>Go to Download Page for more download options and changelogs.</p> <p><code>TaxonKit</code> is implemented in Go programming language,  executable binary files for most popular operating systems are freely available   in release page.</p>"},{"location":"#method-1-download-binaries-latest-stabledev-version","title":"Method 1: Download binaries (latest stable/dev version)","text":"<p>Just download compressed executable file of your operating system, and uncompress it with <code>tar -zxvf *.tar.gz</code> command or other tools. And then:</p> <ol> <li> <p>For Linux-like systems</p> <ol> <li> <p>If you have root privilege simply copy it to <code>/usr/local/bin</code>:</p> <pre><code>sudo cp taxonkit /usr/local/bin/\n</code></pre> </li> <li> <p>Or copy to anywhere in the environment variable <code>PATH</code>:</p> <pre><code>mkdir -p $HOME/bin/; cp taxonkit $HOME/bin/\n</code></pre> </li> </ol> </li> <li> <p>For Windows, just copy <code>taxonkit.exe</code> to <code>C:\\WINDOWS\\system32</code>.</p> </li> </ol>"},{"location":"#method-2-install-via-conda-latest-stable-version","title":"Method 2: Install via conda  (latest stable version)","text":"<pre><code>conda install -c bioconda taxonkit\n</code></pre>"},{"location":"#method-3-install-via-homebrew-out-of-date","title":"Method 3: Install via homebrew (out of date)","text":"<pre><code>brew install brewsci/bio/taxonkit\n</code></pre>"},{"location":"#method-4-compile-from-source-latest-stabledev-version","title":"Method 4: Compile from source (latest stable/dev version)","text":"<ol> <li> <p>Install go</p> <pre><code>wget https://go.dev/dl/go1.17.13.linux-amd64.tar.gz\n\ntar -zxf go1.17.13.linux-amd64.tar.gz -C $HOME/\n\n# or \n#   echo \"export PATH=$PATH:$HOME/go/bin\" &gt;&gt; ~/.bashrc\n#   source ~/.bashrc\nexport PATH=$PATH:$HOME/go/bin\n</code></pre> </li> <li> <p>Compile TaxonKit</p> <pre><code># ------------- the latest stable version -------------\n\ngo get -v -u github.com/shenwei356/taxonkit/taxonkit\n\n# The executable binary file is located in:\n#   ~/go/bin/taxonkit\n# You can also move it to anywhere in the $PATH\nmkdir -p $HOME/bin\ncp ~/go/bin/taxonkit $HOME/bin/\n\n# --------------- the development version --------------\n\ngit clone https://github.com/shenwei356/taxonkit\ncd taxonkit/taxonkit/\ngo build\n\n# The executable binary file is located in:\n#   ./taxonkit\n# You can also move it to anywhere in the $PATH\nmkdir -p $HOME/bin\ncp ./taxonkit $HOME/bin/\n</code></pre> </li> </ol>"},{"location":"#bash-completion","title":"Bash-completion","text":"<p>Supported shell: bash|zsh|fish|powershell</p> <p>Bash:</p> <pre><code># generate completion shell\ntaxonkit genautocomplete --shell bash\n\n# configure if never did.\n# install bash-completion if the \"complete\" command is not found.\necho \"for bcfile in ~/.bash_completion.d/* ; do source \\$bcfile; done\" &gt;&gt; ~/.bash_completion\necho \"source ~/.bash_completion\" &gt;&gt; ~/.bashrc\n</code></pre> <p>Zsh:</p> <pre><code># generate completion shell\ntaxonkit genautocomplete --shell zsh --file ~/.zfunc/_taxonkit\n\n# configure if never did\necho 'fpath=( ~/.zfunc \"${fpath[@]}\" )' &gt;&gt; ~/.zshrc\necho \"autoload -U compinit; compinit\" &gt;&gt; ~/.zshrc\n</code></pre> <p>fish:</p> <pre><code>taxonkit genautocomplete --shell fish --file ~/.config/fish/completions/taxonkit.fish\n</code></pre>"},{"location":"#citation","title":"Citation","text":"<p>If you use TaxonKit in your work, please cite:</p> <p>Shen, W., Ren, H., TaxonKit: a practical and efficient NCBI Taxonomy toolkit, Journal of Genetics and Genomics, https://doi.org/10.1016/j.jgg.2021.03.006 </p>"},{"location":"#contact","title":"Contact","text":"<p>Create an issue to report bugs, propose new functions or ask for help.</p>"},{"location":"#license","title":"License","text":"<p>MIT License</p>"},{"location":"#starchart","title":"Starchart","text":""},{"location":"bioinf/","title":"Bioinf","text":""},{"location":"chinese-dev/","title":"\u5f00\u53d1\u7b14\u8bb0","text":""},{"location":"chinese-dev/#_1","title":"\u73b0\u6709\u5de5\u5177\u6bd4\u8f83","text":"<p>\u60f3\u8981\u4eceNCBI\u83b7\u53d6\u751f\u7269\u7684\u8c31\u7cfb\u4fe1\u606f\uff0c\u53ef\u4ee5\u5728 NCBI Taxonomy\u7f51\u7ad9\u4e0a\u7528TaxID\u6216\u8005\u540d\u79f0\u67e5\u8be2\u3002 \u6bd4\u5982\u53ef\u4ee5\u7528<code>Homo sapiens</code>\u6216<code>9606</code>\u641c\u7d22\u201c\u4eba\u201d\u7684\u5206\u7c7b\u5b66\u4fe1\u606f\uff0c\u4ee5\u53ca\u5bc6\u7801\u5b50\u8868\uff0cEntrez\u8bb0\u5f55\u7edf\u8ba1\u7b49\u3002</p> <p>\u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7NCBI\u7684\u5b98\u65b9\u5de5\u5177\u5305 E-utilities (ftp)\u3002</p> <pre><code>$ esearch -db taxonomy -query \"txid9606 [Organism]\" \\\n    | efetch -format xml \\\n    | xtract -pattern Lineage -element Lineage\n</code></pre> <p>\u6b64\u5916\u4e5f\u6709\u4e00\u4e9b\u5de5\u5177\u63d0\u4f9b\u7c7b\u4f3c\u7684\u529f\u80fd\uff0c\u90e8\u5206\u8f6f\u4ef6\uff1a</p> \u5de5\u5177 \u7f16\u7a0b\u8bed\u8a00 \u6570\u636e\u83b7\u53d6\u65b9\u5f0f \u4f7f\u7528\u65b9\u5f0f \u5907\u6ce8 E-utilities shell/Perl/C++ \u8fdc\u7a0bWeb\u8c03\u7528 \u547d\u4ee4\u884c \u5b98\u65b9\u7a0b\u5e8f\uff0cTaxonomy\u64cd\u4f5c\u4ec5\u4e3a\u5176\u90e8\u5206\u529f\u80fd BioPython Python \u8fdc\u7a0bWeb\u8c03\u7528 \u811a\u672c \u5305\u88c5entrez\u63a5\u53e3\uff0cTaxonomy\u64cd\u4f5c\u4ec5\u4e3a\u5176\u90e8\u5206\u529f\u80fd ETE Toolkit Python \u672c\u5730\u6570\u636e\u5e93 \u811a\u672c/\u547d\u4ee4\u884c Taxonomy\u64cd\u4f5c\u4ec5\u4e3a\u5176\u90e8\u5206\u529f\u80fd Taxize R \u8fdc\u7a0bWeb\u8c03\u7528 \u811a\u672c ropensci\uff1b\u652f\u6301\u591a\u79cd\u6570\u636e\u5e93\uff1b\u529f\u80fd\u8f83\u4e30\u5bcc Taxopy Python \u672c\u5730\u6570\u636e\u6587\u4ef6 \u811a\u672c/\u547d\u4ee4\u884c \u4ec5\u57fa\u672c\u529f\u80fd <p>\u9009\u62e9\u5de5\u5177\u4e00\u822c\u8003\u8651\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ol> <li>\u662f\u5426\u6ee1\u8db3\u529f\u80fd\u9700\u6c42\u3002\u5927\u591a\u5de5\u5177\u4ec5\u6709\u57fa\u672c\u7684\u67e5\u8be2\u3001\u83b7\u53d6\u5b8c\u6574\u8c31\u7cfb\u7684\u529f\u80fd\uff0c\u90fd\u6ca1\u6cd5\u5c06\u5b8c\u6574\u8c31\u7cfb\u683c\u5f0f\u5316\u4e3a\"\u754c\u95e8\u7eb2\u76ee\u79d1\u5c5e\u79cd\"\u7684\u683c\u5f0f\uff1b</li> <li>\u8f6f\u4ef6\u5b89\u88c5\u4fbf\u5229\u6027\u3002\u4e0a\u8ff0\u5de5\u5177\u90fd\u4e0d\u9700\u8981\u624b\u52a8\u7f16\u8bd1\u5b89\u88c5\uff0c\u9664\u4e86E-utilities\u7684\u90e8\u5206\u7ec4\u4ef6\u9700\u8981\u624b\u52a8\u5b8c\u6210\uff0c\u5176\u5b83\u57fa\u672c\u90fd\u80fd\u7528\u5bf9\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684\u5305\u7ba1\u7406\u5de5\u5177\u5b89\u88c5\uff1b</li> <li>\u914d\u7f6e\u4fbf\u5229\u6027\u3002\u90e8\u5206\u5efa\u7acb\u672c\u5730\u6570\u636e\u5e93\u7684\u8f6f\u4ef6\u5219\u9700\u8981\u5148\u6784\u5efa\u6570\u636e\u5e93\uff0c\u4e0d\u8fc7\u57fa\u672c\u90fd\u662f\u5d4c\u5165\u5f0f\u7684sqlite\uff0c\u6bd4\u8f83\u7b80\u5355\u5feb\u6377\uff0c\u7a7a\u95f4\u5360\u7528\u4e5f\u80fd\u63a5\u53d7\uff1b</li> <li>\u4f7f\u7528\u4fbf\u5229\u6027\u3002\u63d0\u4f9b\u547d\u4ee4\u884c\u63a5\u53e3\u7684\u5de5\u5177\u5b9e\u7528\u8f83\u4e3a\u4fbf\u6377\uff0c\u4e5f\u4fbf\u4e8e\u6574\u5408\u5230\u5206\u6790\u6d41\u7a0b\uff1b    \u800c\u4ec5\u63d0\u4f9b\u5305/\u5e93\u7684\u5de5\u5177\uff0c\u9700\u8981\u4f7f\u7528\u8005\u5728\u8bed\u8a00\u7ec8\u7aef\u6216\u7f16\u5199\u811a\u672c\u8fdb\u884c\u8c03\u7528\uff0c\u7075\u6d3b\u4f46\u9700\u8981\u4e00\u5b9a\u7f16\u7a0b\u57fa\u7840\u3002</li> <li>\u8ba1\u7b97\u6548\u7387\u3002\u901a\u8fc7\u7f51\u7edc\u8c03\u7528\u7684\u8f6f\u4ef6\u53d7\u7f51\u7edc\u72b6\u6001\u5f71\u54cd\u5927\uff0c\u4e14\u5728\u5927\u6279\u91cf\u8c03\u7528\u7684\u65f6\u5019\u901f\u5ea6\u8f83\u6162\uff1b\u5b9e\u7528\u672c\u5730\u6570\u636e\u5e93\u5219\u8f83\u4e3a\u9ad8\u6548\u3002</li> </ol> <p>\u6700\u521d\u6211\u60f3\u8981\u7684\u529f\u80fd\u53ea\u662f\u6839\u636e\u83b7\u53d6\"\u754c\u95e8\u7eb2\u76ee\u79d1\u5c5e\u79cd\"\u683c\u5f0f\u7684\u8c31\u7cfb\uff0c\u53d1\u73b0\u6ca1\u6709\u73b0\u6210\u5de5\u5177\uff0c\u800c\u540e\u53c8\u6709\u65b0\u7684\u9700\u6c42\u65e0\u6cd5\u6ee1\u8db3\uff0c\u5373\u83b7\u53d6\u67d0\u4e2a\u7c7b\u522b\u6240\u6709\u7684TaxID\u3002 \u6545\u5f00\u59cb\u7f16\u5199\u5de5\u5177\u6765\u5b9e\u73b0\uff0c\u5e76\u9010\u6b65\u6269\u5c55\u5176\u529f\u80fd\u3002</p> <p>\u5176\u5b9e\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u81ea\u5df1\u4e0b\u8f7d\u6570\u636e\u6587\u4ef6\u8fdb\u884c\u89e3\u6790\u3002</p>"},{"location":"chinese-dev/#ncbi-taxonomy","title":"NCBI Taxonomy \u6570\u636e\u6587\u4ef6","text":"<p>NCBI Taxonomy\u6570\u636e\u5e93\u5c06\u6240\u6709\u751f\u7269\u7684\u5206\u7c7b\u5b66\u5173\u7cfb\u7ec4\u7ec7\u4e3a\u4e00\u68f5\u201c\u6709\u6839\u6811\u201d\uff08rooted tree\uff09, \u4e0e\u8fdb\u5316\u6811\uff08Phylogenetic tree\uff09\u4e0d\u540c: \u8fdb\u5316\u6811\u662f\u6309\u8fdb\u5316\u5173\u7cfb\u201d\u7ec4\u7ec7\uff0c\u4e14\u53ef\u4ee5\u4e3a\u201c\u65e0\u6839\u6811\u201d(unrooted tree)\u3002</p> <p>NCBI Taxonomy\u516c\u5f00\u6570\u636e\u683c\u5f0f\u6709\u4e24\u79cd\uff0c\u65e7\u7684\u540d\u79f0\u4e3a <code>taxdump.tar.gz</code> \uff0c\u6587\u4ef6\u5927\u5c0f\u7ea650Mb\uff0c\u5185\u542b\u4ee5\u4e0b\u6587\u4ef6\u3002</p> <pre><code>nodes.dmp       # [\u5f53\u524d\u7248\u672c] \u8282\u70b9\u4fe1\u606f\n                #    \u91cd\u8981\u5185\u5bb9\uff1a tax_id, parent tax_id, rank\nnames.dmp       # [\u5f53\u524d\u7248\u672c] \u540d\u79f0\u4fe1\u606f\n                #    \u91cd\u8981\u5185\u5bb9\uff1a tax_id, name_txt\nmerged.dmp      # [\u76ee\u524d\u4e3a\u6b62] \u88ab\u5408\u5e76\u7684\u8282\u70b9\u4fe1\u606f\n                #    \u91cd\u8981\u5185\u5bb9\uff1a old_tax_id, new_tax_id\ndelnodes.dmp    # [\u76ee\u524d\u4e3a\u6b62] \u88ab\u5220\u9664\u7684nodes\u4fe1\u606f\n                #    \u91cd\u8981\u5185\u5bb9\uff1a tax_id\n\ncitations.dmp   # \u5f15\u7528\u4fe1\u606f\ndivision.dmp    # division\u4fe1\u606f\ngencode.dmp     # \u9057\u4f20\u7f16\u7801\u4fe1\u606f\ngc.prt          # \u9057\u4f20\u7f16\u7801\u8868\nreadme.txt      # \u8bf4\u660e\u6587\u6863\n</code></pre> <p>\u5176\u4e2d\u6700\u4e3b\u8981\u7684\u662f\u524d4\u4e2a\u6587\u4ef6\uff1a</p> <ol> <li><code>nodes.dmp</code> \u4e3b\u8981\u5305\u542b\u5f53\u524d\u7248\u672c\u7684\u6240\u6709\u5206\u7c7b\u5b66\u5355\u5143\u8282\u70b9\uff08taxon\uff09 \u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff08taxonomic identifier, \u7b80\u79f0TaxId, taxid, tax_id)\uff0c \u5206\u7c7b\u5b66\u6c34\u5e73(rank\uff09\uff0c\u53ca\u5176\u7236\u8282\u70b9\u7684TaxID\u3002</li> <li><code>names.dmp</code> \u4e3b\u8981\u5305\u542b\u5305\u542b\u5f53\u524d\u7248\u672c\u7684\u6240\u6709TaxID\u53ca\u5176\u7edf\u4e00\u79d1\u5b66\u540d\u79f0\uff08scientific name\uff09\u548c\u522b\u540d\u3002</li> <li><code>merged.dmp</code> \u5305\u542b\u4e86\u5230\u5f53\u524d\u7248\u672c\u4e3a\u6b62\uff0c\u6240\u6709\u88ab\u5408\u5e76\u7684TaxID\u4e0e\u5408\u5e76\u5230\u7684\u65b0TaxID\u3002</li> <li><code>delnodes.dmp</code> \u5305\u542b\u4e86\u5230\u5f53\u524d\u7248\u672c\u4e3a\u6b62\uff0c\u6240\u6709\u88ab\u5220\u9664\u7684TaxID\u3002</li> </ol> <p>\u57282018\u5e742\u6708\u7684\u65f6\u5019\uff0c\u63a8\u51fa\u4e86\u65b0\u7684\u683c\u5f0f\uff0c \u989d\u5916\u5305\u542b\u4e86\u8c31\u7cfb\uff08lineage\uff09\uff0c\u7c7b\u578b\uff08type\uff09\u548c\u5bbf\u4e3b\uff08host\uff09\u4fe1\u606f\u3002  \u6587\u4ef6\u540d\u79f0\u4e3a<code>new_taxdump.tar.gz</code>\uff0c\u6587\u4ef6\u5927\u5c0f\u7ea6110Mb\u3002 \u76f8\u5bf9\u65e7\u7248\uff0c\u65b0\u7248\u672c\u6587\u4ef6\u6570\u91cf\u548c\u5185\u5bb9\u66f4\u591a\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u589e\u52a0\u4e86lineage\u548c\u7c7b\u578b\u4fe1\u606f\u3002 \u4e8b\u5b9e\u4e0alineage\u662f\u53ef\u4ee5\u4ece<code>nodes.dmp</code>\u548c<code>names.dmp</code>\u8ba1\u7b97\u800c\u6765\u3002 \u65b0\u7248\u683c\u5f0f\u6240\u542b\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>nodes.dmp\nnames.dmp\nmerged.dmp\ndelnodes.dmp\n\nfullnamelineage.dmp\nTaxIDlineage.dmp\nrankedlineage.dmp\n\nhost.dmp\ntypeoftype.dmp\ntypematerial.dmp\n\ncitations.dmp\ndivision.dmp\ngencode.dmp\nreadme.txt\n</code></pre> <p>NCBI Taxonomy\u6570\u636e\u6bcf\u5929\u90fd\u5728\u66f4\u65b0\uff0c\u6bcf\u6708\u521d\uff08\u5927\u591a\u4e3a1\u53f7\uff09\u7684\u6570\u636e\u4f5c\u4e3a\u5b58\u6863\u4fdd\u5b58\u5728 <code>taxdump_archive/</code> \u76ee\u5f55\uff0c \u65e7\u7248\u672c\u6700\u65e9\u6570\u636e\u52302014\u5e748\u6708\uff0c\u65b0\u7248\u672c\u53ea\u52302018\u5e7412\u6708\u3002</p>"},{"location":"chinese-dev/#taxonkit","title":"TaxonKit \u5f00\u53d1\u601d\u8def","text":"<p>\u5927\u5bb6\u5e94\u8be5\u90fd\u6709\u5b89\u88c5\u751f\u7269\u4fe1\u606f\u8f6f\u4ef6\u7684\u75db\u82e6\u56de\u5fc6\uff0c\u5728conda\u51fa\u73b0\u4e4b\u524d\uff0c\u5f88\u591a\u8f6f\u4ef6\u90fd\u9700\u8981\u624b\u52a8\u5b89\u88c5\u4f9d\u8d56\u3001\u518d\u7f16\u8bd1\u5b89\u88c5\u3002 \u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\uff0c\u7f16\u8bd1\u5668\u7248\u672c\u7ed9\u8f6f\u4ef6\u5b89\u88c5\u5e26\u6765\u4e86\u5de8\u5927\u7684\u56f0\u96be\u3002 \u5982\u679c\u5f00\u53d1\u8005\u6ca1\u6ce8\u610f\u8f6f\u4ef6\u7684\u8de8\u5e73\u53f0\u3001\u53ef\u79fb\u690d\u6027\u66f4\u662f\u5982\u6b64\u3002</p> <p>\u597d\u7684\u8f6f\u4ef6\u4e00\u5b9a\u8981\u8003\u8651\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ol> <li>\u5b89\u88c5\u4fbf\u5229\u6027\u3002<ol> <li>\u5c3d\u53ef\u80fd\u7b80\u5316\u5b89\u88c5\u6b65\u9aa4\uff0c\u751a\u81f3\u4e00\u952e/\u4e00\u6761\u547d\u4ee4\u5b89\u88c5\u3002</li> <li>\u51cf\u5c11\u5bf9\u5916\u90e8\u8f6f\u4ef6/\u5305\u7684\u4f9d\u8d56\u3002</li> <li>\u5bf9\u591a\u5e73\u53f0\uff08windows/linux\uff09\u7684\u517c\u5bb9\u6027\u3002</li> <li>\u5c3d\u91cf\u63d0\u4f9b\u7f16\u8bd1\u597d\u7684 \u9759\u6001\u94fe\u63a5\u53ef\u6267\u884c\u7a0b\u5e8f\uff08Statically linked executable binaries\uff09\u3002</li> </ol> </li> <li>\u914d\u7f6e\u4fbf\u5229\u6027\u3002<ol> <li>\u5c3d\u53ef\u80fd\u7b80\u5316\u914d\u7f6e\uff0c\u81ea\u52a8\u5316\u914d\u7f6e\uff0c\u751a\u81f3\u96f6\u914d\u7f6e\u3002</li> </ol> </li> <li>\u4f7f\u7528\u4fbf\u5229\u6027\u3002<ol> <li>\u4e30\u5bcc\u7684\u6587\u6863\uff1a\u5b89\u88c5\uff0c\u4f7f\u7528\uff0c\u4f8b\u5b50\u3002</li> <li>\u8f6f\u4ef6\u7ed3\u6784\u5408\u7406\uff0c\u6a21\u5757\u5316\u3002</li> <li>\u53cb\u597d\u7684\u62a5\u9519\u4fe1\u606f\uff0c\u6307\u51fa\u8be6\u7ec6\u7684\u9519\u8bef\u539f\u56e0\uff0c\u800c\u4e0d\u662f\u53ea\u62a5segmentation fault\uff0c\u6216\u6254\u51fa\u4e00\u5806\u9519\u8bef\u4fe1\u606f\u3002</li> <li>\u4e30\u5bcc\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u6ee1\u8db3\u4e0d\u540c\u529f\u80fd\u9700\u6c42\u3002</li> <li>\u652f\u6301\u6807\u51c6\u8f93\u5165/\u8f93\u51fa\uff0c\u4ece\u800c\u4fbf\u4e8e\u6574\u5408\u5230\u5206\u6790\u6d41\u7a0b\u3002</li> <li>\u53ef\u9009\u652f\u6301shell\u8865\u5168\uff0c\u4fbf\u4e8e\u5feb\u901f\u8c03\u7528\u5b50\u547d\u4ee4\u548c\u53c2\u6570\u3002</li> </ol> </li> <li>\u8ba1\u7b97\u6548\u7387\u3002<ol> <li>\u5c3d\u53ef\u80fd\u5360\u7528\u4f4e\u5185\u5b58\u3001\u4f4e\u5b58\u50a8\u3002</li> <li>\u5c3d\u91cf\u51cf\u5c11\u8ba1\u7b97\u65f6\u95f4\uff0c\u5145\u5206\u5229\u7528\u591aCPU\u3002</li> </ol> </li> <li>\u6301\u7eed\u7684\u652f\u6301\u3002<ol> <li>\u6839\u636e\u7528\u6237\u9700\u6c42\u4fee\u590dbug\u3001\u589e\u52a0\u65b0\u529f\u80fd\u3002</li> <li>\u5b9a\u671f\u66f4\u65b0\u53d1\u5e03\u65b0\u7248\u672c\u3002</li> </ol> </li> </ol> <p>\u5728\u5b9e\u73b0TaxonKit\u7684\u65f6\u5019\uff0c\u6211\u5df2\u7ecf\u5f00\u59cb\u7f16\u5199seqkit\u548ccsvtk\u8f6f\u4ef6\uff0c\u6709\u4e86\u4e00\u5b9a\u7684\u7ecf\u9a8c\uff0c\u4e5f\u57fa\u672c\u80fd\u8fbe\u5230\u4e0a\u8ff0\u6240\u6709\u8981\u6c42\u3002</p> <p>TaxonKit\u4f7f\u7528Go\u8bed\u8a00\u7f16\u5199\uff0c\u8fd9\u6837\u53ef\u4ee5\u8f7b\u677e\u7f16\u8bd1\u51fa\u652f\u6301Linux, Windows,  macOS\u7b49\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e0d\u540c\u67b6\u6784\uff08x86/arm\uff09\u7684\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u7531\u4e8eGo\u662f\u7f16\u8bd1\u578b\u8bed\u8a00\uff0c\u5728\u8fd0\u884c\u6548\u7387\u4e0a\u4e5f\u6709\u4fdd\u8bc1\u3002 \u81f3\u4e8e\u914d\u7f6e\u3001\u4f7f\u7528\u7b49\u4fbf\u5229\u6027\u5219\u4f9d\u8d56\u4e8e\u5f00\u53d1\u8005\u3002</p> <p>\u5206\u7c7b\u5b66\u6570\u636e\u4f7f\u7528NCBI taxonomy\u7684\u516c\u5f00\u6570\u636e\u3002 \u6570\u636e\u8bbf\u95ee\u65b9\u5f0f\u7684\u9009\u62e9\uff1a\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u5b98\u65b9Web\u63a5\u53e3\u7684\u65b9\u5f0f\u592a\u6162\uff0c\u53ea\u8003\u8651\u672c\u5730\u8bbf\u95ee\u3002 \u672c\u5730\u8bbf\u95ee\u6709\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93\uff1a\u53c8\u5206\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u5982SQLite\uff0c\u7b2c\u4e09\u65b9\u6570\u636e\u5e93\u5165MySQL\u3002\u540e\u8005\u4e0d\u8003\u8651\uff0c\u914d\u7f6e\u592a\u9ebb\u70e6\u3002</li> <li>Client-Server\u6a21\u5f0f\uff1a<ol> <li>Web\u63a5\u53e3\uff1a\u670d\u52a1\u7aef\u542f\u52a8\u5b88\u62a4\u8fdb\u7a0b\uff0c\u957f\u671f\u4fdd\u6301\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u5bf9\u5916\u63d0\u4f9bWeb\uff08RESTful\uff09\u63a5\u53e3\uff0c    \u5ba2\u6237\u7aef\u672c\u5730\u6216\u8fdc\u7a0b\u8c03\u7528\u3002\u5148\u524d\u5df2\u7ecf\u5f00\u53d1\u4e86\u4e00\u4e2a\u539f\u578b\uff08https://github.com/shenwei356/gtaxon\uff09\uff0c    \u4f46\u901a\u8fc7RESTful\u63a5\u53e3\uff08HTTP\uff09\u5927\u6279\u91cf\u8c03\u7528\uff0c\u8bbf\u95ee\u901f\u5ea6\u8f83\u6162\u3002</li> <li>Socket\u63a5\u53e3\uff1a\u4e0eWeb\u501f\u53e3\u7c7b\u4f3c\uff0c\u56e0\u4e3a\u6ca1\u6709\u4f7f\u7528http\u534f\u8bae\uff0c\u901f\u5ea6\u5e94\u8be5\u4f1a\u9ad8\u4e00\u4e9b\u3002\u4f46\u6ca1\u6709\u5c1d\u8bd5\u3002</li> </ol> </li> </ol> <p>\u6700\u540e\u6d4b\u8bd5\u53d1\u73b0\uff0c\u76f4\u63a5\u89e3\u6790\u6570\u636e\u6587\u4ef6\u7684\u901f\u5ea6\u4e5f\u5f88\u5feb\uff0c5\u79d2\u5de6\u53f3\uff08\u5b58\u50a8\u4e3aNVMe SSD\uff09\uff0c\u5b8c\u5168\u6ee1\u8db3\u8981\u6c42\u3002 \u5b8c\u5168\u4e0d\u7528\u642d\u5efa\u6570\u636e\u5e93\uff0c\u914d\u7f6e\u66f4\u5bb9\u6613\uff0c\u4e5f\u4fbf\u4e8e\u66f4\u65b0\u6570\u636e\u3002 \u8fd1\u65e5\u53c8\u8fdb\u4e00\u6b65\u4f18\u5316\u52302\u79d2\u5de6\u53f3\uff0c\u975e\u5e38\u5feb\u901f\u3002\u5185\u5b58\u4e5f\u5728500Mb-1.5G\u5de6\u53f3\uff0c\u5b8c\u5168\u53ef\u4ee5\u63a5\u53d7\u3002</p> <p>TaxonKit\u4e3a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u91c7\u7528\u5b50\u547d\u4ee4\u7684\u65b9\u5f0f\u6765\u6267\u884c\u4e0d\u540c\u529f\u80fd\uff0c\u5927\u591a\u6570\u5b50\u547d\u4ee4\u652f\u6301\u6807\u51c6\u8f93\u5165/\u8f93\u51fa\uff0c\u4fbf\u4e8e\u4f7f\u7528\u547d\u4ee4\u884c\u7ba1\u9053\u8fdb\u884c\u6d41\u6c34\u4f5c\u4e1a\u3002</p>"},{"location":"chinese-dev/#_2","title":"\u5c40\u9650\u6027","text":"<ul> <li>\u5206\u7c7b\u5b66\u6570\u636e\u5e93\u6709\u5f88\u591a\uff0cTaxonKit\u76ee\u524d\u53ea\u652f\u6301\u5e94\u7528\u6700\u5e7f\u6cdb\u7684NCBI Taxonomy\u3002   \u53ef\u4ee5\u7528create-taxdump\u547d\u4ee4\u628a\u4efb\u610f\uff08gtdb, ictv\uff0c\u81ea\u5b9a\u4e49\uff09\u7684\u5206\u7c7b\u5b66\u6570\u636e\u5e93\u8f6c\u4e3aNCBI taxdump\u683c\u5f0f \u3002</li> <li>\u5bf9\u4e8eGTDB Taxonomy\uff0c\u53ef\u4ee5\u901a\u8fc7\u73b0\u6709\u5de5\u5177\uff0c\u5982gtdb_to_taxdump\uff0c   \u5c06\u5176\u6570\u636e\u8f6c\u6362\u4e3aNCBI taxdump\u6587\u4ef6\u3002\u7528taxonkit\u5c31\u597d\uff0chttps://github.com/shenwei356/gtdb-taxdump\u3002</li> </ul>"},{"location":"chinese/","title":"TaxonKit: \u5c0f\u5de7\u3001\u9ad8\u6548\u3001\u5b9e\u7528\u7684NCBI\u5206\u7c7b\u5b66\u6570\u636e\u547d\u4ee4\u884c\u5de5\u5177\u96c6","text":""},{"location":"chinese/#ncbi-taxonomy","title":"NCBI Taxonomy \u6570\u636e\u5e93","text":"<p>\u4ece\u4e8b\u751f\u7269\u591a\u6837\u6027\u7684\u7814\u7a76\u8005\u5bf9NCBI Taxonomy\u6570\u636e\u5e93\u4e00\u5b9a\u4e0d\u4f1a\u964c\u751f\uff0c \u5b83\u5305\u542b\u4e86NCBI\u6240\u6709\u6838\u9178\u548c\u86cb\u767d\u5e8f\u5217\u6570\u636e\u5e93\u4e2d\u6bcf\u6761\u5e8f\u5217\u5bf9\u5e94\u7684\u7269\u79cd\u540d\u79f0\u4e0e\u5206\u7c7b\u5b66\u4fe1\u606f\u3002 \u5927\u591a\u6570\u751f\u6001\u5b66\u7814\u7a76\u5bf9\u7269\u79cd\u7ec4\u6210\u7684\u63cf\u8ff0\u90fd\u662f\u57fa\u4e8eNCBI Taxonomy\u6570\u636e\u5e93\uff0c \u5f53\u7136\u76ee\u524d\u4e5f\u5f00\u59cb\u4f7f\u7528\u5176\u4ed6\u6570\u636e\u5e93\uff0c\u5982GTDB\u7b49\u3002</p> <p>NCBI Taxonomy\u6570\u636e\u5e93\u59cb\u4e8e1991\u5e74\uff0c\u4e00\u76f4\u968f\u7740Entrez\u6570\u636e\u5e93\u548c\u5176\u4ed6\u6570\u636e\u5e93\u66f4\u65b0\uff0c 1996\u5e74\u63a8\u51fa\u7f51\u9875\u7248\u3002NCBI Taxonomy\u6570\u636e\u5e93\u5b98\u65b9\u5730\u5740\u4e3a https://www.ncbi.nlm.nih.gov/taxonomy \uff0c \u516c\u5f00\u6570\u636e\u4e0b\u8f7d\u5730\u5740\u4e3a https://ftp.ncbi.nih.gov/pub/taxonomy/  \uff0c \u6570\u636e\u6bcf\u5c0f\u65f6\u66f4\u65b0\uff0c\u6bcf\u4e2a\u6708\u521d\u751f\u6210\u4e00\u4efd\u6570\u636e\u5f52\u6863\u5b58\u4e8e taxdump_archive \u76ee\u5f55\uff0c\u6700\u65e9\u53ef\u8ffd\u6eaf\u52302014\u5e748\u6708\u3002</p>"},{"location":"chinese/#taxonkit","title":"TaxonKit \u4f7f\u7528","text":"<p>TaxonKit\u662f\u91c7\u7528Go\u8bed\u8a00\u7f16\u5199\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c \u63d0\u4f9bLinux, Windows, macOS\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u540c\u67b6\u6784\uff08x86-64/arm64\uff09\u7684\u9759\u6001\u7f16\u8bd1\u7684\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53d1\u5e03\u7684\u538b\u7f29\u5305\u4e0d\u8db33Mb\uff0c\u9664\u4e86Github\u6258\u7ba1\u5916\uff0c\u8fd8\u63d0\u4f9b\u56fd\u5185\u955c\u50cf\u4f9b\u4e0b\u8f7d\uff0c\u540c\u65f6\u8fd8\u652f\u6301conda\u548chomebrew\u5b89\u88c5\u3002 \u7528\u6237\u53ea\u9700\u8981\u4e0b\u8f7d\u3001\u89e3\u538b\uff0c\u5f00\u7bb1\u5373\u7528\uff0c\u65e0\u9700\u914d\u7f6e\uff0c\u4ec5\u9700\u4e0b\u8f7d\u89e3\u538bNCBI Taxonomy\u6570\u636e\u6587\u4ef6\u89e3\u538b\u5230\u6307\u5b9a\u76ee\u5f55\u5373\u53ef\u3002</p> <ul> <li>\u6e90\u4ee3\u7801 https://github.com/shenwei356/taxonkit \uff0c</li> <li>\u6587\u6863 http://bioinf.shenwei.me/taxonkit \uff08\u4ecb\u7ecd\u3001\u4f7f\u7528\u8bf4\u660e\u3001\u4f8b\u5b50\u3001\u6559\u7a0b\uff09</li> </ul> <p>\u9009\u62e9\u7cfb\u7edf\u5bf9\u5e94\u7684\u7248\u672c\u4e0b\u8f7d\u6700\u65b0\u7248 https://github.com/shenwei356/taxonkit/releases \uff0c\u89e3\u538b\u540e\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u5373\u53ef\u4f7f\u7528\u3002\u6216\u53ef\u9009conda\u5b89\u88c5</p> <pre><code>conda install taxonkit -c bioconda -y\n# \u8868\u683c\u6570\u636e\u5904\u7406\uff0c\u63a8\u8350\u4f7f\u7528 csvtk \u66f4\u9ad8\u6548\nconda install csvtk -c bioconda -y\n</code></pre> <p>\u6d4b\u8bd5\u6570\u636e\u4e0b\u8f7d\u53ef\u76f4\u63a5 https://github.com/shenwei356/taxonkit \u4e0b\u8f7d\u9879\u76ee\u538b\u7f29\u5305\uff0c\u6216\u4f7f\u7528git clone\u4e0b\u8f7d\u9879\u76ee\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u7684example\u4e3a\u6d4b\u8bd5\u6570\u636e</p> <pre><code>git clone https://github.com/shenwei356/taxonkit\n</code></pre> <p>TaxonKit\u4e3a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u91c7\u7528\u5b50\u547d\u4ee4\u7684\u65b9\u5f0f\u6765\u6267\u884c\u4e0d\u540c\u529f\u80fd\uff0c \u5927\u591a\u6570\u5b50\u547d\u4ee4\u652f\u6301\u6807\u51c6\u8f93\u5165/\u8f93\u51fa\uff0c\u4fbf\u4e8e\u4f7f\u7528\u547d\u4ee4\u884c\u7ba1\u9053\u8fdb\u884c\u6d41\u6c34\u4f5c\u4e1a\uff0c \u8f7b\u677e\u6574\u5408\u8fdb\u5206\u6790\u6d41\u7a0b\u4e2d\u3002</p> \u5b50\u547d\u4ee4 \u529f\u80fd <code>list</code> \u5217\u51fa\u6307\u5b9aTaxId\u4e0b\u6240\u6709\u5b50\u5355\u5143\u7684\u7684TaxID <code>lineage</code> \u6839\u636eTaxID\u83b7\u53d6\u5b8c\u6574\u8c31\u7cfb\uff08lineage\uff09 <code>reformat</code> \u5c06\u5b8c\u6574\u8c31\u7cfb\u8f6c\u5316\u4e3a\u201c\u754c\u95e8\u7eb2\u76ee\u79d1\u5c5e\u79cd\u682a\"\u7684\u81ea\u5b9a\u4e49\u683c\u5f0f <code>name2taxid</code> \u5c06\u5206\u7c7b\u5355\u5143\u540d\u79f0\u8f6c\u5316\u4e3aTaxID <code>filter</code> \u6309\u5206\u7c7b\u5b66\u6c34\u5e73\u8303\u56f4\u8fc7\u6ee4TaxIDs <code>lca</code> \u8ba1\u7b97\u6700\u4f4e\u516c\u5171\u7956\u5148(LCA) <code>taxid-changelog</code> \u8ffd\u8e2aTaxID\u53d8\u66f4\u8bb0\u5f55 <code>version</code> \u663e\u793a\u7248\u672c\u4fe1\u606f\u3001\u68c0\u6d4b\u65b0\u7248\u672c <code>genautocomplete</code> \u751f\u6210shell\u81ea\u52a8\u8865\u5168\u914d\u7f6e\u811a\u672c <p>\u5907\u6ce8\uff1a</p> <ul> <li>\u8f93\u51fa\uff1a<ul> <li>\u6240\u6709\u547d\u4ee4\u8f93\u51fa\u4e2d\u5305\u542b\u8f93\u5165\u6570\u636e\u5185\u5bb9\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u589e\u52a0\u5217\u3002</li> <li>\u6240\u6709\u547d\u4ee4\u9ed8\u8ba4\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff08stdout\uff09\uff0c\u53ef\u901a\u8fc7\u91cd\u5b9a\u5411\uff08<code>&gt;</code>\uff09\u5199\u5165\u6587\u4ef6\u3002</li> <li>\u6216\u901a\u8fc7\u5168\u5c40\u53c2\u6570<code>-o</code>\u6216<code>--out-file</code>\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff0c\u4e14\u53ef\u81ea\u52a8\u8bc6\u522b\u8f93\u51fa\u6587\u4ef6\u540e\u7f00\uff08<code>.gz</code>\uff09\u8f93\u51fagzip\u683c\u5f0f\u3002</li> </ul> </li> <li>\u8f93\u5165\uff1a<ul> <li>\u9664\u4e86<code>list</code>\u4e0e<code>taxid-changelog</code>\u4e4b\u5916\uff0c<code>lineage</code>, <code>reformat</code>, <code>name2taxid</code>, <code>filter</code> \u4e0e <code>lca</code>   \u5747\u53ef\u4ece\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\u8bfb\u53d6\u8f93\u5165\u6570\u636e\uff0c\u4e5f\u53ef\u901a\u8fc7\u4f4d\u7f6e\u53c2\u6570\uff08positional arguments\uff09\u8f93\u5165\uff0c\u5373\u547d\u4ee4\u540e\u9762\u4e0d\u5e26   \u4efb\u4f55flag\u7684\u53c2\u6570\uff0c\u5982 <code>taxonkit lineage taxids.txt</code></li> <li>\u8f93\u5165\u683c\u5f0f\u4e3a\u5355\u5217\uff0c\u6216\u8005\u5236\u8868\u7b26\u5206\u9694\u7684\u683c\u5f0f\uff0c\u8f93\u5165\u6570\u636e\u6240\u5728\u5217\u7528<code>-i</code>\u6216<code>--taxid-field</code>\u6307\u5b9a\u3002</li> </ul> </li> </ul> <p>TaxonKit\u76f4\u63a5\u89e3\u6790NCBI Taxonomy\u6570\u636e\u6587\u4ef6\uff082\u79d2\u5de6\u53f3\uff09\uff0c\u914d\u7f6e\u66f4\u5bb9\u6613\uff0c\u4e5f\u4fbf\u4e8e\u66f4\u65b0\u6570\u636e\uff0c\u5360\u7528\u5185\u5b58\u5728500Mb-1.5G\u5de6\u53f3\u3002 \u6570\u636e\u4e0b\u8f7d\uff1a</p> <pre><code># \u6709\u65f6\u4e0b\u8f7d\u5931\u8d25\uff0c\u53ef\u591a\u8bd5\u51e0\u6b21\uff1b\u6216\u5c1d\u8bd5\u6d4f\u89c8\u5668\u4e0b\u8f7d\u6b64\u94fe\u63a5\nwget -c https://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz \ntar -zxvf taxdump.tar.gz\n\n# \u89e3\u538b\u6587\u4ef6\u5b58\u4e8e\u5bb6\u76ee\u5f55\u4e2d.taxonkit/\uff0c\u7a0b\u5e8f\u9ed8\u8ba4\u6570\u636e\u5e93\u9ed8\u8ba4\u76ee\u5f55\nmkdir -p $HOME/.taxonkit\ncp names.dmp nodes.dmp delnodes.dmp merged.dmp $HOME/.taxonkit\n</code></pre>"},{"location":"chinese/#list-taxidtaxid","title":"list \u5217\u51fa\u6307\u5b9aTaxId\u6240\u5728\u5b50\u6811\u7684\u6240\u6709TaxID","text":"<p><code>taxonkit list</code>\u7528\u4e8e\u5217\u51fa\u6307\u5b9aTaxID\u6240\u5728\u5206\u7c7b\u5b66\u5355\u5143\uff08taxon\uff09\u7684\u5b50\u6811\uff08subtree\uff09\u7684\u6240\u6709taxon\u7684TaxID\uff0c\u53ef\u9009\u663e\u793a\u540d\u79f0\u548c\u5206\u7c7b\u5b66\u6c34\u5e73\u3002 \u6b64\u529f\u80fd\u4e0eNCBI Taxonomy\u7f51\u9875\u7248\u7c7b\u4f3c\u3002</p> <p>\u5982\uff0c</p> <pre><code># \u4ee5\u4eba\u5c5e(9605)\u548c\u80a0\u9053\u4e2d\u8457\u540d\u7684Akk\u83cc\u5c5e(239934)\u4e3a\u4f8b\n$ taxonkit list --show-rank --show-name --indent \"    \" --ids 9605,239934\n9605 [genus] Homo\n    9606 [species] Homo sapiens\n        63221 [subspecies] Homo sapiens neanderthalensis\n        741158 [subspecies] Homo sapiens subsp. 'Denisova'\n    1425170 [species] Homo heidelbergensis\n    2665952 [no rank] environmental samples\n        2665953 [species] Homo sapiens environmental sample\n\n239934 [genus] Akkermansia\n    239935 [species] Akkermansia muciniphila\n        349741 [strain] Akkermansia muciniphila ATCC BAA-835\n    512293 [no rank] environmental samples\n        512294 [species] uncultured Akkermansia sp.\n        1131822 [species] uncultured Akkermansia sp. SMG25\n        1262691 [species] Akkermansia sp. CAG:344\n        1263034 [species] Akkermansia muciniphila CAG:154\n    1679444 [species] Akkermansia glycaniphila\n    2608915 [no rank] unclassified Akkermansia\n        1131336 [species] Akkermansia sp. KLE1605\n    ...\n</code></pre> <p>list\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u7684\u529f\u80fd\u662f\u83b7\u53d6\u67d0\u4e2a\u7c7b\u522b\uff08\u6bd4\u5982\u7ec6\u83cc\u3001\u75c5\u6bd2\u3001\u67d0\u4e2a\u5c5e\u7b49\uff09\u4e0b\u6240\u6709\u7684TaxID\uff0c \u7528\u6765\u4eceNCBI nt/nr\u4e2d\u83b7\u53d6\u5bf9\u5e94\u7684\u6838\u9178/\u86cb\u767d\u5e8f\u5217\uff0c\u4ece\u800c\u642d\u5efa\u7279\u5f02\u6027\u7684BLAST\u6570\u636e\u5e93\u3002 \u5b98\u7f51\u63d0\u4f9b\u4e86\u76f8\u5e94\u7684\u8be6\u7ec6\u6b65\u9aa4\uff1a http://bioinf.shenwei.me/taxonkit/tutorial \u3002</p> <pre><code># \u6240\u6709\u7ec6\u83cc\u7684TaxID\n$ taxonkit list --show-rank --show-name --ids 2 &gt; /dev/null\n</code></pre>"},{"location":"chinese/#lineage-taxid","title":"lineage \u6839\u636eTaxID\u83b7\u53d6\u5b8c\u6574\u8c31\u7cfb","text":"<p>\u5206\u7c7b\u5b66\u6570\u636e\u76f8\u5173\u6700\u5e38\u89c1\u7684\u529f\u80fd\u5c31\u662f\u6839\u636eTaxID\u83b7\u53d6\u5b8c\u6574\u8c31\u7cfb\u3002 TaxonKit\u53ef\u6839\u636e\u8f93\u5165\u6587\u4ef6\u63d0\u4f9b\u7684TaxID\u5217\u8868\u5feb\u901f\u8ba1\u7b97lineage\uff0c\u5e76\u53ef\u9009\u63d0\u4f9b\u540d\u79f0\uff0c\u5206\u7c7b\u5b66\u6c34\u5e73\uff0c\u4ee5\u53ca\u8c31\u7cfb\u5bf9\u5e94\u7684TaxID\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u968f\u7740Taxonomy\u6570\u636e\u7684\u9891\u7e41\u66f4\u65b0\uff0c\u6709\u7684TaxID\u53ef\u80fd\u88ab\u5220\u9664\u3001\u6216\u5408\u5e76\uff08merge\uff09\u5230\u5176\u5b83TaxID\u4e2d\uff0c TaxonKit\u4f1a\u81ea\u52a8\u8bc6\u522b\uff0c\u5e76\u8fdb\u884c\u63d0\u793a\uff0c\u5bf9\u4e8e\u88ab\u5408\u5e76\u7684TaxID\uff0cTaxonKit\u4f1a\u6309\u65b0TaxID\u8fdb\u884c\u8ba1\u7b97\u3002</p> <pre><code># \u4f7f\u7528example\u4e2d\u7684\u6d4b\u8bd5\u6570\u636e\n$ head taxids.txt\n9606\n9913\n376619\n# \u67e5\u627e\u6307\u5b9ataxids\u5217\u8868\u7684\u7269\u79cd\u4fe1\u606f\uff0ctee\u53ef\u8f93\u51fa\u5c4f\u5e55\u5e76\u5199\u5165\u6587\u4ef6\n$ taxonkit lineage taxids.txt | tee lineage.txt \n19:22:13.077 [WARN] taxid 92489 was merged into 796334\n19:22:13.077 [WARN] taxid 1458427 was merged into 1458425\n19:22:13.077 [WARN] taxid 123124124 not found\n19:22:13.077 [WARN] taxid 3 was deleted\n9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens\n9913    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Laurasiatheria;Artiodactyla;Ruminantia;Pecora;Bovidae;Bovinae;Bos;Bos taurus\n376619  cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;Francisella tularensis subsp. holarctica;Francisella tularensis subsp. holarctica LVS\n349741  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\n239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n314101  cellular organisms;Bacteria;environmental samples;uncultured murine large bowel bacterium BAC 54B\n11932   Viruses;Riboviria;Pararnavirae;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;unclassified Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\n1327037 Viruses;Duplodnaviria;Heunggongvirae;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;unclassified Siphoviridae;Croceibacter phage P2559Y\n123124124\n3\n92489   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\n1458427 cellular organisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raicheisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n</code></pre> <p>\u4e0e\u5176\u5b83\u8f6f\u4ef6\u7684\u6027\u80fd\u76f8\u6bd4\uff0c\u5f53\u67e5\u8be2\u6570\u91cf\u8f83\u5c11\u65f6ETE\u8f83\u5feb\uff0c\u6570\u91cf\u8f83\u591a\u65f6\u5219TaxonKit\u66f4\u5feb\u3002 \u5728\u4e0d\u540c\u6570\u636e\u91cf\u89c4\u6a21\u4e0a TaxonKit\u901f\u5ea6\u4e00\u76f4\u5f88\u7a33\u5b9a\uff0c\u5747\u4e3a2-3\u79d2\uff0c\u65f6\u95f4\u4e3b\u8981\u82b1\u5728\u89e3\u6790Taxonomy\u6570\u636e\u6587\u4ef6\u4e0a\u3002</p> <p>\u5217\u51falineage\u6bcf\u4e2a\u5206\u7c7b\u5b66\u5355\u5143\u7684\u7684TaxId\u548crank\u548c\u540d\u79f0\uff0c\u6bd4\u5982SARS-COV-2\u3002</p> <pre><code># lineage\u63d0\u53d6SARS-COV-2\u7684\u4e16\u7cfb\n$ echo \"2697049\" \\\n    | taxonkit lineage -t -R \\\n    | sed \"s/\\t/\\n/g\"\n2697049\nViruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2\n10239;2559587;2732396;2732408;2732506;76804;2499399;11118;2501931;694002;2509511;694009;2697049\nsuperkingdom;clade;kingdom;phylum;class;order;suborder;family;subfamily;genus;subgenus;species;no rank\n</code></pre>"},{"location":"chinese/#reformat","title":"reformat \u751f\u6210\u6807\u51c6\u5c42\u7ea7\u7269\u79cd\u6ce8\u91ca","text":"<p>\u6709\u65f6\u5019\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5b8c\u6574\u7684\u5206\u7c7b\u5b66\u8c31\u7cfb\uff08complete lineage\uff09\uff0c\u56e0\u4e3a\u5f88\u591a\u7ea7\u522b\u5373\u4e0d\u5e38\u7528\uff0c\u800c\u4e14\u4e0d\u5b8c\u6574\u3002\u901a\u5e38\u53ea\u60f3\u4fdd\u7559\u754c\u95e8\u7eb2\u76ee\u79d1\u5c5e\u79cd\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u662f\u6240\u6709\u7269\u79cd\u90fd\u6709\u5b8c\u6574\u7684\u754c\u95e8\u7eb2\u76ee\u79d1\u5c5e\u79cd\u6c34\u5e73\uff0c\u7279\u522b\u662f\u75c5\u6bd2\u4ee5\u53ca\u4e00\u4e9b\u73af\u5883\u6837\u54c1\u3002 TaxonKit\u53ef\u4ee5\u7528\u81ea\u5b9a\u4e49\u5185\u5bb9\u66ff\u4ee3\u7f3a\u5931\u7684\u5206\u7c7b\u5355\u5143\uff0c\u5982\u7528\u201c__\u201d\u66ff\u4ee3\u3002 \u66f4\u5389\u5bb3\u6709\u7528\u7684\u662f\uff0cTaxonKit\u8fd8\u53ef\u4ee5\u7528\u66f4\u9ad8\u5c42\u7ea7\u7684\u5206\u7c7b\u5355\u5143\u4fe1\u606f\u6765\u8865\u9f50\u7f3a\u5931\u7684\u5c42\u7ea7 (<code>-F/--fill-miss-rank</code>)\uff0c\u6bd4\u5982</p> <pre><code># \u6ca1\u6709genus\u7684\u75c5\u6bd2\n$ echo 1327037 | taxonkit lineage | taxonkit reformat | cut -f 1,3\n1327037 Viruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;;Croceibacter phage P2559Y\n\n# -F\u53c2\u6570\u4f1a\u7528family\u4fe1\u606f\u6765\u8865\u9f50genus\u4fe1\u606f\n$ echo 1327037 | taxonkit lineage | taxonkit reformat -F | cut -f 1,3\n1327037 Viruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;unclassified Siphoviridae genus;Croceibacter phage P2559Y\n</code></pre> <p>\u8f93\u51fa\u683c\u5f0f\u53ef\u9009\u53ea\u8f93\u51fa\u90e8\u5206\u5206\u7c7b\u5b66\u6c34\u5e73\uff0c\u8fd8\u652f\u6301\u5236\u8868\u7b26\uff08<code>\"\\t\"</code>\uff09\uff0c\u518d\u914d\u5408\u4f5c\u8005\u7684\u53e6\u4e00\u4e2a\u5de5\u5177csvtk\uff0c\u53ef\u4ee5\u8f93\u51fa\u6f02\u4eae\u7684\u7ed3\u679c\u3002</p> <p>\u5176\u5b83\u6709\u7528\u7684\u9009\u9879\uff1a</p> <ul> <li><code>-P/--add-prefix</code>\uff1a\u7ed9\u6bcf\u4e2a\u5206\u7c7b\u5b66\u6c34\u5e73\u6dfb\u52a0\u524d\u7f00\uff0c\u6bd4\u5982<code>s__species</code>\u3002</li> <li><code>-t/--show-lineage-taxids</code>\uff1a\u8f93\u51fa\u5206\u7c7b\u5b66\u5355\u5143\u5bf9\u5e94\u7684TaxID\u3002</li> <li><code>-r/--miss-rank-repl</code>: \u66ff\u4ee3\u6ca1\u6709\u5bf9\u5e94rank\u7684taxon\u540d\u79f0</li> <li><code>-S/--pseudo-strain</code>: \u5bf9\u4e8e\u4f4e\u4e8especies\u4e14rank\u65e2\u4e0d\u662fsubspecies\u4e5f\u4e0d\u662fstrain\u7684taxid\uff0c\u4f7f\u7528\u6c34\u5e73\u6700\u4f4etaxon\u540d\u79f0\u505a\u4e3a\u83cc\u682a\u540d\u79f0\u3002</li> </ul> <p>\u4f8b\uff0c</p> <pre><code>$ echo -ne \"349741\\n1327037\"\\\n    | taxonkit lineage \\\n    | taxonkit reformat -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\" -F -P \\\n    | csvtk cut -t -f -2 \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species \\\n    | csvtk pretty -t\n\ntaxid     kindom        phylum               class                 order                   family               genus                                species\n349741    k__Bacteria   p__Verrucomicrobia   c__Verrucomicrobiae   o__Verrucomicrobiales   f__Akkermansiaceae   g__Akkermansia                       s__Akkermansia muciniphila\n1327037   k__Viruses    p__Uroviricota       c__Caudoviricetes     o__Caudovirales         f__Siphoviridae      g__unclassified Siphoviridae genus   s__Croceibacter phage P2559Y\n\n# \u4fbf\u4e8e\u5c0f\u5c4f\u5e55\u67e5\u770b\uff0c\u7528csvtk\u8fdb\u884c\u8f6c\u7f6e\n$ echo -ne \"349741\\n1327037\"\\\n    | taxonkit lineage \\\n    | taxonkit reformat -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\" -F -P \\\n    | csvtk cut -t -f -2 \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species \\\n    | csvtk transpose -t \\\n    | csvtk pretty -H -t\n\ntaxid     349741                       1327037\nkindom    k__Bacteria                  k__Viruses\nphylum    p__Verrucomicrobia           p__Uroviricota\nclass     c__Verrucomicrobiae          c__Caudoviricetes\norder     o__Verrucomicrobiales        o__Caudovirales\nfamily    f__Akkermansiaceae           f__Siphoviridae\ngenus     g__Akkermansia               g__unclassified Siphoviridae genus\nspecies   s__Akkermansia muciniphila   s__Croceibacter phage P2559Y\n\n# \u5230\u682a\u6c34\u5e73\uff0c\u4ee5sars-cov-2\u4e3a\u4f8b\n$ echo -ne \"2697049\"\\\n    | taxonkit lineage \\\n    | taxonkit reformat -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" -F -P -S \\\n    | csvtk cut -t -f -2 \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species,strain \\\n    | csvtk transpose -t \\\n    | csvtk pretty -H -t\n\ntaxid     2697049\nkindom    k__Viruses\nphylum    p__Pisuviricota\nclass     c__Pisoniviricetes\norder     o__Nidovirales\nfamily    f__Coronaviridae\ngenus     g__Betacoronavirus\nspecies   s__Severe acute respiratory syndrome-related coronavirus\nstrain    t__Severe acute respiratory syndrome coronavirus 2\n</code></pre>"},{"location":"chinese/#name2taxid-taxid","title":"name2taxid \u5c06\u5206\u7c7b\u5355\u5143\u540d\u79f0\u8f6c\u5316\u4e3aTaxID","text":"<p>\u5c06\u5206\u7c7b\u5355\u5143\u540d\u79f0\u8f6c\u5316\u4e3aTaxID\u975e\u5e38\u5bb9\u6613\u7406\u89e3\uff0c\u552f\u4e00\u8981\u6ce8\u610f\u7684\u662f\u67d0\u4e9bTaxId\u5bf9\u5e94\u76f8\u540c\u7684\u540d\u79f0\uff0c\u6bd4\u5982</p> <pre><code># -i\u6307\u5b9a\u5217\uff0c-r\u663e\u793a\u7ea7\u522b\uff0c-L\u4e0d\u663e\u793a\u4e16\u7cfb\n$ echo Drosophila | taxonkit name2taxid | taxonkit lineage -i 2 -r -L\nDrosophila      7215    genus\nDrosophila      32281   subgenus\nDrosophila      2081351 genus\n</code></pre> <p>\u83b7\u53d6TaxID\u4e4b\u540e\uff0c\u53ef\u4ee5\u7acb\u5373\u4f20\u7ed9taxonkit\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c\uff0c\u4f46\u8981\u6ce8\u610f\u7528<code>-i</code>\u6307\u5b9aTaxId\u6240\u5728\u5217\u3002</p>"},{"location":"chinese/#filter-taxids","title":"filter \u6309\u5206\u7c7b\u5b66\u6c34\u5e73\u8303\u56f4\u8fc7\u6ee4TaxIDs","text":"<p>filter\u53ef\u4ee5\u6309\u5206\u7c7b\u5b66\u6c34\u5e73\u8303\u56f4\u8fc7\u6ee4TaxIDs\uff0c\u6ce8\u610f\uff0c\u4e0d\u4ec5\u4ec5\u662f\u7279\u5b9a\u7684Rank\uff0c\u800c\u662f\u4e00\u4e2a\u8303\u56f4\u3002 \u6bd4\u5982genus\u53ca\u4ee5\u4e0b\u7684\u5206\u7c7b\u5b66\u6c34\u5e73\uff0c\u7528<code>-L genus -E genus</code>\uff0c\u7c7b\u4f3c\u4e8e <code>&lt;= genus</code>\u3002</p> <pre><code>$ cat taxids2.txt \\\n    | taxonkit filter -L genus -E genus  \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk -Ht cut -f 1,3,2 \\\n    | csvtk pretty -H -t\n239934   genus     Akkermansia\n239935   species   Akkermansia muciniphila\n349741   strain    Akkermansia muciniphila ATCC BAA-835\n</code></pre>"},{"location":"chinese/#lca-lca","title":"lca \u8ba1\u7b97\u6700\u4f4e\u516c\u5171\u7956\u5148(LCA)","text":"<p>\u6bd4\u5982\u4eba\u5c5e\u7684\u4f8b\u5b50</p> <pre><code>$ taxonkit list --ids 9605 -nr --indent \"    \"    \n9605 [genus] Homo\n    9606 [species] Homo sapiens\n        63221 [subspecies] Homo sapiens neanderthalensis\n        741158 [subspecies] Homo sapiens subsp. 'Denisova'\n    1425170 [species] Homo heidelbergensis\n    2665952 [no rank] environmental samples\n        2665953 [species] Homo sapiens environmental sample\n</code></pre> <p>TaxID\u7684\u5206\u9694\u7b26\u53ef\u7528<code>-s/--separater</code>\u6307\u5b9a\uff0c\u9ed8\u8ba4\u4e3a\" \"\u3002</p> <pre><code># \u8ba1\u7b97\u4e24\u4e2a\u7269\u79cd\u7684\u6700\u8fd1\u5171\u540c\u7956\u5148\uff0c\u4ee5\u4e0a\u9762\u5c3c\u5b89\u5fb7\u7279\u4eba\u4e9a\u79cd\u548c\u6d77\u5fb7\u5821\u4eba\u79cd\n$ echo 63221 2665953 | taxonkit lca\n63221 2665953   9605\n\n# \u5176\u5b83\u5206\u9694\u7b26\uff0c\u4e14\u4e0d\u5c0f\u5fc3\u591a\u4e86\u7a7a\u683c\n$ echo -ne \"a\\t63221,2665953\\nb\\t63221, 741158\\n\"\na       63221,2665953\nb       63221, 741158\n\n$ echo -ne \"a\\t63221,2665953\\nb\\t63221, 741158\\n\" \\\n    | taxonkit lca -i 2 -s \",\"\na       63221,2665953   9605\nb       63221, 741158   9606\n</code></pre>"},{"location":"chinese/#taxid-changelog-taxid","title":"TaxID changelog \u8ffd\u8e2aTaxID\u53d8\u66f4\u8bb0\u5f55","text":"<p>NCBI Taxonomy\u6570\u636e\u6bcf\u5929\u90fd\u5728\u66f4\u65b0\uff0c\u6bcf\u6708\u521d\uff08\u5927\u591a\u4e3a1\u53f7\uff09\u7684\u6570\u636e\u4f5c\u4e3a\u5b58\u6863\u4fdd\u5b58\u5728 <code>taxdump_archive/</code> \u76ee\u5f55\uff0c \u65e7\u7248\u672c\u6700\u65e9\u6570\u636e\u52302014\u5e748\u6708\uff0c\u65b0\u7248\u672c\u53ea\u52302018\u5e7412\u6708\u3002</p> <p>TaxonKit\u53ef\u4ee5\u8ffd\u8e2a\u6240\u6709TaxID\u6bcf\u4e2a\u6708\u7684\u53d8\u5316\uff0c\u8f93\u51fa\u5230csv\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u5de5\u5177\u8fdb\u884c\u67e5\u8be2\u3002 \u6570\u636e\u548c\u6587\u6863\u5355\u72ec\u6258\u7ba1\u5728 https://github.com/shenwei356/taxid-changelog \u3002</p> <p>\u9664\u4e86\u7b80\u5355\u7684\u589e\u52a0\u3001\u5220\u9664\u3001\u5408\u5e76\u4e4b\u5916\uff0c\u4f5c\u8005\u5c06TaxID\u6539\u53d8\u505a\u4e86\u7ec6\u5206\u3002\u8f93\u51fa\u683c\u5f0f\u5982\u4e0b</p> <pre><code># \u5217            \u5907\u6ce8\ntaxid           # taxid\nversion         # version / time of archive, e.g, 2019-07-01\nchange          # change, values:\n                #   NEW             \u65b0\u589e\n                #   REUSE_DEL       \u524d\u671f\u88ab\u5220\u9664\uff0c\u73b0\u5728\u53c8\u91cd\u65b0\u52a0\u5165\n                #   REUSE_MER       \u524d\u671f\u88ab\u5408\u5e76\uff0c\u73b0\u5728\u53c8\u91cd\u65b0\u52a0\u5165\n                #   DELETE          \u5220\u9664\n                #   MERGE           \u5408\u5e76\u5230\u53e6\u4e00\u4e2aTaxID\n                #   ABSORB          \u5176\u4ed6TaxID\u5408\u5e76\u5230\u5f53\u524dTaxID\n                #   CHANGE_NAME     \u540d\u79f0\u6539\u53d8\n                #   CHANGE_RANK     \u5206\u7c7b\u5b66\u6c34\u5e73\u6539\u53d8\n                #   CHANGE_LIN_LIN  \u8c31\u7cfb\u7684TaxID\u6ca1\u6709\u53d8\u5316\uff0c\u8c31\u7cfb\u6539\u53d8\uff08\u67d0\u4e9bTaxID\u7684\u540d\u79f0\u53d8\u4e86\uff09\n                #   CHANGE_LIN_TAX  \u8c31\u7cfb\u7684TaxID\u6539\u53d8\n                #   CHANGE_LIN_LEN  \u8c31\u7cfb\u7684\u957f\u5ea6/\u6df1\u5ea6\u53d1\u751f\u53d8\u5316\nchange-value    # variable values for changes: \n                #   1) new taxid for MERGE\n                #   2) merged taxids for ABSORB\n                #   3) empty for others\nname            # scientific name\nrank            # rank\nlineage         # complete lineage of the taxid\nlineage-taxids  # taxids of the lineage\n</code></pre> <p>\u6570\u636e\u6587\u4ef6\u53ef\u4ee5\u5728\u524d\u9762\u7f51\u7ad9\u4e0a\u4e0b\u8f7d\uff0c<code>taxid-changelog.csv.gz</code>\uff0c130M\u5de6\u53f3\uff0c\u89e3\u538b\u540e2.2G\uff0c\u56e0\u4e3a\u662fgzip\u683c\u5f0f\uff0c\u5b8c\u5168\u4e0d\u9700\u8981\u89e3\u538b\u5373\u53ef\u5206\u6790\u3002 \u4e0b\u6587\u4f7f\u7528\u4e86<code>pigz</code>\u4ee3\u66ff<code>zcat</code>\u548c<code>gzip</code>\u63d0\u9ad8\u89e3\u538b\u901f\u5ea6\u3002</p> <p>\u4f8b1 superkingdom\u4e5f\u80fd\u6d88\u5931 \uff0c\u6bd4\u5982\u7c7b\u75c5\u6bd2(Viroids)\u57282019\u5e745\u6708\u88ab\u5220\u9664\u4e86\u3002 \u4f5c\u8005\u662f\u5728\u67d0\u4e00\u5929\u65e0\u610f\u4e2d\u53d1\u73b0\u6b64\u4e8b\uff0c\u6240\u4ee5\u51b3\u5b9a\u5228\u6839\u95ee\u5e95\uff0c\u5f00\u53d1\u4e86\u8fd9\u4e2a\u5b50\u547d\u4ee4\u3002</p> <pre><code># \u4e0b\u8f7d\nwget -c https://github.com/shenwei356/taxid-changelog/releases/download/v2021.01/taxid-changelog.csv.gz\n# \u5b89\u88c5\u591a\u7ebf\u7a0b\u89e3\u538b\u7d22\u8f6f\u4ef6\u3002\u6216\u8005\u7528gzip\u66ff\u6362\u3002\nconda install pigz\n\n$ pigz -cd taxid-changelog.csv.gz \\\n    | csvtk grep -f rank -p superkingdom \\\n    | csvtk pretty \ntaxid   version      change   change-value   name        rank           lineage                        lineage-taxids\n2       2014-08-01   NEW                     Bacteria    superkingdom   cellular organisms;Bacteria    131567;2\n2157    2014-08-01   NEW                     Archaea     superkingdom   cellular organisms;Archaea     131567;2157\n2759    2014-08-01   NEW                     Eukaryota   superkingdom   cellular organisms;Eukaryota   131567;2759\n10239   2014-08-01   NEW                     Viruses     superkingdom   Viruses                        10239\n12884   2014-08-01   NEW                     Viroids     superkingdom   Viroids                        12884\n12884   2019-05-01   DELETE                  Viroids     superkingdom   Viroids                        12884\n</code></pre> <p>\u4f8b2 SARS-CoV-2 \u3002\u53ef\u89c1\u65b0\u51a0\u75c5\u6bd2\u57282020\u5e742\u6708\u52a0\u5165\uff0c\u968f\u540e3\u6708\u548c6\u6708\u4efd\u6539\u4e86\u540d\u79f0\uff0c\u8c31\u7cfb\u7b49\u4fe1\u606f\u3002\u67e5\u8be2\u901f\u5ea6\u4e5f\u5f88\u5feb\u3002</p> <pre><code># \u672c\u4f8b\u5b50\u53ea\u663e\u793a\u4e86\u90e8\u5206\u5217\u3002\n$ time pigz -cd taxid-changelog.csv.gz \\\n    | csvtk grep -f taxid -p 2697049 \\\n    | csvtk cut -f version,change,name,rank \\\n    | csvtk pretty\n\nversion      change           name                                              rank\n2020-02-01   NEW              Wuhan seafood market pneumonia virus              species\n2020-03-01   CHANGE_NAME      Severe acute respiratory syndrome coronavirus 2   no rank\n2020-03-01   CHANGE_RANK      Severe acute respiratory syndrome coronavirus 2   no rank\n2020-03-01   CHANGE_LIN_LEN   Severe acute respiratory syndrome coronavirus 2   no rank\n2020-06-01   CHANGE_LIN_LEN   Severe acute respiratory syndrome coronavirus 2   no rank\n2020-07-01   CHANGE_RANK      Severe acute respiratory syndrome coronavirus 2   isolate\n2020-08-01   CHANGE_RANK      Severe acute respiratory syndrome coronavirus 2   no rank\n\nreal    0m7.644s\nuser    0m16.749s\nsys     0m3.985s\n</code></pre> <p>\u66f4\u591a\u6709\u610f\u601d\u7684\u53d1\u73b0\u8be6\u89c1taxid-changelog</p>"},{"location":"download/","title":"Download","text":"<p><code>TaxonKit</code> is implemented in Go programming language,  executable binary files for most popular operating systems are freely available   in release page.</p>"},{"location":"download/#current-version","title":"Current Version","text":"<ul> <li>TaxonKit v0.15.1 <ul> <li><code>taxonkit name2taxid</code>:<ul> <li>remove the restriction of name types. #87</li> </ul> </li> </ul> </li> </ul>"},{"location":"download/#please-cite","title":"Please cite","text":"<p>Shen, W., Ren, H., TaxonKit: a practical and efficient NCBI Taxonomy toolkit, Journal of Genetics and Genomics, https://doi.org/10.1016/j.jgg.2021.03.006</p>"},{"location":"download/#links","title":"Links","text":"<p>Tips</p> <ul> <li>run <code>taxonkit version</code> to check update !!!</li> <li>run <code>taxonkit genautocomplete</code> to update Bash completion !!!</li> </ul> OS Arch File, \u4e2d\u56fd\u955c\u50cf Download Count Linux 64-bit taxonkit_linux_amd64.tar.gz, \u4e2d\u56fd\u955c\u50cf Linux arm64 taxonkit_linux_arm64.tar.gz, \u4e2d\u56fd\u955c\u50cf macOS 64-bit taxonkit_darwin_amd64.tar.gz, \u4e2d\u56fd\u955c\u50cf macOS arm64 taxonkit_darwin_arm64.tar.gz, \u4e2d\u56fd\u955c\u50cf Windows 64-bit taxonkit_windows_amd64.exe.tar.gz, \u4e2d\u56fd\u955c\u50cf"},{"location":"download/#installation","title":"Installation","text":"<p>Download Page</p> <p><code>TaxonKit</code> is implemented in Go programming language,  executable binary files for most popular operating systems are freely available   in release page.</p>"},{"location":"download/#method-1-download-binaries-latest-stabledev-version","title":"Method 1: Download binaries (latest stable/dev version)","text":"<p>Just download compressed executable file of your operating system, and uncompress it with <code>tar -zxvf *.tar.gz</code> command or other tools. And then:</p> <ol> <li> <p>For Linux-like systems</p> <ol> <li> <p>If you have root privilege simply copy it to <code>/usr/local/bin</code>:</p> <pre><code>sudo cp taxonkit /usr/local/bin/\n</code></pre> </li> <li> <p>Or copy to anywhere in the environment variable <code>PATH</code>:</p> <pre><code>mkdir -p $HOME/bin/; cp taxonkit $HOME/bin/\n</code></pre> </li> </ol> </li> <li> <p>For windows, just copy <code>taxonkit.exe</code> to <code>C:\\WINDOWS\\system32</code>.</p> </li> </ol>"},{"location":"download/#method-2-install-via-conda-latest-stable-version","title":"Method 2: Install via conda  (latest stable version)","text":"<pre><code>conda install -c bioconda taxonkit\n</code></pre>"},{"location":"download/#method-3-install-via-homebrew-may-not-the-lastest-version","title":"Method 3: Install via homebrew (may not the lastest version)","text":"<pre><code>brew install brewsci/bio/taxonkit\n</code></pre>"},{"location":"download/#method-4-compile-from-source-latest-stabledev-version","title":"Method 4: Compile from source (latest stable/dev version)","text":"<ol> <li> <p>Install go</p> <pre><code>wget https://go.dev/dl/go1.17.13.linux-amd64.tar.gz\n\ntar -zxf go1.17.13.linux-amd64.tar.gz -C $HOME/\n\n# or \n#   echo \"export PATH=$PATH:$HOME/go/bin\" &gt;&gt; ~/.bashrc\n#   source ~/.bashrc\nexport PATH=$PATH:$HOME/go/bin\n</code></pre> </li> <li> <p>Compile TaxonKit</p> <pre><code># ------------- the latest stable version -------------\n\ngo get -v -u github.com/shenwei356/taxonkit/taxonkit\n\n# The executable binary file is located in:\n#   ~/go/bin/taxonkit\n# You can also move it to anywhere in the $PATH\nmkdir -p $HOME/bin\ncp ~/go/bin/taxonkit $HOME/bin/\n\n# --------------- the development version --------------\n\ngit clone https://github.com/shenwei356/taxonkit\ncd taxonkit/taxonkit/\ngo build\n\n# The executable binary file is located in:\n#   ./taxonkit\n# You can also move it to anywhere in the $PATH\nmkdir -p $HOME/bin\ncp ./taxonkit $HOME/bin/\n</code></pre> </li> </ol>"},{"location":"download/#bash-completion","title":"Bash-completion","text":"<p>Supported shell: bash|zsh|fish|powershell</p> <p>Bash:</p> <pre><code># generate completion shell\ntaxonkit genautocomplete --shell bash\n\n# configure if never did.\n# install bash-completion if the \"complete\" command is not found.\necho \"for bcfile in ~/.bash_completion.d/* ; do source \\$bcfile; done\" &gt;&gt; ~/.bash_completion\necho \"source ~/.bash_completion\" &gt;&gt; ~/.bashrc\n</code></pre> <p>Zsh:</p> <pre><code># generate completion shell\ntaxonkit genautocomplete --shell zsh --file ~/.zfunc/_taxonkit\n\n# configure if never did\necho 'fpath=( ~/.zfunc \"${fpath[@]}\" )' &gt;&gt; ~/.zshrc\necho \"autoload -U compinit; compinit\" &gt;&gt; ~/.zshrc\n</code></pre> <p>fish:</p> <pre><code>taxonkit genautocomplete --shell fish --file ~/.config/fish/completions/taxonkit.fish\n</code></pre>"},{"location":"download/#dataset","title":"Dataset","text":"<ol> <li>Download and uncompress <code>taxdump.tar.gz</code>: ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz </li> <li>Copy <code>names.dmp</code>, <code>nodes.dmp</code>, <code>delnodes.dmp</code> and <code>merged.dmp</code> to data directory: <code>$HOME/.taxonkit</code>, e.g., <code>/home/shenwei/.taxonkit</code> ,</li> <li>Optionally copy to some other directories, and later you can refer to using flag <code>--data-dir</code>, or environment variable <code>TAXONKIT_DB</code>.</li> </ol> <p>All-in-one command:</p> <pre><code>wget -c ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz \ntar -zxvf taxdump.tar.gz\n\nmkdir -p $HOME/.taxonkit\ncp names.dmp nodes.dmp delnodes.dmp merged.dmp $HOME/.taxonkit\n</code></pre> <p>Update dataset: Simply re-download the taxdump files, uncompress and override old ones.</p>"},{"location":"download/#release-history","title":"Release history","text":"<ul> <li>TaxonKit v0.15.0 <ul> <li><code>taxonkit reformat</code>:<ul> <li>For lineages with more than one node, if it fails to query TaxId with the parent-child pair, use the last child only. #82</li> <li>The flag <code>-T/--trim</code> also does not add the prefix for missing ranks lower than the current rank. #82</li> <li>New flag <code>-s/--miss-rank-repl-suffix</code> to set the suffix for estimated taxon names. #85</li> </ul> </li> </ul> </li> <li>TaxonKit v0.14.2 <ul> <li><code>taxonkit filter</code>:<ul> <li>fix checking merged/deleted/not-found taxids. #80</li> </ul> </li> <li><code>taxonkit lca</code>:<ul> <li>add a new flag <code>-b/--buffer-size</code> to set the size of the line buffer. #75</li> <li>fix typos: <code>--separater</code> -&gt; <code>--separater</code>, the former is still available for backward compatibility.</li> </ul> </li> <li><code>taxonkit reformat</code>:<ul> <li>output compatible format for TaxIds not found in the database. #79</li> </ul> </li> <li><code>taxonkit taxid-changelog</code>:<ul> <li>support gzip-compressed taxdump files for saving space. #78</li> </ul> </li> </ul> </li> <li>TaxonKit v0.14.1 <ul> <li><code>taxonkit reformat</code>:<ul> <li>The flag <code>-S/--pseudo-strain</code> does not require <code>-F/--fill-miss-rank</code> now.</li> <li>For taxa of rank &gt;= species, <code>{t}</code>, <code>{S}</code>, and <code>T</code> outputs nothing when using <code>-S/--pseudo-strain</code>.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.14.0 <ul> <li><code>taxonkit create-taxdump</code>:<ul> <li>save taxIds in <code>int32</code> instead of <code>uint32</code>, as BLAST and DIAMOND do. #70</li> </ul> </li> <li><code>taxonkit list</code>:<ul> <li>do not skip visited subtrees when some of give taxids are descendants of others. #68</li> </ul> </li> <li><code>taxonkit</code>:<ul> <li>when environment variable <code>TAXONKIT_DB</code> is set, explicitly setting <code>--data-dir</code> will override the value of <code>TAXONKIT_DB</code>.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.13.0 <ul> <li><code>taxonkit reformat</code>:<ul> <li>add a new placeholder <code>{K}</code> for rank <code>kingdom</code>. #64</li> <li>do not panic for invalid TaxIds, e.g., the column name, when using <code>-I--taxid-field</code>.</li> </ul> </li> <li><code>taxonkit create-taxdump</code>: <ul> <li>fix merged.dmp and delnodes.dmp. Thanks to @apcamargo ! gtdb-taxdump/issues/2.</li> <li>fix bug of handling non-GTDB data when using <code>-A/--field-accession</code> and no rank names given:   the colname of the accession column would be treated as one of the ranks, which messed up all the ranks.</li> <li>fix the default option value of <code>--field-accession-re</code> which wrongly remove prefix like <code>Sp_</code>. #65</li> </ul> </li> <li><code>taxonkit list</code>:<ul> <li>fix warning message of merged taxids.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.12.0 <ul> <li><code>taxonkit create-taxdump</code>: <ul> <li>accepts arbitrary ranks #60</li> <li>better handle of taxa with same names.</li> <li>many flags changed.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.11.1 <ul> <li><code>taxonkit create-taxdump</code>: fix bug of missing Class rank, contributed by @apcamargo. The flag <code>--gtdb</code> was not effected. #57</li> </ul> </li> <li>TaxonKit v0.11.0 <ul> <li>new command <code>taxonkit create-taxdump</code>: Create NCBI-style taxdump files for custom taxonomy, e.g., GTDB and ICTV. #56</li> </ul> </li> <li>TaxonKit v0.10.1 <ul> <li><code>taxonkit cami2-filter</code>: fix option <code>--show-rank</code> which did not work in v0.10.0.</li> </ul> </li> <li>TaxonKit v0.10.0 <ul> <li>new command <code>taxonkit cami2-filter</code>: Remove taxa of given TaxIds and their descendants in CAMI metagenomic profile</li> <li><code>taxonkit reformat</code>: fix panic for deleted taxid using <code>-F/--fill-miss-rank</code>. #55</li> </ul> </li> <li>TaxonKit v0.9.0 <ul> <li>new command <code>taxonkit profile2cami</code>: converting metagenomic profile table to CAMI format</li> </ul> </li> <li>TaxonKit v0.8.0 <ul> <li><code>taxonkit reformat</code>:<ul> <li>accept input of TaxIds via flag <code>-I/--taxid-field</code>.</li> <li>accept single taxonomy names.</li> <li>show warning message for TaxIds with the same lineage. #42</li> <li>better flag checking. #40</li> </ul> </li> <li><code>taxonkit lca</code>:<ul> <li>slightly speedup.</li> </ul> </li> <li><code>taxonkit genautocomplete</code>:<ul> <li>support bash|zsh|fish/powershell</li> </ul> </li> </ul> </li> <li>TaxonKit v0.7.2 <ul> <li><code>taxonkit lineage</code>:<ul> <li>new flag <code>-R/--show-lineage-ranks</code> for appending ranks of all levels.</li> <li>reduce memory occupation and slightly speedup.</li> </ul> </li> <li><code>taxonkit filter</code>:<ul> <li>flag <code>-E/--equal-to</code> supports multiple values.</li> <li>new flag <code>-n/--save-predictable-norank</code>: do not discard some special ranks without order when using -L, where rank of the closest higher node is still lower than rank cutoff.</li> </ul> </li> <li><code>taxonkit reformat</code>:<ul> <li>new placeholder <code>{t}</code> for <code>subspecies/strain</code>, <code>{T}</code> for <code>strain</code>. Thanks @wqssf102 for feedback.</li> <li>new flag <code>-S/--pseudo-strain</code> for using the node with lowest rank as strain name, only if which rank is lower than \"species\" and not \"subpecies\" nor \"strain\". </li> </ul> </li> </ul> </li> <li>TaxonKit v0.7.1 <ul> <li><code>taxonkit filter</code>: <ul> <li>disable unnecessary stdin check when using flag <code>--list-order</code> or <code>--list-ranks</code>. #36</li> <li>better handling of black list, empty default value: \"no rank\" and \"clade\". And you need use <code>-N/--discard-noranks</code> to explicitly filter out \"no rank\", \"clade\". #37</li> <li>update help message. Thanks @standage for improve this command! #38</li> </ul> </li> </ul> </li> <li>TaxonKit v0.7.0 <ul> <li><code>taxonkit</code>: 2-3X faster taxonomy data loading.</li> <li>new command <code>taxonkit filter</code>: filtering TaxIds by taxonomic rank range. #32</li> <li>new command <code>taxonkit lca</code>: Computing lowest common ancestor (LCA) for TaxIds.</li> <li><code>taxonkit reformat</code>:<ul> <li>new flag <code>-P/--add-prefix</code>: add prefixes for all ranks, single prefix for a rank is defined by flag <code>--prefix-X</code>, where <code>X</code> may be <code>k</code>, <code>p</code>, <code>c</code>, <code>o</code>, <code>f</code>, <code>s</code>, <code>S</code>.</li> <li>new flag <code>-T/--trim</code>: do not fill missing rank lower than current rank.</li> </ul> </li> <li><code>taxonkit list</code>: do not duplicate root node.</li> </ul> </li> <li>TaxonKit v0.6.2 <ul> <li><code>taxonkit reformat -F</code>: fix taxids of abbreviated lineage containing names shared by different taxids. #35</li> </ul> </li> <li>TaxonKit v0.6.1 <ul> <li><code>taxonkit lineage</code>: <ul> <li>new flag <code>-n/--show-name</code> for appending scientific name.</li> <li>new flag <code>-L/--no-lineage</code> for hide lineage, this is for fast retrieving names or/and ranks.</li> </ul> </li> <li><code>taxonkit reformat</code>:<ul> <li>fix flag <code>-F/--fill-miss-rank</code>.</li> <li>discard order restriction of rank symbols.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.6.0 <ul> <li><code>taxonkit list</code>:<ul> <li>check merged and deleted taxids.</li> <li>fix bug of json output. #30</li> </ul> </li> <li><code>taxonkit name2taxid</code>: new flag <code>-s/--sci-name</code> for limiting to searching scientific names. #29</li> <li><code>taxonkit version</code>: make checking update optional</li> </ul> </li> <li>TaxonKit v0.5.0 <ul> <li><code>taxonkit</code>: requiring delnodes.dmp and merged.dmp.</li> <li><code>taxonkit lineage</code>: detect deleted and merged taxids now. #19</li> <li><code>taxonkit list/name2taxid</code>: add short flag <code>-r</code> for <code>--show-rank</code>, <code>-n</code> for <code>--show-name</code>.</li> </ul> </li> <li>TaxonKit v0.4.3 <ul> <li><code>taxonkit taxid-changelog</code>: rewrite logic, fix bug and add more change types</li> </ul> </li> <li>TaxonKit v0.4.2 <ul> <li><code>taxonkit taxid-changelog</code>: change output of <code>ABSORB</code>, do not merged into one record for changes in different versions.</li> </ul> </li> <li>TaxonKit v0.4.1 <ul> <li><code>taxonkit taxid-changelog</code>: <ul> <li>add fields: <code>name</code> and <code>rank</code>.</li> <li>and fix sorting bug.</li> <li>detailed lineage change status</li> </ul> </li> </ul> </li> <li>TaxonKit v0.4.0 <ul> <li>new command: <code>taxonkit taxid-changelog</code>: for creating taxid changelog from dump archive</li> </ul> </li> <li>TaxonKit v0.3.0 <ul> <li>this version is almost the same as v0.2.5</li> </ul> </li> <li>TaxonKit v0.2.5 <ul> <li>add global flag: <code>--line-buffered</code> to disable output buffer. #11</li> <li>replace global flags <code>--names-file</code> and <code>--nodes-file</code> with <code>--data-dir</code>, also support environment variable <code>TAXONKIT_DB</code>. #17</li> <li><code>taxonkit reformat</code>: detects lineages containing unofficial taxon name and won't show panic message.</li> <li><code>taxonkit name2taxid</code>: supports synonyms names. #9</li> <li><code>taxokit lineage</code>: add flag <code>-r/--show-rank</code> to print rank at another new column.</li> </ul> </li> <li>TaxonKit v0.2.4 <ul> <li><code>taxonkit reformat</code>:<ul> <li>more accurate result when using flag <code>-F/--fill-miss-rank</code> to estimate and fill missing rank with original lineage information</li> <li>supporting escape strings like <code>\\t</code>, <code>\\n</code>, #5</li> <li>outputting corresponding taxids for reformated lineage. #8</li> </ul> </li> <li><code>taxonkit lineage</code>:<ul> <li>fix bug for taxid <code>1</code> #7</li> <li>add flag <code>-d/--delimiter</code>.</li> </ul> </li> </ul> </li> <li>TaxonKit v0.2.3 <ul> <li>fix bug brought in v0.2.1</li> </ul> </li> <li>TaxonKit v0.2.2 <ul> <li>make verbose information optional #4</li> </ul> </li> <li>TaxonKit v0.2.1 <ul> <li><code>taxonkit list</code>: fix bug of no output for leaf nodes of the taxonomic tree. #4</li> <li>add new command <code>genautocomplete</code> to generate shell autocompletion script!</li> </ul> </li> <li>TaxonKit v0.2.0 <ul> <li>add command <code>name2taxid</code> to query taxid by taxon scientific name.</li> <li><code>lineage</code>, <code>reformat</code>: changed flags and default operations,  check the usage.</li> </ul> </li> <li>TaxonKit v0.1.8 <ul> <li><code>taxonkit lineage</code>, add an extra column of lineage in Taxid.  #3. e.g.,</li> <li>fix colorful output in windows.</li> </ul> </li> <li>TaxonKit v0.1.7 <ul> <li><code>taxonkit reformat</code>: supports reading stdin from output of <code>taxonkit lineage</code>,  reformated lineages are appended to input data.</li> </ul> </li> <li>TaxonKit v0.1.6 <ul> <li>remove flag <code>-f/--formated-rank</code> from <code>taxonkit lineage</code>,   using <code>taxonkit reformat</code> can archieve same result.</li> </ul> </li> <li>TaxonKit v0.1.5 <ul> <li>reorganize code and flags</li> </ul> </li> <li>TaxonKit v0.1.4 <ul> <li>add flag <code>--fill</code> for <code>taxonkit reformat</code>, which estimates and fills missing rank with original lineage information</li> </ul> </li> <li>TaxonKit v0.1.3 <ul> <li>add command of <code>taxonkit reformat</code> which reformats full lineage to custom format</li> </ul> </li> <li>TaxonKit v0.1.2 <ul> <li>add command of <code>taxonkit lineage</code>, users can query lineage of given taxon IDs from file</li> </ul> </li> <li>TaxonKit v0.1.1 <ul> <li>add feature of <code>taxonkit list</code>, users can choose output in readable JSON  format by flag <code>--json</code> so the taxonomy tree could be collapse and  uncollapse in modern text editor.</li> </ul> </li> <li>TaxonKit v0.1 <ul> <li>first release</li> </ul> </li> </ul> Please enable JavaScript to view the comments powered by Disqus."},{"location":"tutorial/","title":"Tutorial","text":""},{"location":"tutorial/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Formatting lineage</li> <li>Parsing kraken/bracken result</li> <li>Making nr blastdb for specific taxids</li> <li>Summaries of taxonomy data</li> <li>Merging GTDB and NCBI taxonomy</li> </ul>"},{"location":"tutorial/#formatting-lineage","title":"Formatting lineage","text":"<p>Show lineage detail of a TaxId. The command below works on Windows with help of csvtk.</p> <pre><code>$ echo \"2697049\" \\\n    | taxonkit lineage -t \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -Ht\n\n10239     superkingdom   Viruses\n2559587   clade          Riboviria\n2732396   kingdom        Orthornavirae\n2732408   phylum         Pisuviricota\n2732506   class          Pisoniviricetes\n76804     order          Nidovirales\n2499399   suborder       Cornidovirineae\n11118     family         Coronaviridae\n2501931   subfamily      Orthocoronavirinae\n694002    genus          Betacoronavirus\n2509511   subgenus       Sarbecovirus\n694009    species        Severe acute respiratory syndrome-related coronavirus\n2697049   no rank        Severe acute respiratory syndrome coronavirus 2\n</code></pre> <p>Example data.</p> <pre><code>$ cat taxids3.txt\n376619\n349741\n239935\n314101\n11932\n1327037\n83333\n1408252\n2605619\n2697049\n</code></pre> <p>Format to 7-level ranks (\"superkingdom phylum class order family genus species\").</p> <pre><code>$ cat taxids3.txt \\\n    | taxonkit reformat -I 1\n\n376619  Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis\n349741  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n314101  Bacteria;;;;;;uncultured murine large bowel bacterium BAC 54B\n11932   Viruses;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\n1327037 Viruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;;Croceibacter phage P2559Y\n83333   Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli\n1408252 Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli\n2605619 Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli\n2697049 Viruses;Pisuviricota;Pisoniviricetes;Nidovirales;Coronaviridae;Betacoronavirus;Severe acute respiratory syndrome-related coronavirus\n</code></pre> <p>Format to 8-level ranks (\"superkingdom phylum class order family genus species subspecies/rank\").</p> <pre><code>$ cat taxids3.txt \\\n    | taxonkit reformat -I 1 -f \"{k};{p};{c};{o};{f};{g};{s};{t}\"\n\n376619  Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;Francisella tularensis subsp. holarctica LVS\n349741  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;\n314101  Bacteria;;;;;;uncultured murine large bowel bacterium BAC 54B;\n11932   Viruses;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle;\n1327037 Viruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;;Croceibacter phage P2559Y;\n83333   Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli;Escherichia coli K-12\n1408252 Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli;Escherichia coli R178\n2605619 Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli;\n2697049 Viruses;Pisuviricota;Pisoniviricetes;Nidovirales;Coronaviridae;Betacoronavirus;Severe acute respiratory syndrome-related coronavirus;\n</code></pre> <p>Replace missing ranks with <code>Unassigned</code> and output tab-delimited format.</p> <pre><code>$ cat taxids3.txt \\\n    | taxonkit reformat -I 1 -r \"Unassigned\" -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n    | csvtk pretty -H -t\n\n376619    Bacteria   Proteobacteria    Gammaproteobacteria   Thiotrichales        Francisellaceae      Francisella                  Francisella tularensis                                  Francisella tularensis subsp. holarctica LVS\n349741    Bacteria   Verrucomicrobia   Verrucomicrobiae      Verrucomicrobiales   Akkermansiaceae      Akkermansia                  Akkermansia muciniphila                                 Akkermansia muciniphila ATCC BAA-835\n239935    Bacteria   Verrucomicrobia   Verrucomicrobiae      Verrucomicrobiales   Akkermansiaceae      Akkermansia                  Akkermansia muciniphila                                 Unassigned\n314101    Bacteria   Unassigned        Unassigned            Unassigned           Unassigned           Unassigned                   uncultured murine large bowel bacterium BAC 54B         Unassigned\n11932     Viruses    Artverviricota    Revtraviricetes       Ortervirales         Retroviridae         Intracisternal A-particles   Mouse Intracisternal A-particle                         Unassigned\n1327037   Viruses    Uroviricota       Caudoviricetes        Caudovirales         Siphoviridae         Unassigned                   Croceibacter phage P2559Y                               Unassigned\n83333     Bacteria   Proteobacteria    Gammaproteobacteria   Enterobacterales     Enterobacteriaceae   Escherichia                  Escherichia coli                                        Escherichia coli K-12\n1408252   Bacteria   Proteobacteria    Gammaproteobacteria   Enterobacterales     Enterobacteriaceae   Escherichia                  Escherichia coli                                        Escherichia coli R178\n2605619   Bacteria   Proteobacteria    Gammaproteobacteria   Enterobacterales     Enterobacteriaceae   Escherichia                  Escherichia coli                                        Unassigned\n2697049   Viruses    Pisuviricota      Pisoniviricetes       Nidovirales          Coronaviridae        Betacoronavirus              Severe acute respiratory syndrome-related coronavirus   Unassigned\n</code></pre> <p>Fill missing ranks and add prefixes.</p> <pre><code>$ cat taxids3.txt \\\n    | taxonkit reformat -I 1 -F -P -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n    | csvtk pretty -H -t\n\n376619    k__Bacteria   p__Proteobacteria                 c__Gammaproteobacteria           o__Thiotrichales                 f__Francisellaceae                g__Francisella                       s__Francisella tularensis                                  t__Francisella tularensis subsp. holarctica LVS\n349741    k__Bacteria   p__Verrucomicrobia                c__Verrucomicrobiae              o__Verrucomicrobiales            f__Akkermansiaceae                g__Akkermansia                       s__Akkermansia muciniphila                                 t__Akkermansia muciniphila ATCC BAA-835\n239935    k__Bacteria   p__Verrucomicrobia                c__Verrucomicrobiae              o__Verrucomicrobiales            f__Akkermansiaceae                g__Akkermansia                       s__Akkermansia muciniphila                                 t__unclassified Akkermansia muciniphila subspecies/strain\n314101    k__Bacteria   p__unclassified Bacteria phylum   c__unclassified Bacteria class   o__unclassified Bacteria order   f__unclassified Bacteria family   g__unclassified Bacteria genus       s__uncultured murine large bowel bacterium BAC 54B         t__unclassified uncultured murine large bowel bacterium BAC 54B subspecies/strain\n11932     k__Viruses    p__Artverviricota                 c__Revtraviricetes               o__Ortervirales                  f__Retroviridae                   g__Intracisternal A-particles        s__Mouse Intracisternal A-particle                         t__unclassified Mouse Intracisternal A-particle subspecies/strain\n1327037   k__Viruses    p__Uroviricota                    c__Caudoviricetes                o__Caudovirales                  f__Siphoviridae                   g__unclassified Siphoviridae genus   s__Croceibacter phage P2559Y                               t__unclassified Croceibacter phage P2559Y subspecies/strain\n83333     k__Bacteria   p__Proteobacteria                 c__Gammaproteobacteria           o__Enterobacterales              f__Enterobacteriaceae             g__Escherichia                       s__Escherichia coli                                        t__Escherichia coli K-12\n1408252   k__Bacteria   p__Proteobacteria                 c__Gammaproteobacteria           o__Enterobacterales              f__Enterobacteriaceae             g__Escherichia                       s__Escherichia coli                                        t__Escherichia coli R178\n2605619   k__Bacteria   p__Proteobacteria                 c__Gammaproteobacteria           o__Enterobacterales              f__Enterobacteriaceae             g__Escherichia                       s__Escherichia coli                                        t__unclassified Escherichia coli subspecies/strain\n2697049   k__Viruses    p__Pisuviricota                   c__Pisoniviricetes               o__Nidovirales                   f__Coronaviridae                  g__Betacoronavirus                   s__Severe acute respiratory syndrome-related coronavirus   t__unclassified Severe acute respiratory syndrome-related coronavirus subspecies/strain\n</code></pre> <p>When these's no nodes of rank \"subspecies\" nor \"strain\", we can switch <code>-S/--pseudo-strain</code> to use the node with lowest rank as subspecies/strain name, if which rank is lower than \"species\".</p> <pre><code>$ cat taxids3.txt \\\n    | taxonkit lineage -r -L \\\n    | taxonkit reformat -I 1 -F -S -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n    | cut -f 1,2,9,10 \\\n    | csvtk add-header -t -n \"taxid,rank,species,strain\" \\\n    | csvtk pretty -t\n\ntaxid     rank         species                                                 strain\n-------   ----------   -----------------------------------------------------   ------------------------------------------------------------------------------\n376619    strain       Francisella tularensis                                  Francisella tularensis subsp. holarctica LVS\n349741    strain       Akkermansia muciniphila                                 Akkermansia muciniphila ATCC BAA-835\n239935    species      Akkermansia muciniphila                                 unclassified Akkermansia muciniphila subspecies/strain\n314101    species      uncultured murine large bowel bacterium BAC 54B         unclassified uncultured murine large bowel bacterium BAC 54B subspecies/strain\n11932     species      Mouse Intracisternal A-particle                         unclassified Mouse Intracisternal A-particle subspecies/strain\n1327037   species      Croceibacter phage P2559Y                               unclassified Croceibacter phage P2559Y subspecies/strain\n83333     strain       Escherichia coli                                        Escherichia coli K-12\n1408252   subspecies   Escherichia coli                                        Escherichia coli R178\n2605619   no rank      Escherichia coli                                        Escherichia coli O16:H48\n2697049   no rank      Severe acute respiratory syndrome-related coronavirus   Severe acute respiratory syndrome coronavirus 2\n</code></pre> <p>List eight-level lineage for all TaxIds of rank lower than or equal to species, including some nodes with \"no rank\". But when filtering with <code>-L/--lower-than</code>, you can use <code>-n/--save-predictable-norank</code> to save some special ranks without order, where rank of the closest higher node is still lower than rank cutoff.</p> <pre><code>$ time taxonkit list --ids 1 \\\n    | taxonkit filter -L species -E species -R -N -n \\\n    | taxonkit lineage -n -r -L \\\n    | taxonkit reformat -I 1 -F -S -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n    | csvtk cut -Ht -l -f 1,3,2,1,4-11 \\\n    | csvtk add-header -t -n \"taxid,rank,name,lineage,kingdom,phylum,class,order,family,genus,species,strain\" \\\n    | pigz -c &gt; result.tsv.gz\n\nreal    0m25.167s\nuser    2m14.809s\nsys     0m7.197s\n\n$ pigz -cd result.tsv.gz \\\n    | csvtk grep -t -f taxid -p 2697049 \\\n    | csvtk transpose -t \\\n    | csvtk pretty -H -t\n\ntaxid     2697049\nrank      no rank\nname      Severe acute respiratory syndrome coronavirus 2\nlineage   Viruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2\nkingdom   Viruses\nphylum    Pisuviricota\nclass     Pisoniviricetes\norder     Nidovirales\nfamily    Coronaviridae\ngenus     Betacoronavirus\nspecies   Severe acute respiratory syndrome-related coronavirus\nstrain    Severe acute respiratory syndrome coronavirus 2\n</code></pre>"},{"location":"tutorial/#mapping-old-species-names-to-new-ones","title":"Mapping old species names to new ones","text":"<p>Some species names in papers or websites might changed, we can try querying their TaxIds via their old new names and then retrieve the new ones.</p> <pre><code>cat example/changed_species_names.txt\nLactobacillus fermentum\nMycoplasma gallinaceum\n\n#  TaxonKit &gt;= v0.15.1\ncat example/changed_species_names.txt \\\n    | taxonkit name2taxid \\\n    | taxonkit lineage -i 2 -n \\\n    | cut -f 1,4\n\nLactobacillus fermentum Limosilactobacillus fermentum\nMycoplasma gallinaceum\n</code></pre> <p>Woops, there's no information of <code>Mycoplasma gallinaceum</code>. Then we check the taxid-changelog.</p> <pre><code>zcat taxonkit/taxid-changelog.csv.gz \\\n    | csvtk grep -f name -P example/changed_species_names.txt\n    | csvtk cut -f taxid,version,change,name,rank \\\n    | csvtk pretty\n\ntaxid   version      change           name                      rank\n-----   ----------   --------------   -----------------------   -------\n1613    2013-02-21   NEW              Lactobacillus fermentum   species\n1613    2016-03-01   ABSORB           Lactobacillus fermentum   species\n1613    2016-03-01   CHANGE_LIN_LEN   Lactobacillus fermentum   species\n29556   2013-02-21   NEW              Mycoplasma gallinaceum    species\n29556   2016-03-01   CHANGE_LIN_LEN   Mycoplasma gallinaceum    species\n29556   2021-01-01   CHANGE_NAME      Mycoplasma gallinaceum    species\n29556   2021-01-01   CHANGE_LIN_LIN   Mycoplasma gallinaceum    species\n</code></pre> <p>We can see the names are changed. Full changes can be queried with the taxid. e.g.,</p> <pre><code>taxid   version      change           change-value   name                        rank\n-----   ----------   --------------   ------------   -------------------------   -------\n29556   2013-02-21   NEW                             Mycoplasma gallinaceum      species\n29556   2016-03-01   CHANGE_LIN_LEN                  Mycoplasma gallinaceum      species\n29556   2020-09-01   CHANGE_NAME                     Mycoplasmopsis gallinacea   species\n29556   2020-09-01   CHANGE_LIN_TAX                  Mycoplasmopsis gallinacea   species\n29556   2021-01-01   CHANGE_NAME                     Mycoplasma gallinaceum      species\n29556   2021-01-01   CHANGE_LIN_LIN                  Mycoplasma gallinaceum      species\n29556   2021-09-01   CHANGE_NAME                     Mycoplasmopsis gallinacea   species\n29556   2021-09-01   CHANGE_LIN_LIN                  Mycoplasmopsis gallinacea   species\n29556   2023-03-01   CHANGE_LIN_LIN                  Mycoplasmopsis gallinacea   species\n</code></pre> <p>Then we just use their TaxIds to rertrieve the new names. The final commands are:</p> <pre><code>zcat taxonkit/taxid-changelog.csv.gz \\\n    | csvtk grep -f name -P example/changed_species_names.txt \\\n    | csvtk uniq -f taxid \\\n    | csvtk cut -f name,taxid \\\n    | csvtk del-header \\\n    | csvtk csv2tab \\\n    | taxonkit lineage -i 2 -n \\\n    | cut -f 1,4\n\nLactobacillus fermentum Limosilactobacillus fermentum\nMycoplasma gallinaceum  Mycoplasmopsis gallinacea\n</code></pre>"},{"location":"tutorial/#add-taxonomy-information-to-blast-result","title":"Add taxonomy information to BLAST result","text":"<p>An blast result file <code>blast_result.txt</code>, where the second column is the accession of matched sequences.</p> <pre><code>head -n 5 blast_result.txt | csvtk pretty -Ht\n\nxxxxxxxxxxxxxxxxxxxxx/2/ccs    XM_013496560.1   78.745    494   99    3    6361    6851    895        1385       6.53e-83    326 \nxxxxxxxxxxxxxxxxxxxxx/2/ccs    XM_013496560.1   78.543    494   100   3    17168   17658   895        1385       3.04e-81    320 \nxxxxxxxxxxxxxxxxxxxxx/76/ccs   LR699760.1       100.000   37    0     0    8139    8175    14507874   14507910   4.27e-06    69.4\nxxxxxxxxxxxxxxxxxxxxx/80/ccs   HG994975.1       80.556    540   81    16   8269    8798    3821290    3820765    8.65e-104   394 \nxxxxxxxxxxxxxxxxxxxxx/80/ccs   HG994975.1       77.805    410   89    2    9590    9998    3819858    3819450    5.51e-61    252\n</code></pre> <p>Prepare <code>acc2taxid.tsv</code> file from nucl_gb.accession2taxid.gz file. Here we use the <code>accession</code> column instead of <code>accession.version</code> column, in case of unmatched versions for some accessions.</p> <pre><code>zcat nucl_gb.accession2taxid.gz | cut -f 1,3 | gzip -c &gt; acc2taxid.tsv.gz\n</code></pre> <p>Extract needed acc2taxid subset to reduce memory usage.</p> <pre><code># extract accession and deduplicate and remove versions\ncut -f 2 blast_result.txt | csvtk uniq -Ht | csvtk replace -Ht -p '\\.\\d+$' &gt; acc.txt\n\n# grep from acc2taxid.tsv.gz\nzcat acc2taxid.tsv.gz | grep -w -f acc.txt &gt;  hit.acc2taxid.tsv\n</code></pre> <p>Prepare <code>taxid2name.tsv</code>, species name are retrived for the taxids.</p> <pre><code>cut -f 2 hit.acc2taxid.tsv | taxonkit reformat -f '{s}' -I 1 &gt; hit.taxid2name.tsv\n</code></pre> <p>Append taxids according to the accessions, and append species names for the taxids.</p> <pre><code>csvtk add-header -t --names \"qseqid,sseqid,pident,length,mismatch,gapopen,qstart,qend,sstart,send,evalue,bitscore\"  blast_result.txt \\\n    | csvtk mutate -t -f sseqid -n taxid \\\n    | csvtk replace -t -k hit.acc2taxid.tsv -f taxid -p '(.+)\\.\\d+' -r '{kv}' \\\n    | csvtk mutate -t -f taxid -n species \\\n    | csvtk replace -t -k hit.taxid2name.tsv -f species -p '(.+)' -r '{kv}' \\\n    | head -n 5 | csvtk pretty -t\n\nqseqid                         sseqid           pident    length   mismatch   gapopen   qstart   qend    sstart     send       evalue      bitscore   taxid   species             \n----------------------------   --------------   -------   ------   --------   -------   ------   -----   --------   --------   ---------   --------   -----   --------------------\nxxxxxxxxxxxxxxxxxxxxx/2/ccs    XM_013496560.1   78.745    494      99         3         6361     6851    895        1385       6.53e-83    326        44415   Eimeria mitis       \nxxxxxxxxxxxxxxxxxxxxx/2/ccs    XM_013496560.1   78.543    494      100        3         17168    17658   895        1385       3.04e-81    320        44415   Eimeria mitis       \nxxxxxxxxxxxxxxxxxxxxx/76/ccs   LR699760.1       100.000   37       0          0         8139     8175    14507874   14507910   4.27e-06    69.4       3702    Arabidopsis thaliana\nxxxxxxxxxxxxxxxxxxxxx/80/ccs   HG994975.1       80.556    540      81         16        8269     8798    3821290    3820765    8.65e-104   394        5802    Eimeria tenella\n</code></pre>"},{"location":"tutorial/#parsing-krakenbracken-result","title":"Parsing kraken/bracken result","text":"<p>Example Data</p> <ul> <li>SRS014459-Stool.fasta.gz</li> </ul> <p>Run Kraken2 and Bracken</p> <pre><code>KRAKEN_DB=/home/shenwei/ws/db/kraken/k2_pluspf\nTHREADS=16\n\nCLASSIFICATION_LVL=S\nTHRESHOLD=10\n\nREAD_LEN=100\nSAMPLE=SRS014459-Stool.fasta.gz\n\nBRACKEN_OUTPUT_FILE=$SAMPLE\n\nkraken2 --db ${KRAKEN_DB} --threads ${THREADS} -report ${SAMPLE}.kreport $SAMPLE &gt; ${SAMPLE}.kraken\n\nest_abundance.py -i ${SAMPLE}.kreport -k ${KRAKEN_DB}/database${READ_LEN}mers.kmer_distrib \\\n    -l ${CLASSIFICATION_LVL} -t ${THRESHOLD} -o ${BRACKEN_OUTPUT_FILE}.bracken\n</code></pre> <p>Orignial format</p> <pre><code>$ head -n 15 SRS014459-Stool.fasta.gz_bracken_species.kreport\n100.00  9491    0       R       1       root\n99.85   9477    0       R1      131567    cellular organisms\n99.85   9477    0       D       2           Bacteria\n66.08   6271    0       D1      1783270       FCB group\n66.08   6271    0       D2      68336           Bacteroidetes/Chlorobi group\n66.08   6271    0       P       976               Bacteroidetes\n66.08   6271    0       C       200643              Bacteroidia\n66.08   6271    0       O       171549                Bacteroidales\n34.45   3270    0       F       815                     Bacteroidaceae\n34.45   3270    0       G       816                       Bacteroides\n10.43   990     990     S       246787                      Bacteroides cellulosilyticus\n7.98    757     757     S       28116                       Bacteroides ovatus\n3.10    293     0       G1      2646097                     unclassified Bacteroides\n1.06    100     100     S       2755405                       Bacteroides sp. CACC 737\n0.49    46      46      S       2650157                       Bacteroides sp. HF-5287\n</code></pre> <p>Converting to MetaPhlAn2 format. (Similar to kreport2mpa.py)</p> <pre><code>$ cat SRS014459-Stool.fasta.gz_bracken_species.kreport \\\n    | csvtk cut -Ht -f 5,1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -i 3 -P -f \"{k}|{p}|{c}|{o}|{f}|{g}|{s}\" \\\n    | csvtk cut -Ht -f 4,2 \\\n    | csvtk replace -Ht -p \"(\\|[kpcofgs]__)+$\" \\\n    | csvtk replace -Ht -p \"\\|[kpcofgs]__\\|\" -r \"|\" \\\n    | csvtk uniq -Ht \\\n    | csvtk grep -Ht -p k__ -v \\\n    &gt; SRS014459-Stool.fasta.gz_bracken_species.kreport.format\n\n$ head -n 10 SRS014459-Stool.fasta.gz_bracken_species.kreport.format\n\nk__Bacteria     99.85\nk__Bacteria|p__Bacteroidetes    66.08\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia     66.08\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales    66.08\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae  34.45\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides   34.45\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides cellulosilyticus   10.43\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides ovatus     7.98\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides sp. CACC 737       1.06\nk__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides sp. HF-5287        0.49\n</code></pre> <p>Converting to Qiime format</p> <pre><code>$ cat SRS014459-Stool.fasta.gz_bracken_species.kreport \\\n    | csvtk cut -Ht -f 5,1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -i 3 -P -f \"{k}; {p}; {c}; {o}; {f}; {g}; {s}\" \\\n    | csvtk cut -Ht -f 4,2 \\\n    | csvtk replace -Ht -p \"(; [kpcofgs]__)+$\" \\\n    | csvtk replace -Ht -p \"; [kpcofgs]__; \" -r \"; \" \\\n    | csvtk uniq -Ht \\\n    | csvtk grep -Ht -p k__ -v \\\n    | head -n 10\n\nk__Bacteria     99.85\nk__Bacteria; p__Bacteroidetes   66.08\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia   66.08\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales 66.08\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae      34.45\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae; g__Bacteroides      34.45\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae; g__Bacteroides; s__Bacteroides cellulosilyticus     10.43\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae; g__Bacteroides; s__Bacteroides ovatus       7.98\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae; g__Bacteroides; s__Bacteroides sp. CACC 737 1.06\nk__Bacteria; p__Bacteroidetes; c__Bacteroidia; o__Bacteroidales; f__Bacteroidaceae; g__Bacteroides; s__Bacteroides sp. HF-5287  0.49\n</code></pre> <p>Save taxon proportion and taxid, and get lineage, name and rank.</p> <pre><code>$ cat SRS014459-Stool.fasta.gz_bracken_species.kreport \\\n    | csvtk cut -Ht -f 1,5 \\\n    | taxonkit lineage -i 2 -n -r \\\n    | csvtk cut -Ht -f 1,2,5,4,3 \\\n    | head -n 10 \\\n    | csvtk pretty -Ht\n\n100.00   1         no rank        root                           root\n99.85    131567    no rank        cellular organisms             cellular organisms\n99.85    2         superkingdom   Bacteria                       cellular organisms;Bacteria\n66.08    1783270   clade          FCB group                      cellular organisms;Bacteria;FCB group\n66.08    68336     clade          Bacteroidetes/Chlorobi group   cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group\n66.08    976       phylum         Bacteroidetes                  cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group;Bacteroidetes\n66.08    200643    class          Bacteroidia                    cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group;Bacteroidetes;Bacteroidia\n66.08    171549    order          Bacteroidales                  cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group;Bacteroidetes;Bacteroidia;Bacteroidales\n34.45    815       family         Bacteroidaceae                 cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae\n34.45    816       genus          Bacteroides                    cellular organisms;Bacteria;FCB group;Bacteroidetes/Chlorobi group;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides\n</code></pre> <p>Only save species or lower level and get lineage in format of \"superkingdom phylum class order family genus species\".</p> <pre><code>$ cat SRS014459-Stool.fasta.gz_bracken_species.kreport \\\n    | csvtk cut -Ht -f 1,5 \\\n    | taxonkit filter -N -E species -L species -i 2 \\\n    | taxonkit lineage -i 2 -n -r \\\n    | taxonkit reformat -i 3 -f \"{k};{p};{c};{o};{f};{g};{s}\" \\\n    | csvtk cut -Ht -f 1,2,5,4,6 \\\n    | csvtk add-header -t -n abundance,taxid,rank,name,lineage \\\n    | head -n 10 \\\n    | csvtk pretty -t\n\nabundance   taxid     rank      name                           lineage\n---------   -------   -------   ----------------------------   --------------------------------------------------------------------------------------------------------\n10.43       246787    species   Bacteroides cellulosilyticus   Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides cellulosilyticus\n7.98        28116     species   Bacteroides ovatus             Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides ovatus\n1.06        2755405   species   Bacteroides sp. CACC 737       Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. CACC 737\n0.49        2650157   species   Bacteroides sp. HF-5287        Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. HF-5287\n0.99        2528203   species   Bacteroides sp. A1C1           Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. A1C1\n0.28        2763022   species   Bacteroides sp. M10            Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. M10\n0.16        2650158   species   Bacteroides sp. HF-5141        Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. HF-5141\n0.12        2715212   species   Bacteroides sp. CBA7301        Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides sp. CBA7301\n5.10        817       species   Bacteroides fragilis           Bacteria;Bacteroidetes;Bacteroidia;Bacteroidales;Bacteroidaceae;Bacteroides;Bacteroides fragilis\n</code></pre>"},{"location":"tutorial/#making-nr-blastdb-for-specific-taxids","title":"Making nr blastdb for specific taxids","text":"<p>Attention:</p> <ul> <li> <p>(2023-11-27) BLAST+ 2.2.15 supports limiting a group of organisms without first using a custom script to get all species-level Taxonomy IDs (taxids) for the group. Details.</p> <p>E.g., Search of the nr BLAST database limited to Bacteria (taxID 2).</p> <pre><code>blastp -db nr -taxids 2 -query ...\n</code></pre> </li> <li> <p>(2019) BLAST+ 2.8.1 is released with new databases, which allows you to limit your search by taxonomy using information built into the BLAST databases. So you don't need to build blastdb for specific taxids now.</p> </li> </ul> <p>Changes:</p> <ul> <li>2018-09-13 rewritten</li> <li>2018-12-22 providing faster method for step 3.1</li> <li>2019-01-07 add note of new blastdb version</li> <li>2020-10-14 update steps for huge number of accessions belong to high taxon level like bacteria.</li> </ul> <p>Data:</p> <ul> <li>pre-formated blastdb (09/10/2018)</li> <li>prot.accession2taxid.gz (09/07/2018) (optional, but recommended)</li> </ul> <p>Hardware in this tutorial</p> <ul> <li>CPU: AMD 8-cores/16-threads 3.7Ghz</li> <li>RAM: 64GB</li> <li>DISK:<ul> <li>Taxonomy files stores in NVMe SSD</li> <li>blastdb files stores in 7200rpm HDD</li> </ul> </li> </ul> <p>Tools:</p> <ul> <li>blast+</li> <li>pigz (recommended, faster than gzip)</li> <li>taxonkit</li> <li>seqkit (recommended),  version &gt;= 0.14.0</li> <li>rush (optional, for parallizing filtering sequence)</li> </ul> <p>Steps:</p> <ol> <li> <p>Listing all taxids below <code>$id</code> using taxonkit.</p> <pre><code>id=6656\n\n# 6656 is the phylum Arthropoda\n# echo 6656 | taxonkit lineage | taxonkit reformat\n# 6656    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Protostomia;Ecdysozoa;Panarthropoda;Arthropoda    Eukaryota;Arthropoda;;;;;\n\n# 2     bacteria\n# 2157  archaea\n# 4751  fungi\n# 10239 virus\n\n# time: 2s\ntaxonkit list --ids $id --indent \"\" &gt; $id.taxid.txt\n\n# taxonkit list --ids 2,4751,10239 --indent \"\" &gt; microbe.taxid.txt\n\nwc -l $id.taxid.txt\n# 518373 6656.taxid.txt\n</code></pre> </li> <li> <p>Retrieving target accessions. There are two options:</p> <ol> <li> <p>From prot.accession2taxid.gz (faster, recommended). Note that some accessions are not in <code>nr</code>.</p> <pre><code># time: 4min\npigz -dc prot.accession2taxid.gz \\\n    | csvtk grep -t -f taxid -P $id.taxid.txt \\\n    | csvtk cut -t -f accession.version,taxid \\\n    | sed 1d \\\n    &gt; $id.acc2taxid.txt\n\ncut -f 1 $id.acc2taxid.txt &gt; $id.acc.txt\n\nwc -l $id.acc.txt\n# 8174609 6656.acc.txt\n</code></pre> </li> <li> <p>From pre-formated <code>nr</code> blastdb</p> <pre><code># time: 40min\nblastdbcmd -db nr -entry all -outfmt \"%a %T\" | pigz -c &gt; nr.acc2taxid.txt.gz\n\npigz -dc nr.acc2taxid.txt.gz | wc -l\n# 555220892\n\n# time: 3min\npigz -dc nr.acc2taxid.txt.gz \\\n    | csvtk grep -d ' ' -D ' ' -f 2 -P $id.taxid.txt \\\n    | cut -d ' '  -f 1 \\\n    &gt; $id.acc.txt\n\nwc -l $id.acc.txt\n# 6928021 6656.acc.txt\n</code></pre> </li> </ol> </li> <li> <p>Retrieving FASTA sequences from pre-formated blastdb. There are two options:</p> <ol> <li> <p>From <code>nr.fa</code> exported from pre-formated blastdb (faster, smaller output file, recommended).    DO NOT directly download <code>nr.gz</code> from ncbi ftp,    in which the FASTA headers are not well formated.</p> <pre><code># 1. exporting nr.fa from pre-formated blastdb\n\n# time: 117min (run only once)\nblastdbcmd -db nr -dbtype prot -entry all -outfmt \"%f\" -out - | pigz -c &gt; nr.fa.gz\n\n# =====================================================================\n\n# 2. filtering sequence belong to $taxid\n\n# ---------------------------------------------------------------------\n\n# methond 1) (for cases where $id.acc.txt is not very huge)\n# time: 80min\n# perl one-liner is used to unfold records having mulitple accessions\ntime cat &lt;(echo) &lt;(pigz -dc nr.fa.gz) \\\n    | perl -e 'BEGIN{ $/ = \"\\n&gt;\"; &lt;&gt;; } while(&lt;&gt;){s/&gt;$//;  $i = index $_, \"\\n\"; $h = substr $_, 0, $i; $s = substr $_, $i+1; if ($h !~ /&gt;/) { print \"&gt;$_\"; next; }; $h = \"&gt;$h\"; while($h =~ /&gt;([^ ]+ .+?) ?(?=&gt;|$)/g){ $h1 = $1; $h1 =~ s/^\\W+//; print \"&gt;$h1\\n$s\";} } ' \\\n    | seqkit grep -f $id.acc.txt -o nr.$id.fa.gz\n\n# ---------------------------------------------------------------------\n\n# method 2) (**faster**)\n\n# 33min (run only once)\n# (1). split nr.fa.gz. # Note: I have 16 cpus.\n$ time seqkit split2 -p 15 nr.fa.gz\n\n# (2). parallize unfolding\n$ cat _unfold_blastdb_fa.sh\n#!/bin/sh\nperl -e 'BEGIN{ $/ = \"\\n&gt;\"; &lt;&gt;; } while(&lt;&gt;){s/&gt;$//;  $i = index $_, \"\\n\"; $h = substr $_, 0, $i; $s = substr $_, $i+1; if ($h !~ /&gt;/) { print \"&gt;$_\"; next; }; $h = \"&gt;$h\"; while($h =~ /&gt;([^ ]+ .+?) ?(?=&gt;|$)/g){ $h1 = $1; $h1 =~ s/^\\W+//; print \"&gt;$h1\\n$s\";} } '\n\n# 10 min\ntime ls nr.fa.gz.split/nr.part_*.fa.gz \\\n    | rush -j 15 -v id=$id 'cat &lt;(echo) &lt;(pigz -dc {}) \\\n        | ./_unfold_blastdb_fa.sh \\\n        | seqkit grep -f {id}.acc.txt -o nr.{id}.{%@nr\\.(.+)$} '\n\n# (3). merge result\ncat nr.$id.part*.fa.gz &gt; nr.$id.fa.gz\nrm nr.$id.part*.fa.gz\n\n# ---------------------------------------------------------------------\n\n# method 3) (for huge $id.acc.txt file, e.g., bacteria)\n\n# (1). split ${id}.acc.txt into several parts. chunk size depends on lines and RAM (64G for me).\nsplit -d -l 300000000 $id.acc.txt $id.acc.txt.part_\n\n# (2). filter\ntime ls $id.acc.txt.part_* \\\n    | rush -j 1 --immediate-output -v id=$id \\\n        'echo {}; cat &lt;(echo) &lt;(pigz -dc nr.fa.gz ) \\\n        | ./_unfold_blastdb_fa.sh \\\n        | seqkit grep -f {} -o nr.{id}.{%@(part_.+)}.fa.gz '\n\n# (3). merge\ncat nr.$id.part*.fa.gz &gt; nr.$id.fa.gz\n\n# clean\nrm nr.$id.part*.fa.gz\nrm $id.acc.txt.part_\n\n# (4). optionally adding taxid, you may edit replacement (-r) below\n# split\ntime split -d -l 200000000 $id.acc2taxid.txt $id.acc2taxid.txt.part_\n\nln -s nr.$id.fa.gz nr.$id.with-taxid.part0.fa.gz         \ni=0\nfor f in $id.acc2taxid.txt.part_* ; do\n    echo $f\n    time pigz -cd nr.$id.with-taxid.part$i.fa.gz \\\n        | seqkit replace -k $f -p \"^([^\\-]+?) \" -r \"{kv}-\\$1 \" -K -U -o nr.$id.with-taxid.part$(($i+1)).fa.gz;\n    /bin/rm nr.$id.with-taxid.part$i.fa.gz\n    i=$(($i+1));\ndone\nmv nr.$id.with-taxid.part$i.fa.gz nr.$id.with-taxid.fa.gz\n\n# =====================================================================\n\n# 3. counting sequences\n#\n# ls -lh nr.$id.fa.gz\n# -rw-r--r-- 1 shenwei shenwei 902M 9\u6708  13 01:42 nr.6656.fa.gz\n#\npigz -dc nr.$id.fa.gz | grep '^&gt;' -c\n\n# 6928017\n# Here 6928017 ~=  6928021 ($id.acc.txt)\n</code></pre> </li> <li> <p>Directly from pre-formated blastdb</p> <pre><code># time: 5h20min\nblastdbcmd -db nr -entry_batch $id.acc.txt -out - | pigz -c &gt; nr.$id.fa.gz\n\n# counting sequences\n#\n# Note that the headers of outputed fasta by blastdbcmd are \"folded\"\n# for accessions from different species with same sequences, so the\n# number may be small than $(wc -l $id.acc.txt).\npigz -dc nr.$id.fa.gz | grep '^&gt;' -c\n# 1577383\n\n# counting accessions\n#\n# ls -lh nr.$id.fa.gz\n# -rw-r--r-- 1 shenwei shenwei 2.1G 9\u6708  13 03:38 nr.6656.fa.gz\n#\npigz -dc nr.$id.fa.gz | grep '^&gt;' | sed 's/&gt;/\\n&gt;/g' | grep '^&gt;' -c\n# 288415413\n</code></pre> </li> </ol> </li> <li> <p>makeblastdb</p> <pre><code>pigz -dc nr.$id.fa.gz &gt; nr.$id.fa\n\n# time: 3min ($nr.$id.fa from step 3 option 1)\n#\n# building $nr.$id.fa from step 3 option 2 with -parse_seqids would produce error:\n#\n#     BLAST Database creation error: Error: Duplicate seq_ids are found: SP|P29868.1\n#\nmakeblastdb -parse_seqids -in nr.$id.fa -dbtype prot -out nr.$id\n\n# rm nr.$id.fa\n</code></pre> </li> <li> <p>blastp (optional)</p> <pre><code># blastdb nr.$id is built from sequences in step 3 option 1\n#\nblastp -num_threads 16 -db nr.$id -query t4.fa &gt; t4.fa.blast\n# real    0m20.866s\n\n# $ cat t4.fa.blast | grep Query= -A 10\n# Query= A0A0J9X1W9.2 RecName: Full=Mu-theraphotoxin-Hd1a; Short=Mu-TRTX-Hd1a\n#\n# Length=35\n                                                                     Score     E\n# Sequences producing significant alignments:                          (Bits)  Value\n\n# 2MPQ_A  Chain A, Solution structure of the sodium channel toxin Hd1a  72.4    2e-17\n# A0A0J9X1W9.2  RecName: Full=Mu-theraphotoxin-Hd1a; Short=Mu-TRTX-...  72.4    2e-17\n# ADB56726.1  HNTX-IV.2 precursor [Haplopelma hainanum]                 66.6    9e-15\n# D2Y233.1  RecName: Full=Mu-theraphotoxin-Hhn1b 2; Short=Mu-TRTX-H...  66.6    9e-15\n# ADB56830.1  HNTX-IV.3 precursor [Haplopelma hainanum]                 66.6    9e-15\n</code></pre> </li> </ol>"},{"location":"tutorial/#summaries-of-taxonomy-data","title":"Summaries of taxonomy data","text":"<p>You can change the TaxId of interest.</p> <ol> <li> <p>Rank counts of common categories.</p> <pre><code>$ echo Archaea Bacteria Eukaryota Fungi Metazoa Viridiplantae \\\n    | rush -D ' ' -T b \\\n        'taxonkit list --ids $(echo {} | taxonkit name2taxid | cut -f 2) \\\n            | sed 1d \\\n            | taxonkit filter -i 2 -E genus -L genus \\\n            | taxonkit lineage -L -r \\\n            | csvtk freq -H -t -f 2 -nr \\\n            &gt; stats.{}.tsv '\n\n$ csvtk -t join --outer-join stats.*.tsv \\\n    | csvtk add-header -t -n \"rank,$(ls stats.*.tsv | rush -k 'echo {@stats.(.+).tsv}' | paste -sd, )\" \\\n    | csvtk csv2md -t\n</code></pre> <p>Similar data on NCBI Taxonomy</p> rank Archaea Bacteria Eukaryota Fungi Metazoa Viridiplantae species 12482 460940 1349648 156908 957297 191026 strain 354 40643 3486 2352 33 50 genus 205 4112 90882 6844 64148 16202 isolate 7 503 809 76 17 3 species group 2 77 251 22 214 5 serotype 218 serogroup 136 subsection 21 21 subspecies 632 24523 158 17043 7212 forma specialis 521 220 179 33 1 species subgroup 23 101 101 biotype 7 10 morph 12 3 4 5 section 437 37 2 398 genotype 12 12 series 9 5 4 varietas 25 8499 1100 2 7188 forma 4 560 185 6 315 subgenus 1 1558 10 1414 112 pathogroup 5 subvariety 5 5 </li> <li> <p>Count of all ranks</p> <pre><code>$ time taxonkit list --ids 1 \\\n    | taxonkit lineage -L -r \\\n    | csvtk freq -H -t -f 2 -nr \\\n    | csvtk pretty -H -t\n\nspecies            1879659\nno rank            222743\ngenus              96625\nstrain             44483\nsubspecies         25174\nfamily             9492\nvarietas           8524\nsubfamily          3050\ntribe              2213\norder              1660\nsubgenus           1618\nisolate            1319\nserotype           1216\nclade              886\nsuperfamily        865\nforma specialis    741\nforma              564\nsubtribe           508\nsection            437\nclass              429\nsuborder           372\nspecies group      330\nphylum             272\nsubclass           156\nserogroup          138\ninfraorder         130\nspecies subgroup   124\nsuperorder         55\nsubphylum          33\nparvorder          26\nsubsection         21\ngenotype           20\ninfraclass         18\nbiotype            17\nmorph              12\nkingdom            11\nseries             9\nsuperclass         6\ncohort             5\npathogroup         5\nsubvariety         5\nsuperkingdom       4\nsubcohort          3\nsubkingdom         1\nsuperphylum        1\n\nreal    0m3.663s\nuser    0m15.897s\nsys     0m1.010s\n</code></pre> </li> <li> <p>Ranks of taxa at or below species.</p> <pre><code>$ taxonkit list --ids 1 \\\n    | taxonkit filter --lower-than species --equal-to species \\\n    | taxonkit lineage -L -r  \\\n    | csvtk freq -Ht -nr -f 2 \\\n    | csvtk add-header -t -n rank,count \\\n    | csvtk pretty -t\n\nrank              count\n---------------   -------\nspecies           1880044\nno rank           222756\nstrain            44483\nsubspecies        25171\nvarietas          8524\nisolate           1319\nserotype          1216\nclade             885\nforma specialis   741\nforma             564\nserogroup         138\ngenotype          20\nbiotype           17\nmorph             12\npathogroup        5\nsubvariety        5\n</code></pre> </li> </ol>"},{"location":"tutorial/#merging-gtdb-and-ncbi-taxonomy","title":"Merging GTDB and NCBI taxonomy","text":"<p>Sometimes (1) one needs to build a database including bacteria and archaea (from GTDB) and viral database from NCBI. The idea is to export lineages from both GTDB and NCBI using taxonkit reformat, and then create taxdump files from them with taxonkit create-taxdump.</p> <ol> <li> <p>Exporting taxonomic lineages of taxa with rank equal to species from GTDB-taxdump.</p> <pre><code>taxonkit list --data-dir gtdb-taxdump/R207/ --ids 1 --indent \"\" \\\n    | taxonkit filter --data-dir gtdb-taxdump/R207/ --equal-to species \\\n    | taxonkit reformat --data-dir gtdb-taxdump/R207/ --taxid-field 1 \\\n        --format \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\" \\\n        -o gtdb.tsv\n</code></pre> </li> <li> <p>Exporting taxonomic lineages of viral taxa with rank equal to or lower than species from NCBI taxdump.    For taxa whose rank is \"no rank\" below the species, we treat them as tax of strain rank (<code>--pseudo-strain</code>, taxonkit v0.14.1 needed).</p> <pre><code># taxid of Viruses: 10239\ntaxonkit list --data-dir ~/.taxonkit --ids 10239 --indent \"\" \\\n    | taxonkit filter --data-dir ~/.taxonkit --equal-to species --lower-than species \\\n    | taxonkit reformat --data-dir ~/.taxonkit --taxid-field 1 \\\n        --pseudo-strain --format \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n        -o ncbi-viral.tsv\n</code></pre> </li> <li> <p>Creating taxdump from lineages above.</p> <pre><code>(awk '{print $_\"\\t\"}' gtdb.tsv; cat ncbi-viral.tsv) \\\n    | taxonkit create-taxdump \\\n        --field-accession 1 \\\n        -R \"superkingdom,phylum,class,order,family,genus,species,strain\" \\\n        -O taxdump\n\n# we use --field-accession  1 to output the mapping file between old taxids and new ones.\n$ grep 2697049  taxdump/taxid.map  # SARS-COV-2\n2697049 21630522\n</code></pre> </li> </ol> <p>Some tests:</p> <pre><code># SARS-COV-2 in NCBI taxonomy\n$ echo 2697049 \\\n    | taxonkit lineage -t --data-dir ~/.taxonkit \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L --data-dir ~/.taxonkit \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -Ht\n10239     superkingdom   Viruses\n2559587   clade          Riboviria\n2732396   kingdom        Orthornavirae\n2732408   phylum         Pisuviricota\n2732506   class          Pisoniviricetes\n76804     order          Nidovirales\n2499399   suborder       Cornidovirineae\n11118     family         Coronaviridae\n2501931   subfamily      Orthocoronavirinae\n694002    genus          Betacoronavirus\n2509511   subgenus       Sarbecovirus\n694009    species        Severe acute respiratory syndrome-related coronavirus\n2697049   no rank        Severe acute respiratory syndrome coronavirus 2\n\n$ echo \"Severe acute respiratory syndrome coronavirus 2\" | taxonkit name2taxid --data-dir taxdump/\nSevere acute respiratory syndrome coronavirus 2 216305222\n\n$ echo 216305222 \\\n    | taxonkit lineage -t --data-dir taxdump/ \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L --data-dir taxdump/ \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -Ht\n1287770734   superkingdom   Viruses\n1506901452   phylum         Pisuviricota\n1091693597   class          Pisoniviricetes\n37745009     order          Nidovirales\n738421640    family         Coronaviridae\n906833049    genus          Betacoronavirus\n1015862491   species        Severe acute respiratory syndrome-related coronavirus\n216305222    strain         Severe acute respiratory syndrome coronavirus 2\n\n\n\n$ echo \"Escherichia coli\"  | taxonkit name2taxid --data-dir taxdump/\nEscherichia coli        1945799576\n\n$ echo 1945799576 \\\n    | taxonkit lineage -t --data-dir taxdump/ \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L --data-dir taxdump/ \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -Ht\n609216830    superkingdom   Bacteria\n1641076285   phylum         Proteobacteria\n329474883    class          Gammaproteobacteria\n1012954932   order          Enterobacterales\n87250111     family         Enterobacteriaceae\n1187493883   genus          Escherichia\n1945799576   species        Escherichia coli\n</code></pre> Please enable JavaScript to view the comments powered by Disqus."},{"location":"usage/","title":"Usage and Examples","text":"<p>Table of Contents</p> <ul> <li>Usage and Examples</li> <li>Before use</li> <li>taxonkit</li> <li>list</li> <li>lineage</li> <li>reformat</li> <li>name2taxid</li> <li>filter</li> <li>lca</li> <li>taxid-changelog</li> <li>profile2cami</li> <li>cami-filter</li> <li>create-taxdump</li> <li>genautocomplete</li> </ul>"},{"location":"usage/#before-use","title":"Before use","text":"<ol> <li>Download and uncompress <code>taxdump.tar.gz</code>: ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz </li> <li>Copy <code>names.dmp</code>, <code>nodes.dmp</code>, <code>delnodes.dmp</code> and <code>merged.dmp</code> to data directory: <code>$HOME/.taxonkit</code>, e.g., <code>/home/shenwei/.taxonkit</code> ,</li> <li>Optionally copy to some other directories, and later you can refer to using flag <code>--data-dir</code>, or environment variable <code>TAXONKIT_DB</code>.</li> </ol> <p>All-in-one command:</p> <pre><code>wget -c ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz \ntar -zxvf taxdump.tar.gz\n\nmkdir -p $HOME/.taxonkit\ncp names.dmp nodes.dmp delnodes.dmp merged.dmp $HOME/.taxonkit\n</code></pre> <p>Update dataset: Simply re-download the taxdump files, uncompress and override old ones.</p>"},{"location":"usage/#taxonkit","title":"taxonkit","text":"<pre><code>TaxonKit - A Practical and Efficient NCBI Taxonomy Toolkit\n\nVersion: 0.15.1\n\nAuthor: Wei Shen &lt;shenwei356@gmail.com&gt;\n\nSource code: https://github.com/shenwei356/taxonkit\nDocuments  : https://bioinf.shenwei.me/taxonkit\nCitation   : https://www.sciencedirect.com/science/article/pii/S1673852721000837\n\nDataset:\n\n    Please download and uncompress \"taxdump.tar.gz\":\n    ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz\n\n    and copy \"names.dmp\", \"nodes.dmp\", \"delnodes.dmp\" and \"merged.dmp\" to data directory:\n    \"/home/shenwei/.taxonkit\"\n\n    or some other directory, and later you can refer to using flag --data-dir,\n    or environment variable TAXONKIT_DB.\n\n    When environment variable TAXONKIT_DB is set, explicitly setting --data-dir will\n    overide the value of TAXONKIT_DB.\n\nUsage:\n  taxonkit [command]\n\nAvailable Commands:\n  cami-filter     Remove taxa of given TaxIds and their descendants in CAMI metagenomic profile\n  create-taxdump  Create NCBI-style taxdump files for custom taxonomy, e.g., GTDB and ICTV\n  filter          Filter TaxIds by taxonomic rank range\n  genautocomplete generate shell autocompletion script (bash|zsh|fish|powershell)\n  lca             Compute lowest common ancestor (LCA) for TaxIds\n  lineage         Query taxonomic lineage of given TaxIds\n  list            List taxonomic subtrees of given TaxIds\n  name2taxid      Convert taxon names to TaxIds\n  profile2cami    Convert metagenomic profile table to CAMI format\n  reformat        Reformat lineage in canonical ranks\n  taxid-changelog Create TaxId changelog from dump archives\n  version         print version information and check for update\n\nFlags:\n      --data-dir string   directory containing nodes.dmp and names.dmp (default \"/home/shenwei/.taxonkit\")\n  -h, --help              help for taxonkit\n      --line-buffered     use line buffering on output, i.e., immediately writing to stdin/file for\n                          every line of output\n  -o, --out-file string   out file (\"-\" for stdout, suffix .gz for gzipped out) (default \"-\")\n  -j, --threads int       number of CPUs. 4 is enough (default 4)\n      --verbose           print verbose information\n\nUse \"taxonkit [command] --help\" for more information about a command.\n</code></pre>"},{"location":"usage/#list","title":"list","text":"<p>Usage</p> <pre><code>List taxonomic subtrees of given TaxIds\n\nAttentions:\n  1. When multiple taxids are given, the output may contain duplicated records\n     if some taxids are descendants of others.\n\nExamples:\n\n    $ taxonkit list --ids 9606 -n -r --indent \"    \"\n    9606 [species] Homo sapiens\n        63221 [subspecies] Homo sapiens neanderthalensis\n        741158 [subspecies] Homo sapiens subsp. 'Denisova'\n\n    $ taxonkit list --ids 9606 --indent \"\"\n    9606\n    63221\n    741158\n\nUsage:\n  taxonkit list [flags]\n\nFlags:\n  -h, --help            help for list\n  -i, --ids string      TaxId(s), multiple values should be separated by comma\n  -I, --indent string   indent (default \"  \")\n  -J, --json            output in JSON format. you can save the result in file with suffix \".json\" and\n                        open with modern text editor\n  -n, --show-name       output scientific name\n  -r, --show-rank       output rank\n</code></pre> <p>Examples</p> <ol> <li> <p>Default usage.</p> <pre><code>$ taxonkit list --ids 9605,239934\n9605\n9606\n    63221\n    741158\n1425170\n2665952\n    2665953\n\n239934\n239935\n    349741\n512293\n    512294\n    1131822\n    1262691\n    1263034\n1679444\n2608915\n    1131336\n...\n</code></pre> </li> <li> <p>Removing indent. The list could be used to extract sequences from BLAST database with <code>blastdbcmd</code> (see tutorial)</p> <pre><code>$ taxonkit list --ids 9605,239934 --indent \"\"\n9605\n9606\n63221\n741158\n1425170\n2665952\n2665953\n\n239934\n239935\n349741\n512293\n512294\n1131822\n1262691\n1263034\n1679444\n...\n</code></pre> <p>Performance: Time and memory usage for whole taxon tree:</p> <pre><code>$ # emptying the buffers cache\n$ su -c \"free &amp;&amp; sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches &amp;&amp; free\"\n\n$ memusg -t taxonkit list --ids 1 --indent \"\" --verbose &gt; t0.txt\n21:05:01.782 [INFO] parsing merged file: /home/shenwei/.taxonkit/names.dmp\n21:05:01.782 [INFO] parsing names file: /home/shenwei/.taxonkit/names.dmp\n21:05:01.782 [INFO] parsing delnodes file: /home/shenwei/.taxonkit/names.dmp\n21:05:01.816 [INFO] 61023 merged nodes parsed\n21:05:01.889 [INFO] 437929 delnodes parsed\n21:05:03.178 [INFO] 2303979 names parsed\n\nelapsed time: 3.290s\npeak rss: 742.77 MB\n</code></pre> </li> <li> <p>Adding names</p> <pre><code>$ taxonkit list --show-rank --show-name --indent \"    \" --ids 9605,239934\n9605 [genus] Homo\n    9606 [species] Homo sapiens\n        63221 [subspecies] Homo sapiens neanderthalensis\n        741158 [subspecies] Homo sapiens subsp. 'Denisova'\n    1425170 [species] Homo heidelbergensis\n    2665952 [no rank] environmental samples\n        2665953 [species] Homo sapiens environmental sample\n\n239934 [genus] Akkermansia\n    239935 [species] Akkermansia muciniphila\n        349741 [strain] Akkermansia muciniphila ATCC BAA-835\n    512293 [no rank] environmental samples\n        512294 [species] uncultured Akkermansia sp.\n        1131822 [species] uncultured Akkermansia sp. SMG25\n        1262691 [species] Akkermansia sp. CAG:344\n        1263034 [species] Akkermansia muciniphila CAG:154\n    1679444 [species] Akkermansia glycaniphila\n    2608915 [no rank] unclassified Akkermansia\n        1131336 [species] Akkermansia sp. KLE1605\n        1574264 [species] Akkermansia sp. KLE1797\n...\n</code></pre> <p>Performance: Time and memory usage for whole taxonomy tree:</p> <pre><code>$ # emptying the buffers cache\n$ su -c \"free &amp;&amp; sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches &amp;&amp; free\"\n\n$ memusg -t taxonkit list --show-rank --show-name --ids 1 &gt; t1.txt\nelapsed time: 5.341s\npeak rss: 1.04 GB\n</code></pre> </li> <li> <p>Output in JSON format, you can easily collapse and uncollapse taxonomy tree in modern text editor.</p> <pre><code>$ taxonkit list --show-rank --show-name --indent \"    \" --ids 9605,239934 --json\n{\n    \"9605 [genus] Homo\": {\n        \"9606 [species] Homo sapiens\": {\n            \"63221 [subspecies] Homo sapiens neanderthalensis\": {\n            },\n            \"741158 [subspecies] Homo sapiens subsp. 'Denisova'\": {\n            }\n        },\n        \"1425170 [species] Homo heidelbergensis\": {\n        }\n    },\n    \"239934 [genus] Akkermansia\": {\n        \"239935 [species] Akkermansia muciniphila\": {\n            \"349741 [no rank] Akkermansia muciniphila ATCC BAA-835\": {\n            }\n        },\n        \"512293 [no rank] environmental samples\": {\n            \"512294 [species] uncultured Akkermansia sp.\": {\n            },\n            \"1131822 [species] uncultured Akkermansia sp. SMG25\": {\n            },\n            \"1262691 [species] Akkermansia sp. CAG:344\": {\n            },\n            \"1263034 [species] Akkermansia muciniphila CAG:154\": {\n            }\n        },\n        \"1679444 [species] Akkermansia glycaniphila\": {\n        },\n        \"2608915 [no rank] unclassified Akkermansia\": {\n            \"1131336 [species] Akkermansia sp. KLE1605\": {\n            },\n            \"1574264 [species] Akkermansia sp. KLE1797\": {\n            },\n            \"1574265 [species] Akkermansia sp. KLE1798\": {\n            },\n            \"1638783 [species] Akkermansia sp. UNK.MGS-1\": {\n            },\n            \"1755639 [species] Akkermansia sp. MC_55\": {\n            }\n        }\n    }\n}\n</code></pre> <p>Snapshot of taxonomy (taxid 1) in kate: </p> </li> </ol>"},{"location":"usage/#lineage","title":"lineage","text":"<p>Usage</p> <pre><code>Query taxonomic lineage of given TaxIds\n\nInput:\n\n  - List of TaxIds, one TaxId per line.\n  - Or tab-delimited format, please specify TaxId field \n    with flag -i/--taxid-field (default 1).\n  - Supporting (gzipped) file or STDIN.\n\nOutput:\n\n  1. Input line data.\n  2. (Optional) Status code (-c/--show-status-code), values:\n     - \"-1\" for queries not found in whole database.\n     - \"0\" for deleted TaxIds, provided by \"delnodes.dmp\".\n     - New TaxIds for merged TaxIds, provided by \"merged.dmp\".\n     - Taxids for these found in \"nodes.dmp\".\n  3. Lineage, delimiter can be changed with flag -d/--delimiter.\n  4. (Optional) TaxIds taxons in the lineage (-t/--show-lineage-taxids)\n  5. (Optional) Name (-n/--show-name)\n  6. (Optional) Rank (-r/--show-rank)\n\nFilter out invalid and deleted taxids, and replace merged \ntaxids with new ones:\n\n    # input is one-column-taxid\n    $ taxonkit lineage -c taxids.txt \\\n        | awk '$2&gt;0' \\\n        | cut -f 2-\n\n    # taxids are in 3rd field in a 4-columns tab-delimited file,\n    # for $5, where 5 = 4 + 1.\n    $ cat input.txt \\\n        | taxonkit lineage -c -i 3 \\\n        | csvtk filter2 -H -t -f '$5&gt;0' \\\n        | csvtk -H -t cut -f -3\n\nUsage:\n  taxonkit lineage [flags]\n\nFlags:\n  -d, --delimiter string      field delimiter in lineage (default \";\")\n  -h, --help                  help for lineage\n  -L, --no-lineage            do not show lineage, when user just want names or/and ranks\n  -R, --show-lineage-ranks    appending ranks of all levels\n  -t, --show-lineage-taxids   appending lineage consisting of taxids\n  -n, --show-name             appending scientific name\n  -r, --show-rank             appending rank of taxids\n  -c, --show-status-code      show status code before lineage\n  -i, --taxid-field int       field index of taxid. input data should be tab-separated (default 1)\n</code></pre> <p>Examples</p> <ol> <li> <p>Full lineage:</p> <pre><code># note that 123124124 is a fake taxid, 3 was deleted, 92489,1458427 were merged\n$ cat taxids.txt \n9606\n9913\n376619\n349741\n239935\n314101\n11932\n1327037\n123124124\n3\n92489\n1458427\n\n$ taxonkit lineage taxids.txt | tee lineage.txt \n19:22:13.077 [WARN] taxid 92489 was merged into 796334\n19:22:13.077 [WARN] taxid 1458427 was merged into 1458425\n19:22:13.077 [WARN] taxid 123124124 not found\n19:22:13.077 [WARN] taxid 3 was deleted\n9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens\n9913    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Laurasiatheria;Artiodactyla;Ruminantia;Pecora;Bovidae;Bovinae;Bos;Bos taurus\n376619  cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;Francisella tularensis subsp. holarctica;Francisella tularensis subsp. holarctica LVS\n349741  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\n239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n314101  cellular organisms;Bacteria;environmental samples;uncultured murine large bowel bacterium BAC 54B\n11932   Viruses;Riboviria;Pararnavirae;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;unclassified Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\n1327037 Viruses;Duplodnaviria;Heunggongvirae;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;unclassified Siphoviridae;Croceibacter phage P2559Y\n123124124\n3\n92489   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\n1458427 cellular organisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raicheisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n\n# wrapped table with csvtk pretty (&gt;v0.26.0)\n$ taxonkit lineage taxids.txt | csvtk pretty -Ht -x ';' -W 70 -S bold\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 9606    \u2503 cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria; \u2503\n\u2503         \u2503 Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;   \u2503\n\u2503         \u2503 Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;     \u2503\n\u2503         \u2503 Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;      \u2503\n\u2503         \u2503 Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;     \u2503\n\u2503         \u2503 Homo;Homo sapiens                                                      \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 9913    \u2503 cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria; \u2503\n\u2503         \u2503 Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;   \u2503\n\u2503         \u2503 Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;     \u2503\n\u2503         \u2503 Mammalia;Theria;Eutheria;Boreoeutheria;Laurasiatheria;Artiodactyla;    \u2503\n\u2503         \u2503 Ruminantia;Pecora;Bovidae;Bovinae;Bos;Bos taurus                       \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 376619  \u2503 cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;        \u2503\n\u2503         \u2503 Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;      \u2503\n\u2503         \u2503 Francisella tularensis subsp. holarctica;                              \u2503\n\u2503         \u2503 Francisella tularensis subsp. holarctica LVS                           \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 349741  \u2503 cellular organisms;Bacteria;PVC group;Verrucomicrobia;                 \u2503\n\u2503         \u2503 Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;       \u2503\n\u2503         \u2503 Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835           \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 239935  \u2503 cellular organisms;Bacteria;PVC group;Verrucomicrobia;                 \u2503\n\u2503         \u2503 Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;       \u2503\n\u2503         \u2503 Akkermansia muciniphila                                                \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 314101  \u2503 cellular organisms;Bacteria;environmental samples;                     \u2503\n\u2503         \u2503 uncultured murine large bowel bacterium BAC 54B                        \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 11932   \u2503 Viruses;Riboviria;Pararnavirae;Artverviricota;Revtraviricetes;         \u2503\n\u2503         \u2503 Ortervirales;Retroviridae;unclassified Retroviridae;                   \u2503\n\u2503         \u2503 Intracisternal A-particles;Mouse Intracisternal A-particle             \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 1327037 \u2503 Viruses;Duplodnaviria;Heunggongvirae;Uroviricota;Caudoviricetes;       \u2503\n\u2503         \u2503 Caudovirales;Siphoviridae;unclassified Siphoviridae;                   \u2503\n\u2503         \u2503 Croceibacter phage P2559Y                                              \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 92489   \u2503 cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;        \u2503\n\u2503         \u2503 Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae                     \u2503\n\u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n\u2503 1458427 \u2503 cellular organisms;Bacteria;Proteobacteria;Betaproteobacteria;         \u2503\n\u2503         \u2503 Burkholderiales;Comamonadaceae;Serpentinomonas;                        \u2503\n\u2503         \u2503 Serpentinomonas raichei                                                \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u253b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n</code></pre> </li> <li> <p>Speed.</p> <pre><code>$ time echo 9606 | taxonkit lineage \n9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens\n\nreal    0m1.190s\nuser    0m2.365s\nsys     0m0.170s\n\n# all TaxIds\n$ time taxonkit list --ids 1 --indent \"\" | taxonkit lineage &gt; t\n\nreal    0m4.249s\nuser    0m16.418s\nsys     0m1.221s\n</code></pre> </li> <li> <p>Checking deleted or merged taxids</p> <pre><code>$ taxonkit lineage --show-status-code taxids.txt | tee lineage.withcode.txt\n\n# valid\n$ cat lineage.withcode.txt | awk '$2 &gt; 0' | cut -f 1,2\n9606    9606\n9913    9913\n376619  376619\n349741  349741\n239935  239935\n314101  314101\n11932   11932\n1327037 1327037\n92489   796334\n1458427 1458425\n\n# merged\n$ cat lineage.withcode.txt | awk '$2 &gt; 0 &amp;&amp; $2 != $1' | cut -f 1,2\n92489   796334\n1458427 1458425\n\n# deleted\n$ cat lineage.withcode.txt | awk '$2 == 0' | cut -f 1\n3\n\n# invalid\n$ cat lineage.withcode.txt | awk '$2 &lt; 0' | cut -f 1\n123124124\n</code></pre> </li> <li> <p>Filter out invalid and deleted taxids, and replace merged taxids with new ones,   you may install csvtk.</p> <pre><code># input is one-column-taxid\n$ taxonkit lineage -c taxids.txt \\\n    | awk '$2&gt;0' \\\n    | cut -f 2-\n\n# taxids are in 3rd field in a 4-columns tab-delimited file,\n# for $5, where 5 = 4 + 1.\n$ cat input.txt \\\n    | taxonkit lineage -c -i 3 \\\n    | csvtk filter2 -H -t -f '$5&gt;0' \\\n    | csvtk -H -t cut -f -3\n</code></pre> </li> <li> <p>Only show name and rank.</p> <pre><code>$ taxonkit lineage -r -n -L taxids.txt \\\n    | csvtk pretty -H -t\n9606        Homo sapiens                                      species\n9913        Bos taurus                                        species\n376619      Francisella tularensis subsp. holarctica LVS      strain\n349741      Akkermansia muciniphila ATCC BAA-835              strain\n239935      Akkermansia muciniphila                           species\n314101      uncultured murine large bowel bacterium BAC 54B   species\n11932       Mouse Intracisternal A-particle                   species\n1327037     Croceibacter phage P2559Y                         species\n123124124                                                     \n3                                                             \n92489       Erwinia oleae                                     species\n1458427     Serpentinomonas raichei                           species\n</code></pre> </li> <li> <p>Show lineage consisting of taxids:</p> <pre><code>$ taxonkit lineage -t taxids.txt\n9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens  131567;2759;33154;33208;6072;33213;33511;7711;89593;7742;7776;117570;117571;8287;1338369;32523;32524;40674;32525;9347;1437010;314146;9443;376913;314293;9526;314295;9604;207598;9605;9606\n9913    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Laurasiatheria;Artiodactyla;Ruminantia;Pecora;Bovidae;Bovinae;Bos;Bos taurus   131567;2759;33154;33208;6072;33213;33511;7711;89593;7742;7776;117570;117571;8287;1338369;32523;32524;40674;32525;9347;1437010;314145;91561;9845;35500;9895;27592;9903;9913\n376619  cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;Francisella tularensis subsp. holarctica;Francisella tularensis subsp. holarctica LVS     131567;2;1224;1236;72273;34064;262;263;119857;376619\n349741  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835      131567;2;1783257;74201;203494;48461;1647988;239934;239935;349741\n239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila   131567;2;1783257;74201;203494;48461;1647988;239934;239935\n314101  cellular organisms;Bacteria;environmental samples;uncultured murine large bowel bacterium BAC 54B       131567;2;48479;314101\n11932   Viruses;Riboviria;Pararnavirae;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;unclassified Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle    10239;2559587;2732397;2732409;2732514;2169561;11632;35276;11749;11932\n1327037 Viruses;Duplodnaviria;Heunggongvirae;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;unclassified Siphoviridae;Croceibacter phage P2559Y   10239;2731341;2731360;2731618;2731619;28883;10699;196894;1327037\n123124124\n3\n92489   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae       131567;2;1224;1236;91347;1903409;551;796334\n1458427 cellular organisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei    131567;2;1224;28216;80840;80864;2490452;1458425\n</code></pre> <p>or read taxids from STDIN:</p> <pre><code>$ cat taxids.txt | taxonkit lineage\n</code></pre> </li> <li> <p>And ranks of all nodes:</p> <pre><code>$ echo 2697049 \\\n    | taxonkit lineage -t -R \\\n    | csvtk transpose -Ht\n2697049\nViruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2\n10239;2559587;2732396;2732408;2732506;76804;2499399;11118;2501931;694002;2509511;694009;2697049\nsuperkingdom;clade;kingdom;phylum;class;order;suborder;family;subfamily;genus;subgenus;species;no rank\n</code></pre> <p>Another way to show lineage detail of a TaxId</p> <pre><code>$ echo 2697049 \\\n    | taxonkit lineage -t \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -H -t \n10239     superkingdom   Viruses\n2559587   clade          Riboviria\n2732396   kingdom        Orthornavirae\n2732408   phylum         Pisuviricota\n2732506   class          Pisoniviricetes\n76804     order          Nidovirales\n2499399   suborder       Cornidovirineae\n11118     family         Coronaviridae\n2501931   subfamily      Orthocoronavirinae\n694002    genus          Betacoronavirus\n2509511   subgenus       Sarbecovirus\n694009    species        Severe acute respiratory syndrome-related coronavirus\n2697049   no rank        Severe acute respiratory syndrome coronavirus 2\n</code></pre> </li> </ol>"},{"location":"usage/#reformat","title":"reformat","text":"<p>Usage</p> <pre><code>Reformat lineage in canonical ranks\n\nInput:\n\n  - List of TaxIds or lineages, one record per line.\n    The lineage can be a complete lineage or only one taxonomy name.\n  - Or tab-delimited format.\n    Plese specify the lineage field with flag -i/--lineage-field (default 2).\n    Or specify the TaxId field with flag -I/--taxid-field (default 0),\n    which overrides -i/--lineage-field.\n  - Supporting (gzipped) file or STDIN.\n\nOutput:\n\n  1. Input line data.\n  2. Reformated lineage.\n  3. (Optional) TaxIds taxons in the lineage (-t/--show-lineage-taxids)\n\nAmbiguous names:\n\n  - Some TaxIds have the same complete lineage, empty result is returned\n    by default. You can use the flag -a/--output-ambiguous-result to\n    return one possible result\n\nOutput format can be formated by flag --format, available placeholders:\n\n    {k}: superkingdom\n    {K}: kingdom\n    {p}: phylum\n    {c}: class\n    {o}: order\n    {f}: family\n    {g}: genus\n    {s}: species\n    {t}: subspecies/strain\n\n    {S}: subspecies\n    {T}: strain\n\nWhen these're no nodes of rank \"subspecies\" nor \"strain\",\nyou can switch on -S/--pseudo-strain to use the node with lowest rank\nas subspecies/strain name, if which rank is lower than \"species\".\nThis flag affects {t}, {S}, {T}.\n\nOutput format can contains some escape charactors like \"\\t\".\n\nUsage:\n  taxonkit reformat [flags]\n\nFlags:\n  -P, --add-prefix                     add prefixes for all ranks, single prefix for a rank is defined\n                                       by flag --prefix-X\n  -d, --delimiter string               field delimiter in input lineage (default \";\")\n  -F, --fill-miss-rank                 fill missing rank with lineage information of the next higher rank\n  -f, --format string                  output format, placeholders of rank are needed (default\n                                       \"{k};{p};{c};{o};{f};{g};{s}\")\n  -h, --help                           help for reformat\n  -i, --lineage-field int              field index of lineage. data should be tab-separated (default 2)\n  -r, --miss-rank-repl string          replacement string for missing rank\n  -p, --miss-rank-repl-prefix string   prefix for estimated taxon level (default \"unclassified \")\n  -s, --miss-rank-repl-suffix string   suffix for estimated taxon names. \"rank\" for rank name, \"\" for no\n                                       suffix (default \"rank\")\n  -R, --miss-taxid-repl string         replacement string for missing taxid\n  -a, --output-ambiguous-result        output one of the ambigous result\n      --prefix-K string                prefix for kingdom, used along with flag -P/--add-prefix (default\n                                       \"K__\")\n      --prefix-S string                prefix for subspecies, used along with flag -P/--add-prefix\n                                       (default \"S__\")\n      --prefix-T string                prefix for strain, used along with flag -P/--add-prefix (default\n                                       \"T__\")\n      --prefix-c string                prefix for class, used along with flag -P/--add-prefix (default \"c__\")\n      --prefix-f string                prefix for family, used along with flag -P/--add-prefix (default\n                                       \"f__\")\n      --prefix-g string                prefix for genus, used along with flag -P/--add-prefix (default \"g__\")\n      --prefix-k string                prefix for superkingdom, used along with flag -P/--add-prefix\n                                       (default \"k__\")\n      --prefix-o string                prefix for order, used along with flag -P/--add-prefix (default \"o__\")\n      --prefix-p string                prefix for phylum, used along with flag -P/--add-prefix (default\n                                       \"p__\")\n      --prefix-s string                prefix for species, used along with flag -P/--add-prefix (default\n                                       \"s__\")\n      --prefix-t string                prefix for subspecies/strain, used along with flag\n                                       -P/--add-prefix (default \"t__\")\n  -S, --pseudo-strain                  use the node with lowest rank as strain name, only if which rank\n                                       is lower than \"species\" and not \"subpecies\" nor \"strain\". It\n                                       affects {t}, {S}, {T}. This flag needs flag -F\n  -t, --show-lineage-taxids            show corresponding taxids of reformated lineage\n  -I, --taxid-field int                field index of taxid. input data should be tab-separated. it\n                                       overrides -i/--lineage-field\n  -T, --trim                           do not fill or add prefix for missing rank lower than current rank\n</code></pre> <p>Examples:</p> <ol> <li> <p>For version &gt; 0.8.0, <code>reformat</code> accept input of TaxIds via flag <code>-I/--taxid-field</code>.</p> <pre><code>$ echo 239935 | taxonkit reformat -I 1\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n\n$ echo 349741 | taxonkit reformat -I 1 -f \"{k}|{p}|{c}|{o}|{f}|{g}|{s}|{t}\" -F -t\n349741  Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia|Akkermansia muciniphila|Akkermansia muciniphila ATCC BAA-835    2|74201|203494|48461|1647988|239934|239935|349741\n</code></pre> </li> <li> <p>Example lineage (produced by: <code>taxonkit lineage taxids.txt | awk '$2!=\"\"' &gt; lineage.txt</code>).</p> <pre><code>$ cat lineage.txt\n9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens\n9913    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Laurasiatheria;Artiodactyla;Ruminantia;Pecora;Bovidae;Bovinae;Bos;Bos taurus\n376619  cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis;Francisella tularensis subsp. holarctica;Francisella tularensis subsp. holarctica LVS\n349741  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\n239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n314101  cellular organisms;Bacteria;environmental samples;uncultured murine large bowel bacterium BAC 54B\n11932   Viruses;Riboviria;Pararnavirae;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;unclassified Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\n1327037 Viruses;Duplodnaviria;Heunggongvirae;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;unclassified Siphoviridae;Croceibacter phage P2559Y\n92489   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\n1458427 cellular organisms;Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n</code></pre> </li> <li> <p>Default output format (<code>\"{k};{p};{c};{o};{f};{g};{s}\"</code>).</p> <pre><code># reformated lineages are appended to the input data\n$ taxonkit reformat lineage.txt \n...\n239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila     Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n...\n\n$ \n$ taxonkit reformat lineage.txt | tee lineage.txt.reformat\n\n$ cut -f 1,3 lineage.txt.reformat\n9606    Eukaryota;Chordata;Mammalia;Primates;Hominidae;Homo;Homo sapiens\n9913    Eukaryota;Chordata;Mammalia;Artiodactyla;Bovidae;Bos;Bos taurus\n376619  Bacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis\n349741  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n314101  Bacteria;;;;;;uncultured murine large bowel bacterium BAC 54B\n11932   Viruses;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\n1327037 Viruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;;Croceibacter phage P2559Y\n92489   Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\n1458427 Bacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n\n# aligned \n$ cat lineage.txt \\\n    | taxonkit reformat \\\n    | csvtk -H -t cut -f 1,3 \\\n    | csvtk -H -t sep -f 2 -s ';' -R \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species \\\n    | csvtk pretty -t\n\ntaxid     kindom      phylum            class                 order                family            genus                        species\n-------   ---------   ---------------   -------------------   ------------------   ---------------   --------------------------   -----------------------------------------------\n9606      Eukaryota   Chordata          Mammalia              Primates             Hominidae         Homo                         Homo sapiens\n9913      Eukaryota   Chordata          Mammalia              Artiodactyla         Bovidae           Bos                          Bos taurus\n376619    Bacteria    Proteobacteria    Gammaproteobacteria   Thiotrichales        Francisellaceae   Francisella                  Francisella tularensis\n349741    Bacteria    Verrucomicrobia   Verrucomicrobiae      Verrucomicrobiales   Akkermansiaceae   Akkermansia                  Akkermansia muciniphila\n239935    Bacteria    Verrucomicrobia   Verrucomicrobiae      Verrucomicrobiales   Akkermansiaceae   Akkermansia                  Akkermansia muciniphila\n314101    Bacteria                                                                                                                uncultured murine large bowel bacterium BAC 54B\n11932     Viruses     Artverviricota    Revtraviricetes       Ortervirales         Retroviridae      Intracisternal A-particles   Mouse Intracisternal A-particle\n1327037   Viruses     Uroviricota       Caudoviricetes        Caudovirales         Siphoviridae                                   Croceibacter phage P2559Y\n92489     Bacteria    Proteobacteria    Gammaproteobacteria   Enterobacterales     Erwiniaceae       Erwinia                      Erwinia oleae\n1458427   Bacteria    Proteobacteria    Betaproteobacteria    Burkholderiales      Comamonadaceae    Serpentinomonas              Serpentinomonas raichei\n</code></pre> </li> <li> <p>And <code>subspecies/strain</code> (<code>{t}</code>), <code>subspecies</code> (<code>{S}</code>), and <code>strain</code> (<code>{T}</code>) are also available.</p> <pre><code># default operation\n$ echo -ne \"239935\\n83333\\n1408252\\n2697049\\n2605619\\n\" \\\n    | taxonkit lineage -n -r \\\n    | taxonkit reformat -f '{t};{S};{T}' \\\n    | csvtk -H -t cut -f 1,4,3,5 \\\n    | csvtk -H -t sep -f 4 -s ';' -R \\\n    | csvtk -H -t add-header -n \"taxid,rank,name,subspecies/strain,subspecies,strain\" \\\n    | csvtk pretty -t\n\ntaxid     rank         name                                              subspecies/strain       subspecies              strain\n-------   ----------   -----------------------------------------------   ---------------------   ---------------------   ---------------------\n239935    species      Akkermansia muciniphila                                                                           \n83333     strain       Escherichia coli K-12                             Escherichia coli K-12                           Escherichia coli K-12\n1408252   subspecies   Escherichia coli R178                             Escherichia coli R178   Escherichia coli R178   \n2697049   no rank      Severe acute respiratory syndrome coronavirus 2                                                   \n2605619   no rank      Escherichia coli O16:H48\n\n# fill missing ranks\n# see example below for -F/--fill-miss-rank\n#\n$ echo -ne \"239935\\n83333\\n1408252\\n2697049\\n2605619\\n\" \\\n    | taxonkit lineage -n -r \\\n    | taxonkit reformat -f '{t};{S};{T}' --fill-miss-rank \\\n    | csvtk -H -t cut -f 1,4,3,5 \\\n    | csvtk -H -t sep -f 4 -s ';' -R \\\n    | csvtk -H -t add-header -n \"taxid,rank,name,subspecies/strain,subspecies,strain\" \\\n    | csvtk pretty -t\n\ntaxid     rank         name                                              subspecies/strain                                                                      subspecies                                                                      strain\n-------   ----------   -----------------------------------------------   ------------------------------------------------------------------------------------   -----------------------------------------------------------------------------   -------------------------------------------------------------------------\n239935    species      Akkermansia muciniphila                           unclassified Akkermansia muciniphila subspecies/strain                                 unclassified Akkermansia muciniphila subspecies                                 unclassified Akkermansia muciniphila strain\n83333     strain       Escherichia coli K-12                             Escherichia coli K-12                                                                  unclassified Escherichia coli subspecies                                        Escherichia coli K-12\n1408252   subspecies   Escherichia coli R178                             Escherichia coli R178                                                                  Escherichia coli R178                                                           unclassified Escherichia coli R178 strain\n2697049   no rank      Severe acute respiratory syndrome coronavirus 2   unclassified Severe acute respiratory syndrome-related coronavirus subspecies/strain   unclassified Severe acute respiratory syndrome-related coronavirus subspecies   unclassified Severe acute respiratory syndrome-related coronavirus strain\n2605619   no rank      Escherichia coli O16:H48                          unclassified Escherichia coli subspecies/strain                                        unclassified Escherichia coli subspecies                                        unclassified Escherichia coli strain\n</code></pre> </li> <li> <p>When these's no nodes of rank \"subspecies\" nor \"strain\",    you can switch <code>-S/--pseudo-strain</code> to use the node with lowest rank    as subspecies/strain name, if which rank is lower than \"species\". Recommend using v0.14.1 or later versions.</p> <pre><code>$ echo -ne \"239935\\n83333\\n1408252\\n2697049\\n2605619\\n\" \\\n    | taxonkit lineage -n -r \\\n    | taxonkit reformat -f '{t};{S};{T}' --pseudo-strain \\\n    | csvtk -H -t cut -f 1,4,3,5 \\\n    | csvtk -H -t sep -f 4 -s ';' -R \\\n    | csvtk -H -t add-header -n \"taxid,rank,name,subspecies/strain,subspecies,strain\" \\\n    | csvtk pretty -t\n\ntaxid     rank         name                                              subspecies/strain                                 subspecies                                        strain\n-------   ----------   -----------------------------------------------   -----------------------------------------------   -----------------------------------------------   -----------------------------------------------\n239935    species      Akkermansia muciniphila\n83333     strain       Escherichia coli K-12                             Escherichia coli K-12                                                                               Escherichia coli K-12\n1408252   subspecies   Escherichia coli R178                             Escherichia coli R178                             Escherichia coli R178\n2697049   no rank      Severe acute respiratory syndrome coronavirus 2   Severe acute respiratory syndrome coronavirus 2   Severe acute respiratory syndrome coronavirus 2   Severe acute respiratory syndrome coronavirus 2\n2605619   no rank      Escherichia coli O16:H48                          Escherichia coli O16:H48                          Escherichia coli O16:H48                          Escherichia coli O16:H48\n</code></pre> </li> <li> <p>Add prefix (<code>-P/--add-prefix</code>).</p> <pre><code>$ cat lineage.txt \\\n    | taxonkit reformat -P \\\n    | csvtk -H -t cut -f 1,3\n\n9606    k__Eukaryota;p__Chordata;c__Mammalia;o__Primates;f__Hominidae;g__Homo;s__Homo sapiens\n9913    k__Eukaryota;p__Chordata;c__Mammalia;o__Artiodactyla;f__Bovidae;g__Bos;s__Bos taurus\n376619  k__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Thiotrichales;f__Francisellaceae;g__Francisella;s__Francisella tularensis\n349741  k__Bacteria;p__Verrucomicrobia;c__Verrucomicrobiae;o__Verrucomicrobiales;f__Akkermansiaceae;g__Akkermansia;s__Akkermansia muciniphila\n239935  k__Bacteria;p__Verrucomicrobia;c__Verrucomicrobiae;o__Verrucomicrobiales;f__Akkermansiaceae;g__Akkermansia;s__Akkermansia muciniphila\n314101  k__Bacteria;p__;c__;o__;f__;g__;s__uncultured murine large bowel bacterium BAC 54B\n11932   k__Viruses;p__Artverviricota;c__Revtraviricetes;o__Ortervirales;f__Retroviridae;g__Intracisternal A-particles;s__Mouse Intracisternal A-particle\n1327037 k__Viruses;p__Uroviricota;c__Caudoviricetes;o__Caudovirales;f__Siphoviridae;g__;s__Croceibacter phage P2559Y\n92489   k__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Enterobacterales;f__Erwiniaceae;g__Erwinia;s__Erwinia oleae\n1458427 k__Bacteria;p__Proteobacteria;c__Betaproteobacteria;o__Burkholderiales;f__Comamonadaceae;g__Serpentinomonas;s__Serpentinomonas raichei\n</code></pre> </li> <li> <p>Show corresponding taxids of reformated lineage (flag <code>-t/--show-lineage-taxids</code>)</p> <pre><code>$ cat lineage.txt \\\n    | taxonkit reformat -t \\\n    | csvtk -H -t cut -f 1,4 \\\n    | csvtk -H -t sep -f 2 -s ';' -R \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species \\\n    | csvtk pretty -t\n\ntaxid     kindom   phylum    class     order     family    genus     species\n-------   ------   -------   -------   -------   -------   -------   -------\n9606      2759     7711      40674     9443      9604      9605      9606\n9913      2759     7711      40674     91561     9895      9903      9913\n376619    2        1224      1236      72273     34064     262       263\n349741    2        74201     203494    48461     1647988   239934    239935\n239935    2        74201     203494    48461     1647988   239934    239935\n314101    2                                                          314101\n11932     10239    2732409   2732514   2169561   11632     11749     11932\n1327037   10239    2731618   2731619   28883     10699               1327037\n92489     2        1224      1236      91347     1903409   551       796334\n1458427   2        1224      28216     80840     80864     2490452   1458425\n</code></pre> </li> <li> <p>Use custom symbols for unclassfied ranks (<code>-r/--miss-rank-repl</code>)</p> <pre><code>$ taxonkit reformat lineage.txt -r \"__\"  | cut -f 3\nEukaryota;Chordata;Mammalia;Primates;Hominidae;Homo;Homo sapiens\nEukaryota;Chordata;Mammalia;Artiodactyla;Bovidae;Bos;Bos taurus\nBacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis\nBacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\nBacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\nBacteria;__;__;__;__;__;uncultured murine large bowel bacterium BAC 54B\nViruses;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\nViruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;__;Croceibacter phage P2559Y\nBacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\nBacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n\n$ taxonkit reformat lineage.txt -r Unassigned | cut -f 3\nEukaryota;Chordata;Mammalia;Primates;Hominidae;Homo;Homo sapiens\nEukaryota;Chordata;Mammalia;Artiodactyla;Bovidae;Bos;Bos taurus\nBacteria;Proteobacteria;Gammaproteobacteria;Thiotrichales;Francisellaceae;Francisella;Francisella tularensis\nBacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\nBacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\nBacteria;Unassigned;Unassigned;Unassigned;Unassigned;Unassigned;uncultured murine large bowel bacterium BAC 54B\nViruses;Artverviricota;Revtraviricetes;Ortervirales;Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\nViruses;Uroviricota;Caudoviricetes;Caudovirales;Siphoviridae;Unassigned;Croceibacter phage P2559Y\nBacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Erwiniaceae;Erwinia;Erwinia oleae\nBacteria;Proteobacteria;Betaproteobacteria;Burkholderiales;Comamonadaceae;Serpentinomonas;Serpentinomonas raichei\n</code></pre> </li> <li> <p>Estimate and fill missing rank with original lineage information   (<code>-F, --fill-miss-rank</code>, very useful for formatting input data for   LEfSe).   You can change the prefix \"unclassified\" using flag <code>-p/--miss-rank-repl-prefix</code>.</p> <pre><code>$ cat lineage.txt \\\n    | taxonkit reformat -F \\\n    | csvtk -H -t cut -f 1,3 \\\n    | csvtk -H -t sep -f 2 -s ';' -R \\\n    | csvtk add-header -t -n taxid,kindom,phylum,class,order,family,genus,species \\\n    | csvtk pretty -t\n\ntaxid     kindom      phylum                         class                         order                         family                         genus                             species\n-------   ---------   ----------------------------   ---------------------------   ---------------------------   ----------------------------   -------------------------------   -----------------------------------------------\n9606      Eukaryota   Chordata                       Mammalia                      Primates                      Hominidae                      Homo                              Homo sapiens\n9913      Eukaryota   Chordata                       Mammalia                      Artiodactyla                  Bovidae                        Bos                               Bos taurus\n376619    Bacteria    Proteobacteria                 Gammaproteobacteria           Thiotrichales                 Francisellaceae                Francisella                       Francisella tularensis\n349741    Bacteria    Verrucomicrobia                Verrucomicrobiae              Verrucomicrobiales            Akkermansiaceae                Akkermansia                       Akkermansia muciniphila\n239935    Bacteria    Verrucomicrobia                Verrucomicrobiae              Verrucomicrobiales            Akkermansiaceae                Akkermansia                       Akkermansia muciniphila\n314101    Bacteria    unclassified Bacteria phylum   unclassified Bacteria class   unclassified Bacteria order   unclassified Bacteria family   unclassified Bacteria genus       uncultured murine large bowel bacterium BAC 54B\n11932     Viruses     Artverviricota                 Revtraviricetes               Ortervirales                  Retroviridae                   Intracisternal A-particles        Mouse Intracisternal A-particle\n1327037   Viruses     Uroviricota                    Caudoviricetes                Caudovirales                  Siphoviridae                   unclassified Siphoviridae genus   Croceibacter phage P2559Y\n92489     Bacteria    Proteobacteria                 Gammaproteobacteria           Enterobacterales              Erwiniaceae                    Erwinia                           Erwinia oleae\n1458427   Bacteria    Proteobacteria                 Betaproteobacteria            Burkholderiales               Comamonadaceae                 Serpentinomonas                   Serpentinomonas raichei\n</code></pre> <p>Do not add prefix or suffix for estimated nodes:</p> <pre><code>$ echo 314101 |  taxonkit reformat -I  1\n314101  Bacteria;;;;;;uncultured murine large bowel bacterium BAC 54B\n$ echo 314101 |  taxonkit reformat -I 1 -F -p \"\" -s \"\"\n314101  Bacteria;Bacteria;Bacteria;Bacteria;Bacteria;Bacteria;uncultured murine large bowel bacterium BAC 54B\n</code></pre> </li> <li> <p>Only some ranks.</p> <pre><code>$ cat lineage.txt \\\n    | taxonkit reformat -F -f \"{s};{p}\"\\\n    | csvtk -H -t cut -f 1,3 \\\n    | csvtk -H -t sep -f 2 -s ';' -R \\\n    | csvtk add-header -t -n taxid,species,phylum \\\n    | csvtk pretty -t\n\ntaxid     species                                           phylum\n-------   -----------------------------------------------   ----------------------------\n9606      Homo sapiens                                      Chordata\n9913      Bos taurus                                        Chordata\n376619    Francisella tularensis                            Proteobacteria\n349741    Akkermansia muciniphila                           Verrucomicrobia\n239935    Akkermansia muciniphila                           Verrucomicrobia\n314101    uncultured murine large bowel bacterium BAC 54B   unclassified Bacteria phylum\n11932     Mouse Intracisternal A-particle                   Artverviricota\n1327037   Croceibacter phage P2559Y                         Uroviricota\n92489     Erwinia oleae                                     Proteobacteria\n1458427   Serpentinomonas raichei                           Proteobacteria\n</code></pre> </li> <li> <p>For some taxids which rank is higher than the lowest rank in <code>-f/--format</code>, use <code>-T/--trim</code> to avoid fill missing rank lower than current rank.</p> <pre><code>$ echo -ne \"2\\n239934\\n239935\\n\" \\\n    | taxonkit lineage \\\n    | taxonkit reformat -F \\\n    | sed -r \"s/;+$//\" \\\n    | csvtk -H -t cut -f 1,3\n\n2       Bacteria;unclassified Bacteria phylum;unclassified Bacteria class;unclassified Bacteria order;unclassified Bacteria family;unclassified Bacteria genus;unclassified Bacteria species\n239934  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;unclassified Akkermansia species\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n\n$ echo -ne \"2\\n239934\\n239935\\n\" \\\n    | taxonkit lineage \\\n    | taxonkit reformat -F -T \\\n    | sed -r \"s/;+$//\" \\\n    | csvtk -H -t cut -f 1,3\n\n2       Bacteria\n239934  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia\n239935  Bacteria;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n</code></pre> </li> <li> <p>Support tab in format string</p> <pre><code>$ echo 9606 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{S}\" \\\n    | csvtk cut -t -f -2\n\n9606    Eukaryota       Chordata        Mammalia        Primates        Hominidae       Homo    Homo sapiens\n</code></pre> </li> <li> <p>List seven-level lineage for all TaxIds.</p> <pre><code># replace empty taxon with \"Unassigned\"\n$ taxonkit list --ids 1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -r Unassigned \n    | gzip -c &gt; all.lineage.tsv.gz\n\n# tab-delimited seven-levels\n$ taxonkit list --ids 1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -r Unassigned -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\" \\\n    | csvtk cut -H -t -f -2 \\\n    | head -n 5 \\\n    | csvtk pretty -H -t\n\n# 8-level\n$ taxonkit list --ids 1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -r Unassigned -f \"{k}\\t{p}\\t{c}\\t{o}\\t{f}\\t{g}\\t{s}\\t{t}\" \\\n    | csvtk cut -H -t -f -2 \\\n    | head -n 5 \\\n    | csvtk pretty -H -t\n\n# Fill and trim\n$ memusg -t -s ' taxonkit list --ids 1 \\\n    | taxonkit lineage \\\n    | taxonkit reformat -F -T \\\n    | sed -r \"s/;+$//\" \\\n    | gzip -c &gt; all.lineage.tsv.gz '\n\nelapsed time: 19.930s\npeak rss: 6.25 GB\n</code></pre> </li> <li> <p>From taxid to 7-ranks lineage:</p> <pre><code>$ cat taxids.txt | taxonkit lineage | taxonkit reformat\n\n# for taxonkit v0.8.0 or later versions\n$ cat taxids.txt | taxonkit reformat -I 1\n</code></pre> </li> <li> <p>Some TaxIds have the same complete lineage, empty result is returned      by default. You can use the flag <code>-a/--output-ambiguous-result</code> to     return one possible result. see #42</p> <pre><code>$ echo -ne \"2507530\\n2516889\\n\" | taxonkit lineage --data-dir . | taxonkit reformat --data-dir . -t \n19:18:29.770 [WARN] we can't distinguish the TaxIds (2507530, 2516889) for lineage: cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019. But you can use -a/--output-ambiguous-result to return one possible result\n19:18:29.770 [WARN] we can't distinguish the TaxIds (2507530, 2516889) for lineage: cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019. But you can use -a/--output-ambiguous-result to return one possible result\n2507530 cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019\n2516889 cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019\n\n$ echo -ne \"2507530\\n2516889\\n\" | taxonkit lineage --data-dir . | taxonkit reformat --data-dir . -t -a\n2507530 cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019     Eukaryota;Basidiomycota;Agaricomycetes;Russulales;Russulaceae;Russula;Russula sp. 8 KA-2019      2759;5204;155619;452342;5401;5402;2507530\n2516889 cellular organisms;Eukaryota;Opisthokonta;Fungi;Dikarya;Basidiomycota;Agaricomycotina;Agaricomycetes;Agaricomycetes incertae sedis;Russulales;Russulaceae;Russula;unclassified Russula;Russula sp. 8 KA-2019     Eukaryota;Basidiomycota;Agaricomycetes;Russulales;Russulaceae;Russula;Russula sp. 8 KA-2019      2759;5204;155619;452342;5401;5402;2507530\n</code></pre> </li> </ol>"},{"location":"usage/#name2taxid","title":"name2taxid","text":"<p>Usage</p> <pre><code>Convert taxon names to TaxIds\n\nAttention:\n\n  1. Some TaxIds share the same names, e.g, Drosophila.\n     These input lines are duplicated with multiple TaxIds.\n\n    $ echo Drosophila | taxonkit name2taxid | taxonkit lineage -i 2 -r -L\n    Drosophila      7215    genus\n    Drosophila      32281   subgenus\n    Drosophila      2081351 genus\n\nUsage:\n  taxonkit name2taxid [flags]\n\nFlags:\n  -h, --help             help for name2taxid\n  -i, --name-field int   field index of name. data should be tab-separated (default 1)\n  -s, --sci-name         only searching scientific names\n  -r, --show-rank        show rank\n</code></pre> <p>Examples</p> <p>Example data</p> <pre><code>$ cat names.txt\nHomo sapiens\nAkkermansia muciniphila ATCC BAA-835\nAkkermansia muciniphila\nMouse Intracisternal A-particle\nWei Shen\nuncultured murine large bowel bacterium BAC 54B\nCroceibacter phage P2559Y\n</code></pre> <ol> <li> <p>Default.</p> <pre><code># taxonkit name2taxid names.txt\n$ cat names.txt | taxonkit name2taxid | csvtk pretty -H -t\nHomo sapiens                                      9606\nAkkermansia muciniphila ATCC BAA-835              349741\nAkkermansia muciniphila                           239935\nMouse Intracisternal A-particle                   11932\nWei Shen                                          \nuncultured murine large bowel bacterium BAC 54B   314101\nCroceibacter phage P2559Y                         1327037\n</code></pre> </li> <li> <p>Show rank.</p> <pre><code>$ cat names.txt | taxonkit name2taxid --show-rank | csvtk pretty -H -t\nHomo sapiens                                      9606      species\nAkkermansia muciniphila ATCC BAA-835              349741    strain\nAkkermansia muciniphila                           239935    species\nMouse Intracisternal A-particle                   11932     species\nWei Shen                                                    \nuncultured murine large bowel bacterium BAC 54B   314101    species\nCroceibacter phage P2559Y                         1327037   species\n</code></pre> </li> <li> <p>From name to lineage.</p> <pre><code>$ cat names.txt | taxonkit name2taxid | taxonkit lineage --taxid-field 2\nHomo sapiens    9606    cellular organisms;Eukaryota;Opisthokonta;Metazoa;Eumetazoa;Bilateria;Deuterostomia;Chordata;Craniata;Vertebrata;Gnathostomata;Teleostomi;Euteleostomi;Sarcopterygii;Dipnotetrapodomorpha;Tetrapoda;Amniota;Mammalia;Theria;Eutheria;Boreoeutheria;Euarchontoglires;Primates;Haplorrhini;Simiiformes;Catarrhini;Hominoidea;Hominidae;Homininae;Homo;Homo sapiens\nAkkermansia muciniphila ATCC BAA-835    349741  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\nAkkermansia muciniphila 239935  cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\nMouse Intracisternal A-particle 11932   Viruses;Ortervirales;Retroviridae;unclassified Retroviridae;Intracisternal A-particles;Mouse Intracisternal A-particle\nWei Shen\nuncultured murine large bowel bacterium BAC 54B 314101  cellular organisms;Bacteria;environmental samples;uncultured murine large bowel bacterium BAC 54B\nCroceibacter phage P2559Y       1327037 Viruses;Caudovirales;Siphoviridae;unclassified Siphoviridae;Croceibacter phage P2559Y\n</code></pre> </li> <li> <p>Convert old names to new names.</p> <pre><code>$ echo Lactobacillus fermentum | taxonkit name2taxid | taxonkit lineage -i 2 -n | cut -f 1,2,4\nLactobacillus fermentum 1613    Limosilactobacillus fermentum\n</code></pre> </li> <li> <p>Some TaxIds share the same scientific names, e.g, Drosophila.</p> <pre><code>$ echo Drosophila \\\n    | taxonkit name2taxid \\\n    | taxonkit lineage -i 2 -r \\\n    | taxonkit reformat -i 3 \\\n    | csvtk cut -H -t -f 1,2,4,5 \\\n    | csvtk pretty -H -t\nDrosophila   7215      genus      Eukaryota;Arthropoda;Insecta;Diptera;Drosophilidae;Drosophila;\nDrosophila   32281     subgenus   Eukaryota;Arthropoda;Insecta;Diptera;Drosophilidae;Drosophila;\nDrosophila   2081351   genus      Eukaryota;Basidiomycota;Agaricomycetes;Agaricales;Psathyrellaceae;Drosophila;\n</code></pre> </li> </ol>"},{"location":"usage/#filter","title":"filter","text":"<p>Usage</p> <pre><code>Filter TaxIds by taxonomic rank range\n\nAttentions:\n\n  1. Flag -L/--lower-than and -H/--higher-than are exclusive, and can be\n     used along with -E/--equal-to which values can be different.\n  2. A list of pre-ordered ranks is in ~/.taxonkit/ranks.txt, you can use\n     your list by -r/--rank-file, the format specification is below.\n  3. All ranks in taxonomy database should be defined in rank file.\n  4. Ranks can be removed with black list via -B/--black-list.\n\n  5. TaxIDs with no rank are kept by default!!!\n     They can be optionally discarded by -N/--discard-noranks.\n  6. [Recommended] When filtering with -L/--lower-than, you can use\n    -n/--save-predictable-norank to save some special ranks without order,\n    where rank of the closest higher node is still lower than rank cutoff.\n\nRank file:\n\n  1. Blank lines or lines starting with \"#\" are ignored.\n  2. Ranks are in decending order and case ignored.\n  3. Ranks with same order should be in one line separated with comma (\",\", no space).\n  4. Ranks without order should be assigned a prefix symbol \"!\" for each rank.\n\nUsage:\n  taxonkit filter [flags]\n\nFlags:\n  -B, --black-list strings        black list of ranks to discard, e.g., '-B \"no rank\" -B \"clade\"\n  -N, --discard-noranks           discard all ranks without order, type \"taxonkit filter --help\" for details\n  -R, --discard-root              discard root taxid, defined by --root-taxid\n  -E, --equal-to strings          output TaxIds with rank equal to some ranks, multiple values can be\n                                  separated with comma \",\" (e.g., -E \"genus,species\"), or give multiple\n                                  times (e.g., -E genus -E species)\n  -h, --help                      help for filter\n  -H, --higher-than string        output TaxIds with rank higher than a rank, exclusive with --lower-than\n      --list-order                list user defined ranks in order, from \"$HOME/.taxonkit/ranks.txt\"\n      --list-ranks                list ordered ranks in taxonomy database, sorted in user defined order\n  -L, --lower-than string         output TaxIds with rank lower than a rank, exclusive with --higher-than\n  -r, --rank-file string          user-defined ordered taxonomic ranks, type \"taxonkit filter --help\"\n                                  for details\n      --root-taxid uint32         root taxid (default 1)\n  -n, --save-predictable-norank   do not discard some special ranks without order when using -L, where\n                                  rank of the closest higher node is still lower than rank cutoff\n  -i, --taxid-field int           field index of taxid. input data should be tab-separated (default 1)\n</code></pre> <p>Examples</p> <ol> <li> <p>Example data</p> <pre><code>$ echo 349741 | taxonkit lineage -t | cut -f 3 | sed 's/;/\\n/g' &gt; taxids2.txt\n\n$ cat taxids2.txt\n131567\n2\n1783257\n74201\n203494\n48461\n1647988\n239934\n239935\n349741\n\n$ cat taxids2.txt  | taxonkit lineage -r | csvtk -Ht cut -f 1,3,2 | csvtk pretty -H -t\n131567    no rank        cellular organisms\n2         superkingdom   cellular organisms;Bacteria\n1783257   clade          cellular organisms;Bacteria;PVC group\n74201     phylum         cellular organisms;Bacteria;PVC group;Verrucomicrobia\n203494    class          cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae\n48461     order          cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales\n1647988   family         cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae\n239934    genus          cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia\n239935    species        cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila\n349741    strain         cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835\n</code></pre> </li> <li> <p>Equal to certain rank(s) (<code>-E/--equal-to</code>)</p> <pre><code>$ cat taxids2.txt \\\n    | taxonkit filter -E Phylum -E Class \\\n    | taxonkit lineage -r \\\n    | csvtk -Ht cut -f 1,3,2 \\\n    | csvtk pretty -H -t\n74201    phylum   cellular organisms;Bacteria;PVC group;Verrucomicrobia\n203494   class    cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae\n</code></pre> </li> <li> <p>Lower than a rank (<code>-L/--lower-than</code>)</p> <pre><code>$ cat taxids2.txt \\\n    | taxonkit filter -L genus \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk -Ht cut -f 1,3,2 \\\n    | csvtk pretty -H -t\n239935   species   Akkermansia muciniphila\n349741   strain    Akkermansia muciniphila ATCC BAA-835\n</code></pre> </li> <li> <p>Higher than a rank (<code>-H/--higher-than</code>)</p> <pre><code>$ cat taxids2.txt \\\n    | taxonkit filter -H phylum \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk -Ht cut -f 1,3,2 \\\n    | csvtk pretty -H -t\n2   superkingdom   Bacteria\n</code></pre> </li> <li> <p>TaxIDs with no rank are kept by default!!!   \"no rank\" and \"clade\" have no rank and can be filter out via <code>-N/--discard-noranks</code>.   Futher ranks can be removed with black list via <code>-B/--black-list</code>.</p> <pre><code># 562 is the TaxId of Escherichia coli\n$ taxonkit list --ids 562 \\\n    | taxonkit filter -L species \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk freq -Ht -f 2 -nr \\\n    | csvtk pretty -H -t\nstrain       2950\nno rank      149\nserotype     141\nserogroup    95\nisolate      1\nsubspecies   1\n\n$ taxonkit list --ids 562 \\\n    | taxonkit filter -L species -N -B strain \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk freq -Ht -f 2 -nr \\\n    | csvtk pretty -H -t\nserotype     141\nserogroup    95\nisolate      1\nsubspecies   1\n</code></pre> </li> <li> <p>Combine of <code>-L/-H</code> with <code>-E</code>.</p> <pre><code>$ cat taxids2.txt \\\n    | taxonkit filter -L genus -E genus  \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -H -t\n239934   genus     Akkermansia\n239935   species   Akkermansia muciniphila\n349741   strain    Akkermansia muciniphila ATCC BAA-835\n</code></pre> </li> <li> <p>Special cases of \"no rank\". (<code>-n/--save-predictable-norank</code>).     When filtering with <code>-L/--lower-than</code>, you can use     <code>-n/--save-predictable-norank</code> to save some special ranks without order,     where rank of the closest higher node is still lower than rank cutoff.</p> <pre><code>$ echo -ne \"2605619\\n1327037\\n\" \\\n    | taxonkit lineage -t \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -H -t \n131567    no rank        cellular organisms\n2         superkingdom   Bacteria\n1224      phylum         Proteobacteria\n1236      class          Gammaproteobacteria\n91347     order          Enterobacterales\n543       family         Enterobacteriaceae\n561       genus          Escherichia\n562       species        Escherichia coli\n2605619   no rank        Escherichia coli O16:H48\n\n10239     superkingdom   Viruses\n2731341   clade          Duplodnaviria\n2731360   clade          Heunggongvirae\n2731618   phylum         Uroviricota\n2731619   class          Caudoviricetes\n28883     order          Caudovirales\n10699     family         Siphoviridae\n196894    no rank        unclassified Siphoviridae\n1327037   species        Croceibacter phage P2559Y\n\n# save taxids\n$  echo -ne \"2605619\\n1327037\\n\" \\\n    | taxonkit lineage -t \\\n    | csvtk cut -Ht -f 3 \\\n    | csvtk unfold -Ht -f 1 -s \";\" \\\n    | tee taxids4.txt\n131567\n2\n1224\n1236\n91347\n543\n561\n562\n2605619\n10239\n2731341\n2731360\n2731618\n2731619\n28883\n10699\n196894\n1327037\n</code></pre> <p>Now, filter nodes of rank &lt;= species.</p> <pre><code>$ cat taxids4.txt \\\n    | taxonkit filter -L species -E species -N -n \\\n    | taxonkit lineage -r -n -L \\\n    | csvtk cut -Ht -f 1,3,2 \\\n    | csvtk pretty -H -t\n562       species   Escherichia coli\n2605619   no rank   Escherichia coli O16:H48\n1327037   species   Croceibacter phage P2559Y\n</code></pre> <p>Note that 2605619 (no rank) is saved because its parent node 562 is &lt;= species.</p> </li> </ol>"},{"location":"usage/#lca","title":"lca","text":"<p>Usage</p> <pre><code>Compute lowest common ancestor (LCA) for TaxIds\n\nAttention:\n\n  1. This command computes LCA TaxId for a list of TaxIds \n     in a field (\"-i/--taxids-field) of tab-delimited file or STDIN.\n  2. TaxIDs should have the same separator (\"-s/--separator\"),\n     single charactor separator is prefered.\n  3. Empty lines or lines without valid TaxIds in the field are omitted.\n  4. If some TaxIds are not found in database, it returns 0.\n\nExamples:\n\n    $ echo 239934, 239935, 349741 | taxonkit lca  -s \", \"\n    239934, 239935, 349741  239934\n\n    $ time echo 239934  239935  349741 9606  | taxonkit lca\n    239934 239935 349741 9606       131567\n\nUsage:\n  taxonkit lca [flags] \n\nFlags:\n  -b, --buffer-size string   size of line buffer, supported unit: K, M, G. You need to increase the\n                             value when \"bufio.Scanner: token too long\" error occured (default \"1M\")\n  -h, --help                 help for lca\n      --separater string     separater for TaxIds. This flag is same to --separator. (default \" \")\n  -s, --separator string     separator for TaxIds (default \" \")\n  -D, --skip-deleted         skip deleted TaxIds and compute with left ones\n  -U, --skip-unfound         skip unfound TaxIds and compute with left ones\n  -i, --taxids-field int     field index of TaxIds. Input data should be tab-separated (default 1)\n</code></pre> <p>Examples:</p> <ol> <li> <p>Example data</p> <pre><code>$ taxonkit list --ids 9605 -nr --indent \"    \"\n9605 [genus] Homo\n    9606 [species] Homo sapiens\n        63221 [subspecies] Homo sapiens neanderthalensis\n        741158 [subspecies] Homo sapiens subsp. 'Denisova'\n    1425170 [species] Homo heidelbergensis\n    2665952 [no rank] environmental samples\n        2665953 [species] Homo sapiens environmental sample\n</code></pre> </li> <li> <p>Simple one</p> <pre><code>$ echo 63221 2665953 | taxonkit lca\n63221 2665953   9605\n</code></pre> </li> <li> <p>Custom field (<code>-i/--taxids-field</code>) and separater (<code>-s/--separator</code>).</p> <pre><code>$ echo -ne \"a\\t63221,2665953\\nb\\t63221, 741158\\n\"\na       63221,2665953\nb       63221, 741158\n\n$ echo -ne \"a\\t63221,2665953\\nb\\t63221, 741158\\n\" \\\n    | taxonkit lca -i 2 -s \",\"\na       63221,2665953   9605\nb       63221, 741158   9606\n</code></pre> </li> <li> <p>Merged TaxIds.</p> <pre><code># merged\n$ echo 92487 92488 92489 | taxonkit lca\n10:08:26.578 [WARN] taxid 92489 was merged into 796334\n92487 92488 92489       1236\n</code></pre> </li> <li> <p>Deleted TaxIds, you can ommit theses and continue compute with left onces with (<code>-D/--skip-deleted</code>).</p> <pre><code>$ echo 1 2 3 | taxonkit lca \n10:30:17.678 [WARN] taxid 3 not found\n1 2 3   0\n\n$ time  echo 1 2 3 | taxonkit lca -D\n10:29:31.828 [WARN] taxid 3 was deleted\n1 2 3   1\n</code></pre> </li> <li> <p>TaxIDs not found in database, you can ommit theses and continue compute with left onces with (<code>-U/--skip-unfound</code>).</p> <pre><code>$ echo 61021 61022 11111111 | taxonkit lca\n10:31:44.929 [WARN] taxid 11111111 not found\n61021 61022 11111111    0\n\n$ echo 61021 61022 11111111 | taxonkit lca -U\n10:32:02.772 [WARN] taxid 11111111 not found\n61021 61022 11111111    2628496\n</code></pre> </li> </ol>"},{"location":"usage/#taxid-changelog","title":"taxid-changelog","text":"<p>Usage</p> <pre><code>Create TaxId changelog from dump archives\n\nSteps:\n\n    # dependencies:\n    #   rush - https://github.com/shenwei356/rush/\n\n    mkdir -p archive; cd archive;\n\n    # --------- download ---------\n\n    # option 1\n    # for fast network connection\n    wget ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdump_archive/taxdmp*.zip\n\n    # option 2\n    # for slow network connection\n    url=https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdump_archive/\n    wget $url -O - -o /dev/null \\\n        | grep taxdmp | perl -ne '/(taxdmp_.+?.zip)/; print \"$1\\n\";' \\\n        | rush -j 2 -v url=$url 'axel -n 5 {url}/{}' \\\n            --immediate-output  -c -C download.rush\n\n    # --------- unzip ---------\n\n    ls taxdmp*.zip | rush -j 1 'unzip {} names.dmp nodes.dmp merged.dmp delnodes.dmp -d {@_(.+)\\.}'\n\n    # optionally compress .dmp files with pigz, for saving disk space\n    fd .dmp$ | rush -j 4 'pigz {}'\n\n    # --------- create log ---------\n\n    cd ..\n    taxonkit taxid-changelog -i archive -o taxid-changelog.csv.gz --verbose\n\nOutput format (CSV):\n\n    # fields        comments\n    taxid           # taxid\n    version         # version / time of archive, e.g, 2019-07-01\n    change          # change, values:\n                    #   NEW             newly added\n                    #   REUSE_DEL       deleted taxids being reused\n                    #   REUSE_MER       merged taxids being reused\n                    #   DELETE          deleted\n                    #   MERGE           merged into another taxid\n                    #   ABSORB          other taxids merged into this one\n                    #   CHANGE_NAME     scientific name changed\n                    #   CHANGE_RANK     rank changed\n                    #   CHANGE_LIN_LIN  lineage taxids remain but lineage remain\n                    #   CHANGE_LIN_TAX  lineage taxids changed\n                    #   CHANGE_LIN_LEN  lineage length changed\n    change-value    # variable values for changes: \n                    #   1) new taxid for MERGE\n                    #   2) merged taxids for ABSORB\n                    #   3) empty for others\n    name            # scientific name\n    rank            # rank\n    lineage         # complete lineage of the taxid\n    lineage-taxids  # taxids of the lineage\n\n    # you can use csvtk to investigate them. e.g.,\n    csvtk grep -f taxid -p 1390515 taxid-changelog.csv.gz\n\nUsage:\n  taxonkit taxid-changelog [flags]\n\nFlags:\n  -i, --archive string   directory containing uncompressed dumped archives\n  -h, --help             help for taxid-changelog\n</code></pre> <p>Details</p> <ol> <li> <p>Example 1  (E.coli with taxid <code>562</code>)</p> <pre><code>$ pigz -cd taxid-changelog.csv.gz \\\n    | csvtk grep -f taxid -p 562 \\\n    | csvtk pretty\ntaxid   version      change           change-value    name               rank      lineage                                                                                                                            lineage-taxids\n562     2014-08-01   NEW                              Escherichia coli   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia coli   131567;2;1224;1236;91347;543;561;562\n562     2014-08-01   ABSORB           662101;662104   Escherichia coli   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia coli   131567;2;1224;1236;91347;543;561;562\n562     2015-11-01   ABSORB           1637691         Escherichia coli   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia coli   131567;2;1224;1236;91347;543;561;562\n562     2016-10-01   CHANGE_LIN_LIN                   Escherichia coli   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli    131567;2;1224;1236;91347;543;561;562\n562     2018-06-01   ABSORB           469598          Escherichia coli   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli    131567;2;1224;1236;91347;543;561;562\n\n# merged taxids\n$ pigz -cd taxid-changelog.csv.gz \\\n    | csvtk grep -f taxid -p 662101,662104,1637691,469598 \\\n    | csvtk pretty\ntaxid     version      change           change-value   name                        rank      lineage                                                                                                                                     lineage-taxids\n469598    2014-08-01   NEW                             Escherichia sp. 3_2_53FAA   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia sp. 3_2_53FAA   131567;2;1224;1236;91347;543;561;469598\n469598    2016-10-01   CHANGE_LIN_LIN                  Escherichia sp. 3_2_53FAA   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia sp. 3_2_53FAA    131567;2;1224;1236;91347;543;561;469598\n469598    2018-06-01   MERGE            562            Escherichia sp. 3_2_53FAA   species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia sp. 3_2_53FAA    131567;2;1224;1236;91347;543;561;469598\n662101    2014-08-01   MERGE            562                                                                                                                                                                                              \n662104    2014-08-01   MERGE            562                                                                                                                                                                                              \n1637691   2015-04-01   DELETE                                                                                                                                                                                                            \n1637691   2015-05-01   REUSE_DEL                       Escherichia sp. MAR         species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia sp. MAR         131567;2;1224;1236;91347;543;561;1637691\n1637691   2015-11-01   MERGE            562            Escherichia sp. MAR         species   cellular organisms;Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacteriales;Enterobacteriaceae;Escherichia;Escherichia sp. MAR         131567;2;1224;1236;91347;543;561;1637691\n</code></pre> </li> <li> <p>Example 2 (SARS-CoV-2).</p> <pre><code>$ time pigz -cd taxid-changelog.csv.gz \\\n        | csvtk grep -f taxid -p 2697049 \\\n        | csvtk pretty\ntaxid     version      change           change-value   name                                              rank      lineage                                                                                                                                                                                                                                                        lineage-taxids\n2697049   2020-02-01   NEW                             Wuhan seafood market pneumonia virus              species   Viruses;Riboviria;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;unclassified Betacoronavirus;Wuhan seafood market pneumonia virus                                                                                               10239;2559587;76804;2499399;11118;2501931;694002;696098;2697049\n2697049   2020-03-01   CHANGE_NAME                     Severe acute respiratory syndrome coronavirus 2   no rank   Viruses;Riboviria;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2                                              10239;2559587;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n2697049   2020-03-01   CHANGE_RANK                     Severe acute respiratory syndrome coronavirus 2   no rank   Viruses;Riboviria;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2                                              10239;2559587;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n2697049   2020-03-01   CHANGE_LIN_LEN                  Severe acute respiratory syndrome coronavirus 2   no rank   Viruses;Riboviria;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2                                              10239;2559587;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n2697049   2020-06-01   CHANGE_LIN_LEN                  Severe acute respiratory syndrome coronavirus 2   no rank   Viruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2   10239;2559587;2732396;2732408;2732506;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n2697049   2020-07-01   CHANGE_RANK                     Severe acute respiratory syndrome coronavirus 2   isolate   Viruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2   10239;2559587;2732396;2732408;2732506;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n2697049   2020-08-01   CHANGE_RANK                     Severe acute respiratory syndrome coronavirus 2   no rank   Viruses;Riboviria;Orthornavirae;Pisuviricota;Pisoniviricetes;Nidovirales;Cornidovirineae;Coronaviridae;Orthocoronavirinae;Betacoronavirus;Sarbecovirus;Severe acute respiratory syndrome-related coronavirus;Severe acute respiratory syndrome coronavirus 2   10239;2559587;2732396;2732408;2732506;76804;2499399;11118;2501931;694002;2509511;694009;2697049\n\nreal    0m7.644s\nuser    0m16.749s\nsys     0m3.985s\n</code></pre> </li> <li> <p>Example 3 (All subspecies and strain in Akkermansia muciniphila 239935)</p> <pre><code># species in Akkermansia\n$ taxonkit list --show-rank --show-name --indent \"    \" --ids 239935\n239935 [species] Akkermansia muciniphila\n    349741 [strain] Akkermansia muciniphila ATCC BAA-835\n\n# check them all  \n$ pigz -cd taxid-changelog.csv.gz \\\n    | csvtk grep -f taxid -P &lt;(taxonkit list --indent \"\" --ids 239935) \\\n    | csvtk pretty                                                                                                                                                   lineage-taxids\ntaxid    version      change           change-value   name                                   rank      lineage                                                                                                                                                                                                         lineage-taxids\n239935   2014-08-01   NEW                             Akkermansia muciniphila                species   cellular organisms;Bacteria;Chlamydiae/Verrucomicrobia group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Verrucomicrobiaceae;Akkermansia;Akkermansia muciniphila                                        131567;2;51290;74201;203494;48461;203557;239934;239935\n239935   2015-05-01   CHANGE_LIN_TAX                  Akkermansia muciniphila                species   cellular organisms;Bacteria;Chlamydiae/Verrucomicrobia group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila                                            131567;2;51290;74201;203494;48461;1647988;239934;239935\n239935   2016-03-01   CHANGE_LIN_TAX                  Akkermansia muciniphila                species   cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila                                                                   131567;2;1783257;74201;203494;48461;1647988;239934;239935\n239935   2016-05-01   ABSORB           1834199        Akkermansia muciniphila                species   cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila                                                                   131567;2;1783257;74201;203494;48461;1647988;239934;239935\n349741   2014-08-01   NEW                             Akkermansia muciniphila ATCC BAA-835   no rank   cellular organisms;Bacteria;Chlamydiae/Verrucomicrobia group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Verrucomicrobiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835   131567;2;51290;74201;203494;48461;203557;239934;239935;349741\n349741   2015-05-01   CHANGE_LIN_TAX                  Akkermansia muciniphila ATCC BAA-835   no rank   cellular organisms;Bacteria;Chlamydiae/Verrucomicrobia group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835       131567;2;51290;74201;203494;48461;1647988;239934;239935;349741\n349741   2016-03-01   CHANGE_LIN_TAX                  Akkermansia muciniphila ATCC BAA-835   no rank   cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835                              131567;2;1783257;74201;203494;48461;1647988;239934;239935;349741\n349741   2020-07-01   CHANGE_RANK                     Akkermansia muciniphila ATCC BAA-835   strain    cellular organisms;Bacteria;PVC group;Verrucomicrobia;Verrucomicrobiae;Verrucomicrobiales;Akkermansiaceae;Akkermansia;Akkermansia muciniphila;Akkermansia muciniphila ATCC BAA-835                              131567;2;1783257;74201;203494;48461;1647988;239934;239935;349741\n</code></pre> </li> </ol> <p>More</p>"},{"location":"usage/#create-taxdump","title":"create-taxdump","text":"<p>Usage</p> <pre><code>Create NCBI-style taxdump files for custom taxonomy, e.g., GTDB and ICTV\n\nInput format: \n  0. For GTDB taxonomy file, just use --gtdb.\n     We use the numeric assembly accession as the taxon at subspecies rank.\n     (without the prefix GCA_ and GCF_, and version number).\n  1. The input file should be tab-delimited, at least one column is needed.\n  2. Ranks can be given either via the first row or the flag --rank-names.\n  3. The column containing the genome/assembly accession is recommended to\n     generate TaxId mapping file (taxid.map, id -&gt; taxid).\n       -A/--field-accession,    field contaning genome/assembly accession      \n       --field-accession-re,    regular expression to extract the accession\n     Note that mutiple TaxIds pointing to the same accession are listed as\n     comma-seperated integers. \n\nAttentions:\n  1. Names should be distinct in taxa of different ranks.\n     But for these missing some taxon nodes, using names of parent nodes is allowed:\n\n       GB_GCA_018897955.1      d__Archaea;p__EX4484-52;c__EX4484-52;o__EX4484-52;f__LFW-46;g__LFW-46;s__LFW-46 sp018897155\n\n     It can also detect duplicate names with different ranks, e.g.,\n     the Class and Genus have the same name B47-G6, and the Order and Family\n     between them have different names. In this case, we reassign a new TaxId\n     by increasing the TaxId until it being distinct.\n\n       GB_GCA_003663585.1      d__Archaea;p__Thermoplasmatota;c__B47-G6;o__B47-G6B;f__47-G6;g__B47-G6;s__B47-G6 sp003663585\n\n  2. Taxa from different parents may have the same name.\n     We will assign different TaxIds to them. \n\n     E.g., in ICTV, many viruses from different species have the same names.\n     In practice, we set the \"Virus names(s)\" as a subspecies rank and also\n     specify it as the accession.\n\n       Species             Virus name(s)\n       Jerseyvirus SETP3   Salmonella phage SETP7\n       Jerseyvirus SETP7   Salmonella phage SETP7\n\n  3. The generated TaxIds are not consecutive numbers, however some tools like MMSeqs2\n     required this, you can use the script below for convertion:\n\n     https://github.com/apcamargo/ictv-mmseqs2-protein-database/blob/master/fix_taxdump.py\n\nUsage:\n  taxonkit create-taxdump [flags] \n\nFlags:\n  -A, --field-accession int         field index of assembly accession (genome ID), for outputting taxid.map\n      --field-accession-re string   regular expression to extract assembly accession (default\n                                    \"^\\\\w\\\\w_(.+)$\")\n      --force                       overwrite existed output directory\n      --gtdb                        input files are GTDB taxonomy file\n      --gtdb-re-subs string         regular expression to extract assembly accession as the subspecies\n                                    (default \"^\\\\w\\\\w_GC[AF]_(.+)\\\\.\\\\d+$\")\n  -h, --help                        help for create-taxdump\n      --line-chunk-size int         number of lines to process for each thread, and 4 threads is fast\n                                    enough. (default 5000)\n      --null strings                null value of taxa (default [,NULL,NA])\n  -x, --old-taxdump-dir string      taxdump directory of the previous version, for generating merged.dmp\n                                    and delnodes.dmp\n  -O, --out-dir string              output directory\n  -R, --rank-names strings          names of all ranks, leave it empty to use the first row of input as\n                                    rank names\n</code></pre> <p>Examples:</p> <ol> <li> <p>GTDB. See more: https://github.com/shenwei356/gtdb-taxdump</p> <pre><code>$ taxonkit create-taxdump --gtdb ar53_taxonomy_r207.tsv.gz bac120_taxonomy_r207.tsv.gz --out-dir taxdump\n16:42:35.213 [INFO] 317542 records saved to taxdump/taxid.map\n16:42:35.460 [INFO] 401815 records saved to taxdump/nodes.dmp\n16:42:35.611 [INFO] 401815 records saved to taxdump/names.dmp\n16:42:35.611 [INFO] 0 records saved to taxdump/merged.dmp\n16:42:35.611 [INFO] 0 records saved to taxdump/delnodes.dmp\n</code></pre> </li> <li> <p>ICTV, See more: https://github.com/shenwei356/ictv-taxdump</p> </li> <li> <p>MGV. Only Order, Family, Genus information are available.</p> <pre><code>$ cat mgv_contig_info.tsv \\\n    | csvtk cut -t -f ictv_order,ictv_family,ictv_genus,votu_id,contig_id \\\n    | sed 1d \\\n    &gt; mgv.tsv\n\n$ taxonkit create-taxdump mgv.tsv --out-dir mgv --force -A 5 -R order,family,genus,species\n23:33:18.098 [INFO] 189680 records saved to mgv/taxid.map\n23:33:18.131 [INFO] 58102 records saved to mgv/nodes.dmp\n23:33:18.150 [INFO] 58102 records saved to mgv/names.dmp\n23:33:18.150 [INFO] 0 records saved to mgv/merged.dmp\n23:33:18.150 [INFO] 0 records saved to mgv/delnodes.dmp\n\n$ head -n 5 mgv/taxid.map \nMGV-GENOME-0364295      677052301\nMGV-GENOME-0364296      677052301\nMGV-GENOME-0364303      1414406025\nMGV-GENOME-0364311      1849074420\nMGV-GENOME-0364312      2074846424\n\n$ echo 677052301 | taxonkit lineage --data-dir mgv/ \n677052301       Caudovirales;crAss-phage;OTU-61123\n\n$ echo 677052301 | taxonkit reformat --data-dir mgv/ -I 1 -P\n677052301       k__;p__;c__;o__Caudovirales;f__crAss-phage;g__;s__OTU-61123\n\n$ grep MGV-GENOME-0364295 mgv.tsv \nCaudovirales    crAss-phage     NULL    OTU-61123       MGV-GENOME-0364295\n</code></pre> </li> <li> <p>Custom lineages with the first row as rank names and treating one column as accession.</p> <pre><code>$ csvtk pretty -t example/taxonomy.tsv \nid                superkingdom   phylum           class                 order              family               genus            species\n---------------   ------------   --------------   -------------------   ----------------   ------------------   --------------   --------------------------\nGCF_001027105.1   Bacteria       Firmicutes       Bacilli               Bacillales         Staphylococcaceae    Staphylococcus   Staphylococcus aureus\nGCF_001096185.1   Bacteria       Firmicutes       Bacilli               Lactobacillales    Streptococcaceae     Streptococcus    Streptococcus pneumoniae\nGCF_001544255.1   Bacteria       Firmicutes       Bacilli               Lactobacillales    Enterococcaceae      Enterococcus     Enterococcus faecium\nGCF_002949675.1   Bacteria       Proteobacteria   Gammaproteobacteria   Enterobacterales   Enterobacteriaceae   Shigella         Shigella dysenteriae\nGCF_002950215.1   Bacteria       Proteobacteria   Gammaproteobacteria   Enterobacterales   Enterobacteriaceae   Shigella         Shigella flexneri\nGCF_006742205.1   Bacteria       Firmicutes       Bacilli               Bacillales         Staphylococcaceae    Staphylococcus   Staphylococcus epidermidis\nGCF_000006945.2   Bacteria       Proteobacteria   Gammaproteobacteria   Enterobacterales   Enterobacteriaceae   Salmonella       Salmonella enterica\nGCF_000017205.1   Bacteria       Proteobacteria   Gammaproteobacteria   Pseudomonadales    Pseudomonadaceae     Pseudomonas      Pseudomonas aeruginosa\nGCF_003697165.2   Bacteria       Proteobacteria   Gammaproteobacteria   Enterobacterales   Enterobacteriaceae   Escherichia      Escherichia coli\nGCF_009759685.1   Bacteria       Proteobacteria   Gammaproteobacteria   Moraxellales       Moraxellaceae        Acinetobacter    Acinetobacter baumannii\nGCF_000148585.2   Bacteria       Firmicutes       Bacilli               Lactobacillales    Streptococcaceae     Streptococcus    Streptococcus mitis\nGCF_000392875.1   Bacteria       Firmicutes       Bacilli               Lactobacillales    Enterococcaceae      Enterococcus     Enterococcus faecalis\nGCF_000742135.1   Bacteria       Proteobacteria   Gammaproteobacteria   Enterobacterales   Enterobacteriaceae   Klebsiella       Klebsiella pneumonia\n\n# the first column as accession\n$ taxonkit create-taxdump -A 1 example/taxonomy.tsv -O example/taxdump\n16:31:31.828 [INFO] I will use the first row of input as rank names\n16:31:31.843 [INFO] 13 records saved to example/taxdump/taxid.map\n16:31:31.843 [INFO] 39 records saved to example/taxdump/nodes.dmp\n16:31:31.843 [INFO] 39 records saved to example/taxdump/names.dmp\n16:31:31.843 [INFO] 0 records saved to example/taxdump/merged.dmp\n16:31:31.843 [INFO] 0 records saved to example/taxdump/delnodes.dmp\n\n$ export TAXONKIT_DB=example/taxdump\n$ taxonkit list --ids 1 | taxonkit filter -E species | taxonkit lineage -r\n1527235303      Bacteria;Firmicutes;Bacilli;Lactobacillales;Streptococcaceae;Streptococcus;Streptococcus mitis  species\n2983929374      Bacteria;Firmicutes;Bacilli;Lactobacillales;Streptococcaceae;Streptococcus;Streptococcus pneumoniae     species\n3809813362      Bacteria;Firmicutes;Bacilli;Lactobacillales;Enterococcaceae;Enterococcus;Enterococcus faecalis  species\n4145431389      Bacteria;Firmicutes;Bacilli;Lactobacillales;Enterococcaceae;Enterococcus;Enterococcus faecium   species\n1569132721      Bacteria;Firmicutes;Bacilli;Bacillales;Staphylococcaceae;Staphylococcus;Staphylococcus aureus   species\n1920251658      Bacteria;Firmicutes;Bacilli;Bacillales;Staphylococcaceae;Staphylococcus;Staphylococcus epidermidis      species\n3843752343      Bacteria;Proteobacteria;Gammaproteobacteria;Pseudomonadales;Pseudomonadaceae;Pseudomonas;Pseudomonas aeruginosa species\n72054943        Bacteria;Proteobacteria;Gammaproteobacteria;Moraxellales;Moraxellaceae;Acinetobacter;Acinetobacter baumannii    species\n1678121664      Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Salmonella;Salmonella enterica  species\n524994882       Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Shigella;Shigella dysenteriae   species\n2695851945      Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Shigella;Shigella flexneri      species\n3958205156      Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Klebsiella;Klebsiella pneumoniae        species\n4093283224      Bacteria;Proteobacteria;Gammaproteobacteria;Enterobacterales;Enterobacteriaceae;Escherichia;Escherichia coli    species\n\n$ head -n 3 example/taxdump/taxid.map\nGCF_001027105.1 1569132721\nGCF_001096185.1 2983929374\nGCF_001544255.1 4145431389\n</code></pre> </li> <li> <p>Custom lineages with the first row as rank names (pure lineage data)</p> <pre><code>$ csvtk cut -t -f 2- example/taxonomy.tsv | head -n 2 | csvtk pretty -t \nsuperkingdom   phylum       class     order        family              genus            species\n------------   ----------   -------   ----------   -----------------   --------------   ---------------------\nBacteria       Firmicutes   Bacilli   Bacillales   Staphylococcaceae   Staphylococcus   Staphylococcus aureus\n\n$ csvtk cut -t -f 2- example/taxonomy.tsv \\\n    | taxonkit create-taxdump -O example/taxdump2\n16:53:08.604 [INFO] I will use the first row of input as rank names\n16:53:08.614 [INFO] 39 records saved to example/taxdump2/nodes.dmp\n16:53:08.614 [INFO] 39 records saved to example/taxdump2/names.dmp\n16:53:08.614 [INFO] 0 records saved to example/taxdump2/merged.dmp\n16:53:08.615 [INFO] 0 records saved to example/taxdump2/delnodes.dmp\n\n$ export TAXONKIT_DB=example/taxdump2\n$ taxonkit list --ids 1 | taxonkit filter -E species | taxonkit lineage -r | head -n 2\n1527235303      Bacteria;Firmicutes;Bacilli;Lactobacillales;Streptococcaceae;Streptococcus;Streptococcus mitis  species\n2983929374      Bacteria;Firmicutes;Bacilli;Lactobacillales;Streptococcaceae;Streptococcus;Streptococcus pneumoniae     species\n</code></pre> </li> </ol>"},{"location":"usage/#genautocomplete","title":"genautocomplete","text":"<p>Usage</p> <pre><code>Generate shell autocompletion script\n\nSupported shell: bash|zsh|fish|powershell\n\nBash:\n\n    # generate completion shell\n    taxonkit genautocomplete --shell bash\n\n    # configure if never did.\n    # install bash-completion if the \"complete\" command is not found.\n    echo \"for bcfile in ~/.bash_completion.d/* ; do source \\$bcfile; done\" &gt;&gt; ~/.bash_completion\n    echo \"source ~/.bash_completion\" &gt;&gt; ~/.bashrc\n\nZsh:\n\n    # generate completion shell\n    taxonkit genautocomplete --shell zsh --file ~/.zfunc/_taxonkit\n\n    # configure if never did\n    echo 'fpath=( ~/.zfunc \"${fpath[@]}\" )' &gt;&gt; ~/.zshrc\n    echo \"autoload -U compinit; compinit\" &gt;&gt; ~/.zshrc\n\nfish:\n\n    taxonkit genautocomplete --shell fish --file ~/.config/fish/completions/taxonkit.fish\n\nUsage:\n  taxonkit genautocomplete [flags]\n\nFlags:\n      --file string   autocompletion file (default \"/home/shenwei/.bash_completion.d/taxonkit.sh\")\n  -h, --help          help for genautocomplete\n      --type string   autocompletion type (currently only bash supported) (default \"bash\")\n</code></pre>"},{"location":"usage/#profile2cami","title":"profile2cami","text":"<p>Usage</p> <pre><code>Convert metagenomic profile table to CAMI format\n\nInput format: \n  1. The input file should be tab-delimited\n  2. At least two columns needed:\n     a) TaxId of taxon at species or lower rank.\n     b) Abundance (could be percentage, automatically detected or use -p/--percentage).\n\nAttentions:\n  1. Some TaxIds may be merged to another ones in current taxonomy version,\n     the abundances will be summed up.\n  2. Some TaxIds may be deleted in current taxonomy version,\n     the abundances can be optionally recomputed with the flag -R/--recompute-abd.\n\nUsage:\n  taxonkit profile2cami [flags]\n\nFlags:\n  -a, --abundance-field int   field index of abundance. input data should be tab-separated (default 2)\n  -h, --help                  help for profile2cami\n  -0, --keep-zero             keep taxons with abundance of zero\n  -p, --percentage            abundance is in percentage\n  -R, --recompute-abd         recompute abundance if some TaxIds are deleted in current taxonomy version\n  -s, --sample-id string      sample ID in result file\n  -r, --show-rank strings     only show TaxIds and names of these ranks (default\n                              [superkingdom,phylum,class,order,family,genus,species,strain])\n  -i, --taxid-field int       field index of taxid. input data should be tab-separated (default 1)\n  -t, --taxonomy-id string    taxonomy ID in result file\n</code></pre> <p>Examples</p> <ul> <li> <p>Test data, note that <code>2824115</code> is merged to <code>483329</code> and <code>1657696</code> is deleted in current taxonomy version.</p> <pre><code>$ cat example/abundance.tsv \n2824115 0.2     merged to 483329\n483329  0.2     absord 2824115\n239935  0.5     no change\n1657696 0.1     deleted\n</code></pre> </li> <li> <p>Example:</p> <pre><code>$ taxonkit profile2cami -s sample1 -t 2021-10-01 \\\n    example/abundance.tsv\n\n13:17:40.552 [WARN] taxid is deleted in current taxonomy version: 1657696\n13:17:40.552 [WARN] you may recomputed abundance with the flag -R/--recompute-abd\n@SampleID:sample1\n@Version:0.10.0\n@Ranks:superkingdom|phylum|class|order|family|genus|species|strain\n@TaxonomyID:2021-10-01\n@@TAXID RANK    TAXPATH TAXPATHSN       PERCENTAGE\n2       superkingdom    2       Bacteria        50.000000000000000\n2759    superkingdom    2759    Eukaryota       40.000000000000000\n74201   phylum  2|74201 Bacteria|Verrucomicrobia        50.000000000000000\n6656    phylum  2759|6656       Eukaryota|Arthropoda    40.000000000000000\n203494  class   2|74201|203494  Bacteria|Verrucomicrobia|Verrucomicrobiae       50.000000000000000\n50557   class   2759|6656|50557 Eukaryota|Arthropoda|Insecta    40.000000000000000\n48461   order   2|74201|203494|48461    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales    50.000000000000000\n7041    order   2759|6656|50557|7041    Eukaryota|Arthropoda|Insecta|Coleoptera 40.000000000000000\n1647988 family  2|74201|203494|48461|1647988    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae    50.000000000000000\n57514   family  2759|6656|50557|7041|57514      Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae       40.000000000000000\n239934  genus   2|74201|203494|48461|1647988|239934     Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia 50.000000000000000\n57515   genus   2759|6656|50557|7041|57514|57515        Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae|Nicrophorus   40.000000000000000\n239935  species 2|74201|203494|48461|1647988|239934|239935      Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia|Akkermansia muciniphila 50.000000000000000\n483329  species 2759|6656|50557|7041|57514|57515|483329 Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae|Nicrophorus|Nicrophorus carolina       40.000000000000000\n</code></pre> </li> <li> <p>Recompute (normalize) the abundance</p> <pre><code>$ taxonkit profile2cami -s sample1 -t 2021-10-01 \\\n    example/abundance.tsv --recompute-abd\n13:19:23.647 [WARN] taxid is deleted in current taxonomy version: 1657696\n@SampleID:sample1\n@Version:0.10.0\n@Ranks:superkingdom|phylum|class|order|family|genus|species|strain\n@TaxonomyID:2021-10-01\n@@TAXID RANK    TAXPATH TAXPATHSN       PERCENTAGE\n2       superkingdom    2       Bacteria        55.555555555555557\n2759    superkingdom    2759    Eukaryota       44.444444444444450\n74201   phylum  2|74201 Bacteria|Verrucomicrobia        55.555555555555557\n6656    phylum  2759|6656       Eukaryota|Arthropoda    44.444444444444450\n203494  class   2|74201|203494  Bacteria|Verrucomicrobia|Verrucomicrobiae       55.555555555555557\n50557   class   2759|6656|50557 Eukaryota|Arthropoda|Insecta    44.444444444444450\n48461   order   2|74201|203494|48461    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales    55.555555555555557\n7041    order   2759|6656|50557|7041    Eukaryota|Arthropoda|Insecta|Coleoptera 44.444444444444450\n1647988 family  2|74201|203494|48461|1647988    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae    55.555555555555557\n57514   family  2759|6656|50557|7041|57514      Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae       44.444444444444450\n239934  genus   2|74201|203494|48461|1647988|239934     Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia 55.555555555555557\n57515   genus   2759|6656|50557|7041|57514|57515        Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae|Nicrophorus   44.444444444444450\n239935  species 2|74201|203494|48461|1647988|239934|239935      Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia|Akkermansia muciniphila 55.555555555555557\n483329  species 2759|6656|50557|7041|57514|57515|483329 Eukaryota|Arthropoda|Insecta|Coleoptera|Silphidae|Nicrophorus|Nicrophorus carolina       44.444444444444450\n</code></pre> </li> <li> <p>See https://github.com/shenwei356/sun2021-cami-profiles</p> </li> </ul>"},{"location":"usage/#cami-filter","title":"cami-filter","text":"<p>Usage</p> <pre><code>Remove taxa of given TaxIds and their descendants in CAMI metagenomic profile\n\nInput format: \n  The CAMI (Taxonomic) Profiling Output Format    \n  - https://github.com/CAMI-challenge/contest_information/blob/master/file_formats/CAMI_TP_specification.mkd\n  - One file with mutiple samples is also supported.\n\nHow to:\n  - No extra taxonomy data needed, so the original taxonomic information are\n    used and not changed.\n  - A mini taxonomic tree is built from records with abundance greater than\n    zero, and only leaves are retained for later use. The rank of leaves may\n    be \"strain\", \"species\", or \"no rank\".\n  - Relative abundances (in percentage) are recomputed for all leaves\n    (reference genome).\n  - A new taxonomic tree is built from these leaves, and abundances are \n    cumulatively added up from leaves to the root.\n\nExamples:\n  1. Remove Archaea, Bacteria, and EukaryoteS, only keep Viruses:\n      taxonkit cami-filter -t 2,2157,2759 test.profile -o test.filter.profile\n  2. Remove Viruses:\n      taxonkit cami-filter -t 10239 test.profile -o test.filter.profile\n\nUsage:\n  taxonkit cami-filter [flags]\n\nFlags:\n      --field-percentage int   field index of PERCENTAGE (default 5)\n      --field-rank int         field index of taxid (default 2)\n      --field-taxid int        field index of taxid (default 1)\n      --field-taxpath int      field index of TAXPATH (default 3)\n      --field-taxpathsn int    field index of TAXPATHSN (default 4)\n  -h, --help                   help for cami-filter\n      --leaf-ranks strings     only consider leaves at these ranks (default [species,strain,no rank])\n      --show-rank strings      only show TaxIds and names of these ranks (default\n                               [superkingdom,phylum,class,order,family,genus,species,strain])\n      --taxid-sep string       separator of taxid in TAXPATH and TAXPATHSN (default \"|\")\n  -t, --taxids strings         the parent taxid(s) to filter out\n  -f, --taxids-file strings    file(s) for the parent taxid(s) to filter out, one taxid per line\n</code></pre> <p>Examples:</p> <ol> <li>Remove Eukaryota<pre><code>taxonkit profile2cami -s sample1 -t 2021-10-01 \\\n    example/abundance.tsv --recompute-abd \\\n    | taxonkit cami-filter -t 2759\n@SampleID:sample1\n@Version:0.10.0\n@Ranks:superkingdom|phylum|class|order|family|genus|species|strain\n@TaxonomyID:2021-10-01\n@@TAXID RANK    TAXPATH TAXPATHSN       PERCENTAGE\n2       superkingdom    2       Bacteria        100.000000000000000\n74201   phylum  2|74201 Bacteria|Verrucomicrobia        100.000000000000000\n203494  class   2|74201|203494  Bacteria|Verrucomicrobia|Verrucomicrobiae       100.000000000000000\n48461   order   2|74201|203494|48461    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales    100.000000000000000\n1647988 family  2|74201|203494|48461|1647988    Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae    100.000000000000000\n239934  genus   2|74201|203494|48461|1647988|239934     Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia       100.000000000000000\n239935  species 2|74201|203494|48461|1647988|239934|239935      Bacteria|Verrucomicrobia|Verrucomicrobiae|Verrucomicrobiales|Akkermansiaceae|Akkermansia|Akkermansia muciniphila       100.000000000000000\n</code></pre> </li> </ol> Please enable JavaScript to view the comments powered by Disqus."},{"location":"bench/","title":"Benchmark","text":""},{"location":"bench/#benchmark-1-getting-lineage","title":"Benchmark 1: Getting lineage","text":""},{"location":"bench/#data-set","title":"Data set","text":"<ul> <li> <p>NCBI taxonomy, version 2021-01-21</p> </li> <li> <p>TaxIDs. Root node <code>1</code> is removed.    And These data should be updated along with NCBI taxonomy dataset.   Seven sizes of TaxIds are sampled from <code>nodes.dmp</code>.</p> <pre><code># shuffle all taxids\ncut -f 1 nodes.dmp | grep -w -v 1 | shuf &gt; ids.txt\n\n# extract n taxids for testing\nfor n in 1 10 100 1000 2000 4000 6000 8000 10000 20000 40000 60000 80000 100000; do \n    head -n $n ids.txt &gt; taxids.n$n.txt\ndone\n</code></pre> </li> </ul>"},{"location":"bench/#software","title":"Software","text":"<ul> <li>Loading database from local database:<ul> <li>ETE, version: 3.1.2</li> </ul> </li> <li>Directly parsing dump files:<ul> <li>taxopy, version: 0.5.0</li> <li>TaxonKit, version: 0.7.2</li> </ul> </li> </ul>"},{"location":"bench/#environment","title":"Environment","text":"<ul> <li>OS: Linux 5.4.89-1-MANJARO</li> <li>CPU: AMD Ryzen 7 2700X Eight-Core Processor, 3.7GHz</li> <li>RAM: 64GB DDR4 3000MHz</li> <li>SSD: Samsung 970EVO 500G NVMe SSD</li> </ul>"},{"location":"bench/#installation-and-configurations","title":"Installation and Configurations","text":"<ul> <li> <p>ETE</p> <pre><code>sudo pip3 install ete3\n\n# create database\n# http://etetoolkit.org/docs/latest/tutorial/tutorial_ncbitaxonomy.html#upgrading-the-local-database\nfrom ete3 import NCBITaxa\nncbi = NCBITaxa()\nncbi.update_taxonomy_database()\n</code></pre> </li> <li> <p>TaxonKit</p> <pre><code>mkdir -p $HOME/.taxonkit\nmkdir -p $HOME/bin/\n\n# data\nwget -c ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz \ntar -zxvf taxdump.tar.gz -C $HOME/.taxonkit\n\n# binary\nwget https://github.com/shenwei356/taxonkit/releases/download/v0.7.2/taxonkit_linux_amd64.tar.gz\ntar -zxvf taxonkit_linux_amd64.tar.gz -C $HOME/bin/\n</code></pre> </li> <li> <p>taxopy</p> <pre><code>sudo pip3 install -U taxopy\n\n# taxoopy identical dump files copied from taxonkit\nmkdir -p ~/.taxopy\ncp ~/.taxonkit/{nodes.dmp,names.dmp} ~/.taxopy\n</code></pre> </li> </ul>"},{"location":"bench/#scripts-and-commands","title":"Scripts and Commands","text":"<p>Scripts/Command as listed below. Python scripts were written following to the official documents, and parallelized querying were not used, including TaxonKit.</p> <pre><code>ETE             get_lineage.ete.py                              &lt; $infile &gt; $outfile\ntaxopy          get_lineage.taxopy.py                           &lt; $infile &gt; $outfile\ntaxonkit        taxonkit lineage --threads 1 --delimiter \"; \"   &lt; $infile &gt; $outfile\n</code></pre> <p>A Python script memusg was used to computate running time and peak memory usage of a process. A Perl scripts <code>run.pl</code> is used to automatically running tests and generate data for plotting.</p> <p>Running benchmark:</p> <pre><code>$ # emptying the buffers cache\n$ su -c \"free &amp;&amp; sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches &amp;&amp; free\"\n\ntime perl run.pl -n 3 run_benchmark.sh -o bench.get_lineage.tsv\n</code></pre> <p>Checking result:</p> <pre><code>$ md5sum taxids.n*.lineage\n\n# clear\n$ rm *.lineage *.out\n</code></pre> <p>Plotting benchmark result.  R libraries <code>dplyr</code>, <code>ggplot2</code>, <code>scales</code>, <code>ggthemes</code>, <code>ggrepel</code> are needed.</p> <pre><code># reformat dataset\n# tools: https://github.com/shenwei356/csvtk/\n\nfor f in taxids.n*.txt;  do wc -l $f; done \\\n    | sort -k 1,1n \\\n    | awk '{ print($2\"\\t\"$1) }' \\\n    &gt; dataset_rename.tsv\n\ncat bench.get_lineage.tsv \\\n    | csvtk sort -t -L dataset:&lt;(cut -f 1 dataset_rename.tsv) -k dataset:u -k app \\\n    | csvtk replace -t -f dataset -k dataset_rename.tsv -p '(.+)' -r '{kv}' \\\n    &gt; bench.get_lineage.reformat.tsv\n\n./plot2.R -i bench.get_lineage.reformat.tsv --width 6 --height 4 --dpi 600 \\\n    --labcolor \"log10(queries)\" --labshape \"Tools\"\n</code></pre> <p>Result</p> <p></p>"},{"location":"bench/#benchmark-2-taxonkit-multi-threaded-scalability","title":"Benchmark 2: TaxonKit multi-threaded scalability","text":"<p>Running benchmark:</p> <pre><code>$ # emptying the buffers cache\n$ su -c \"free &amp;&amp; sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches &amp;&amp; free\"\n\n\n$ time perl run.pl -n 3 run_benchmark_taxonkit.sh -o bench.taxonkit.tsv\n$ rm *.lineage *.out\n</code></pre> <p>Plotting benchmark result.</p> <pre><code>cat bench.taxonkit.tsv \\\n    | csvtk sort -t -L dataset:&lt;(cut -f 1 dataset_rename.tsv) -k dataset:u -k app \\\n    | csvtk replace -t -f dataset -k dataset_rename.tsv -p '(.+)' -r '{kv}' \\\n    &gt; bench.taxonkit.reformat.tsv\n\n./plot_threads2.R -i bench.taxonkit.reformat.tsv --width 6 --height 4 --dpi 600 \\\n    --labcolor \"log10(queries)\" --labshape \"Threads\"\n</code></pre> <p>Result</p> <p></p> Please enable JavaScript to view the comments powered by Disqus."}]}